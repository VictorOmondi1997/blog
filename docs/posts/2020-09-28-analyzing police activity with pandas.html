<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2020-09-28">
<meta name="description" content="Exploring the Stanford Open Policing Project dataset and analyzing the impact of gender on police behavior.">

<title>blog - Analyzing Police Activity with Pandas</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">blog</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../about.html">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/VictorOmondi1997"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/VictorOmondi197"><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Analyzing Police Activity with Pandas</h1>
                  <div>
        <div class="description">
          Exploring the Stanford Open Policing Project dataset and analyzing the impact of gender on police behavior.
        </div>
      </div>
                </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">September 28, 2020</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="preparing-the-data-for-analysis" class="level1">
<h1>Preparing the data for analysis</h1>
<p>Before beginning our analysis, it is critical that we first examine and clean the dataset, to make working with it a more efficient process. We will fixing data types, handle missing values, and dropping columns and rows while exploring the Stanford Open Policing Project dataset.</p>
<section id="stanford-open-policing-project-dataset" class="level2">
<h2 class="anchored" data-anchor-id="stanford-open-policing-project-dataset">Stanford Open Policing Project dataset</h2>
<section id="examining-the-dataset" class="level3">
<h3 class="anchored" data-anchor-id="examining-the-dataset">Examining the dataset</h3>
<p>We’ll be analyzing a dataset of traffic stops in Rhode Island that was collected by the <a href="https://openpolicing.stanford.edu/">Stanford Open Policing Project</a>.</p>
<p>Before beginning our analysis, it’s important that we familiarize yourself with the dataset. We read the dataset into pandas, examine the first few rows, and then count the number of missing values.</p>
<section id="libraries" class="level4">
<h4 class="anchored" data-anchor-id="libraries">Libraries</h4>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pandas.api.types <span class="im">import</span> CategoricalDtype</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read 'police.csv' into a DataFrame named ri</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>ri <span class="op">=</span> pd.read_csv(<span class="st">"../datasets/police.csv"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine the head of the DataFrame</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>display(ri.head())</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Count the number of missing values in each column</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>ri.isnull().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>state</th>
      <th>stop_date</th>
      <th>stop_time</th>
      <th>county_name</th>
      <th>driver_gender</th>
      <th>driver_race</th>
      <th>violation_raw</th>
      <th>violation</th>
      <th>search_conducted</th>
      <th>search_type</th>
      <th>stop_outcome</th>
      <th>is_arrested</th>
      <th>stop_duration</th>
      <th>drugs_related_stop</th>
      <th>district</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>RI</td>
      <td>2005-01-04</td>
      <td>12:55</td>
      <td>NaN</td>
      <td>M</td>
      <td>White</td>
      <td>Equipment/Inspection Violation</td>
      <td>Equipment</td>
      <td>False</td>
      <td>NaN</td>
      <td>Citation</td>
      <td>False</td>
      <td>0-15 Min</td>
      <td>False</td>
      <td>Zone X4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>RI</td>
      <td>2005-01-23</td>
      <td>23:15</td>
      <td>NaN</td>
      <td>M</td>
      <td>White</td>
      <td>Speeding</td>
      <td>Speeding</td>
      <td>False</td>
      <td>NaN</td>
      <td>Citation</td>
      <td>False</td>
      <td>0-15 Min</td>
      <td>False</td>
      <td>Zone K3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>RI</td>
      <td>2005-02-17</td>
      <td>04:15</td>
      <td>NaN</td>
      <td>M</td>
      <td>White</td>
      <td>Speeding</td>
      <td>Speeding</td>
      <td>False</td>
      <td>NaN</td>
      <td>Citation</td>
      <td>False</td>
      <td>0-15 Min</td>
      <td>False</td>
      <td>Zone X4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>RI</td>
      <td>2005-02-20</td>
      <td>17:15</td>
      <td>NaN</td>
      <td>M</td>
      <td>White</td>
      <td>Call for Service</td>
      <td>Other</td>
      <td>False</td>
      <td>NaN</td>
      <td>Arrest Driver</td>
      <td>True</td>
      <td>16-30 Min</td>
      <td>False</td>
      <td>Zone X1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>RI</td>
      <td>2005-02-24</td>
      <td>01:20</td>
      <td>NaN</td>
      <td>F</td>
      <td>White</td>
      <td>Speeding</td>
      <td>Speeding</td>
      <td>False</td>
      <td>NaN</td>
      <td>Citation</td>
      <td>False</td>
      <td>0-15 Min</td>
      <td>False</td>
      <td>Zone X3</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>state                     0
stop_date                 0
stop_time                 0
county_name           91741
driver_gender          5205
driver_race            5202
violation_raw          5202
violation              5202
search_conducted          0
search_type           88434
stop_outcome           5202
is_arrested            5202
stop_duration          5202
drugs_related_stop        0
district                  0
dtype: int64</code></pre>
</div>
</div>
<p>It looks like most of the columns have at least some missing values. We’ll figure out how to handle these values in the next.</p>
</section>
</section>
<section id="dropping-columns" class="level3">
<h3 class="anchored" data-anchor-id="dropping-columns">Dropping columns</h3>
<p>We’ll drop the <code>county_name</code> column because it only contains missing values, and we’ll drop the <code>state</code> column because all of the traffic stops took place in one state (Rhode Island).</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine the shape of the DataFrame</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(ri.shape)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop the 'county_name' and 'state' columns</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>ri.drop([<span class="st">"county_name"</span>, <span class="st">"state"</span>], axis<span class="op">=</span><span class="st">'columns'</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine the shape of the DataFrame (again)</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(ri.shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(91741, 15)
(91741, 13)</code></pre>
</div>
</div>
<p>We’ll continue to remove unnecessary data from the DataFrame</p>
<p>### Dropping rows</p>
<p>the <code>driver_gender</code> column will be critical to many of our analyses. Because only a small fraction of rows are missing <code>driver_gender</code>, we’ll drop those rows from the dataset.</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Count the number of missing values in each column</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>display(ri.isnull().<span class="bu">sum</span>())</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop all rows that are missing 'driver_gender'</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>ri.dropna(subset<span class="op">=</span>[<span class="st">"driver_gender"</span>], inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Count the number of missing values in each column (again)</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>display(ri.isnull().<span class="bu">sum</span>())</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine the shape of the DataFrame</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>ri.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>stop_date                 0
stop_time                 0
driver_gender          5205
driver_race            5202
violation_raw          5202
violation              5202
search_conducted          0
search_type           88434
stop_outcome           5202
is_arrested            5202
stop_duration          5202
drugs_related_stop        0
district                  0
dtype: int64</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>stop_date                 0
stop_time                 0
driver_gender             0
driver_race               0
violation_raw             0
violation                 0
search_conducted          0
search_type           83229
stop_outcome              0
is_arrested               0
stop_duration             0
drugs_related_stop        0
district                  0
dtype: int64</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>(86536, 13)</code></pre>
</div>
</div>
<p>We dropped around 5,000 rows, which is a small fraction of the dataset, and now only one column remains with any missing values.</p>
</section>
</section>
<section id="using-proper-data-types" class="level2">
<h2 class="anchored" data-anchor-id="using-proper-data-types">Using proper data types</h2>
<section id="finding-an-incorrect-data-type" class="level3">
<h3 class="anchored" data-anchor-id="finding-an-incorrect-data-type">Finding an incorrect data type</h3>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>ri.dtypes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>stop_date             object
stop_time             object
driver_gender         object
driver_race           object
violation_raw         object
violation             object
search_conducted        bool
search_type           object
stop_outcome          object
is_arrested           object
stop_duration         object
drugs_related_stop      bool
district              object
dtype: object</code></pre>
</div>
</div>
<ul>
<li><code>stop_date</code>: should be datetime</li>
<li><code>stop_time</code>: should be datetime</li>
<li><code>driver_gender</code>: should be category</li>
<li><code>driver_race</code>: should be category</li>
<li><code>violation_raw</code>: should be category</li>
<li><code>violation</code>: should be category</li>
<li><code>district</code>: should be category</li>
<li><code>is_arrested</code>: should be bool</li>
</ul>
<p>We’ll fix the data type of the <code>is_arrested</code> column</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine the head of the 'is_arrested' column</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>display(ri.is_arrested.head())</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Change the data type of 'is_arrested' to 'bool'</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>ri[<span class="st">'is_arrested'</span>] <span class="op">=</span> ri.is_arrested.astype(<span class="st">'bool'</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Check the data type of 'is_arrested' </span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>ri.is_arrested.dtype</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0    False
1    False
2    False
3     True
4    False
Name: is_arrested, dtype: object</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>dtype('bool')</code></pre>
</div>
</div>
</section>
</section>
<section id="creating-a-datetimeindex" class="level2">
<h2 class="anchored" data-anchor-id="creating-a-datetimeindex">Creating a DatetimeIndex</h2>
<section id="combining-object-columns" class="level3">
<h3 class="anchored" data-anchor-id="combining-object-columns">Combining object columns</h3>
<p>Currently, the date and time of each traffic stop are stored in separate object columns: <code>stop_date</code> and <code>stop_time</code>. We’ll combine these two columns into a single column, and then convert it to datetime format.</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>ri[<span class="st">'stop_date_time'</span>] <span class="op">=</span> pd.to_datetime(ri.stop_date.<span class="bu">str</span>.replace(<span class="st">"/"</span>, <span class="st">"-"</span>).<span class="bu">str</span>.cat(ri.stop_time, sep<span class="op">=</span><span class="st">" "</span>))</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>ri.dtypes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>stop_date                     object
stop_time                     object
driver_gender                 object
driver_race                   object
violation_raw                 object
violation                     object
search_conducted                bool
search_type                   object
stop_outcome                  object
is_arrested                     bool
stop_duration                 object
drugs_related_stop              bool
district                      object
stop_date_time        datetime64[ns]
dtype: object</code></pre>
</div>
</div>
</section>
<section id="setting-the-index" class="level3">
<h3 class="anchored" data-anchor-id="setting-the-index">Setting the index</h3>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set 'stop_datetime' as the index</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>ri.set_index(<span class="st">"stop_date_time"</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine the index</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>display(ri.index)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine the columns</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>ri.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>DatetimeIndex(['2005-01-04 12:55:00', '2005-01-23 23:15:00',
               '2005-02-17 04:15:00', '2005-02-20 17:15:00',
               '2005-02-24 01:20:00', '2005-03-14 10:00:00',
               '2005-03-29 21:55:00', '2005-04-04 21:25:00',
               '2005-07-14 11:20:00', '2005-07-14 19:55:00',
               ...
               '2015-12-31 13:23:00', '2015-12-31 18:59:00',
               '2015-12-31 19:13:00', '2015-12-31 20:20:00',
               '2015-12-31 20:50:00', '2015-12-31 21:21:00',
               '2015-12-31 21:59:00', '2015-12-31 22:04:00',
               '2015-12-31 22:09:00', '2015-12-31 22:47:00'],
              dtype='datetime64[ns]', name='stop_date_time', length=86536, freq=None)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>Index(['stop_date', 'stop_time', 'driver_gender', 'driver_race',
       'violation_raw', 'violation', 'search_conducted', 'search_type',
       'stop_outcome', 'is_arrested', 'stop_duration', 'drugs_related_stop',
       'district'],
      dtype='object')</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="exploring-the-relationship-between-gender-and-policing" class="level1">
<h1>Exploring the relationship between gender and policing</h1>
<p>Does the gender of a driver have an impact on police behavior during a traffic stop? We will explore that question while doing filtering, grouping, method chaining, Boolean math, string methods, and more!</p>
<section id="do-the-genders-commit-different-violations" class="level2">
<h2 class="anchored" data-anchor-id="do-the-genders-commit-different-violations">Do the genders commit different violations?</h2>
<section id="examining-traffic-violations" class="level3">
<h3 class="anchored" data-anchor-id="examining-traffic-violations">Examining traffic violations</h3>
<p>Before comparing the violations being committed by each gender, we should examine the violations committed by all drivers to get a baseline understanding of the data.</p>
<p>We’ll count the unique values in the <code>violation</code> column, and then separately express those counts as proportions.</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Count the unique values in 'violation'</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>display(ri.violation.value_counts())</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Express the counts as proportions</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>ri.violation.value_counts(normalize<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Speeding               48423
Moving violation       16224
Equipment              10921
Other                   4409
Registration/plates     3703
Seat belt               2856
Name: violation, dtype: int64</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>Speeding               0.559571
Moving violation       0.187483
Equipment              0.126202
Other                  0.050950
Registration/plates    0.042791
Seat belt              0.033004
Name: violation, dtype: float64</code></pre>
</div>
</div>
<p>More than half of all violations are for speeding, followed by other moving violations and equipment violations.</p>
</section>
<section id="comparing-violations-by-gender" class="level3">
<h3 class="anchored" data-anchor-id="comparing-violations-by-gender">Comparing violations by gender</h3>
<p>The question we’re trying to answer is whether male and female drivers tend to commit different types of traffic violations.</p>
<p>We’ll first create a DataFrame for each gender, and then analyze the violations in each DataFrame separately.</p>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a DataFrame of female drivers</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>female <span class="op">=</span> ri[ri.driver_gender<span class="op">==</span><span class="st">"F"</span>]</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a DataFrame of male drivers</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>male <span class="op">=</span> ri[ri.driver_gender<span class="op">==</span><span class="st">"M"</span>]</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the violations by female drivers (as proportions)</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>display(female.violation.value_counts(normalize<span class="op">=</span><span class="va">True</span>))</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the violations by male drivers (as proportions)</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>male.violation.value_counts(normalize<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Speeding               0.658114
Moving violation       0.138218
Equipment              0.105199
Registration/plates    0.044418
Other                  0.029738
Seat belt              0.024312
Name: violation, dtype: float64</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>Speeding               0.522243
Moving violation       0.206144
Equipment              0.134158
Other                  0.058985
Registration/plates    0.042175
Seat belt              0.036296
Name: violation, dtype: float64</code></pre>
</div>
</div>
<p>About two-thirds of female traffic stops are for speeding, whereas stops of males are more balanced among the six categories. This doesn’t mean that females speed more often than males, however, since we didn’t take into account the number of stops or drivers.</p>
</section>
</section>
<section id="does-gender-affect-who-gets-a-ticket-for-speeding" class="level2">
<h2 class="anchored" data-anchor-id="does-gender-affect-who-gets-a-ticket-for-speeding">Does gender affect who gets a ticket for speeding?</h2>
<section id="comparing-speeding-outcomes-by-gender" class="level3">
<h3 class="anchored" data-anchor-id="comparing-speeding-outcomes-by-gender">Comparing speeding outcomes by gender</h3>
<p>When a driver is pulled over for speeding, many people believe that gender has an impact on whether the driver will receive a ticket or a warning. Can we find evidence of this in the dataset?</p>
<p>First, we’ll create two DataFrames of drivers who were stopped for speeding: one containing females and the other containing males.</p>
<p>Then, for each gender, we’ll use the <code>stop_outcome</code> column to calculate what percentage of stops resulted in a “Citation” (meaning a ticket) versus a “Warning”.</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a DataFrame of female drivers stopped for speeding</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>female_and_speeding <span class="op">=</span> ri[(ri.driver_gender<span class="op">==</span><span class="st">"F"</span>) <span class="op">&amp;</span> (ri.violation <span class="op">==</span><span class="st">"Speeding"</span>)]</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a DataFrame of male drivers stopped for speeding</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>male_and_speeding <span class="op">=</span> ri[(ri.driver_gender<span class="op">==</span><span class="st">"M"</span>) <span class="op">&amp;</span> (ri.violation <span class="op">==</span><span class="st">"Speeding"</span>)]</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the stop outcomes for female drivers (as proportions)</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>display(female_and_speeding.stop_outcome.value_counts(normalize<span class="op">=</span><span class="va">True</span>))</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the stop outcomes for male drivers (as proportions)</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>male_and_speeding.stop_outcome.value_counts(normalize<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Citation            0.952192
Warning             0.040074
Arrest Driver       0.005752
N/D                 0.000959
Arrest Passenger    0.000639
No Action           0.000383
Name: stop_outcome, dtype: float64</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>Citation            0.944595
Warning             0.036184
Arrest Driver       0.015895
Arrest Passenger    0.001281
No Action           0.001068
N/D                 0.000976
Name: stop_outcome, dtype: float64</code></pre>
</div>
</div>
<p>The numbers are similar for males and females: about 95% of stops for speeding result in a ticket. Thus, the data fails to show that gender has an impact on who gets a ticket for speeding.</p>
<p>## Does gender affect whose vehicle is searched? ### Calculating the search rate</p>
<p>During a traffic stop, the police officer sometimes conducts a search of the vehicle. We’ll calculate the percentage of all stops in the <code>ri</code> DataFrame that result in a vehicle search, also known as the search rate.</p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check the data type of 'search_conducted'</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(ri.search_conducted.dtype)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the search rate by counting the values</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>display(ri.search_conducted.value_counts(normalize<span class="op">=</span><span class="va">True</span>))</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the search rate by taking the mean</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>ri.search_conducted.mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>bool</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>False    0.961785
True     0.038215
Name: search_conducted, dtype: float64</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>0.0382153092354627</code></pre>
</div>
</div>
<p>It looks like the search rate is about 3.8%. Next, we’ll examine whether the search rate varies by driver gender.</p>
<p>### Comparing search rates by gender</p>
<p>We’ll compare the rates at which female and male drivers are searched during a traffic stop. Remember that the vehicle search rate across all stops is about 3.8%.</p>
<p>First, we’ll filter the DataFrame by gender and calculate the search rate for each group separately. Then, we’ll perform the same calculation for both genders at once using a <code>.groupby()</code>.</p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>ri[ri.driver_gender<span class="op">==</span><span class="st">"F"</span>].search_conducted.mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>0.019180617481282074</code></pre>
</div>
</div>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>ri[ri.driver_gender<span class="op">==</span><span class="st">"M"</span>].search_conducted.mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>0.04542557598546892</code></pre>
</div>
</div>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>ri.groupby(<span class="st">"driver_gender"</span>).search_conducted.mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>driver_gender
F    0.019181
M    0.045426
Name: search_conducted, dtype: float64</code></pre>
</div>
</div>
<p>Male drivers are searched more than twice as often as female drivers. Why might this be?</p>
</section>
<section id="adding-a-second-factor-to-the-analysis" class="level3">
<h3 class="anchored" data-anchor-id="adding-a-second-factor-to-the-analysis">Adding a second factor to the analysis</h3>
<p>Even though the search rate for males is much higher than for females, it’s possible that the difference is mostly due to a second factor.</p>
<p>For example, we might hypothesize that the search rate varies by violation type, and the difference in search rate between males and females is because they tend to commit different violations.</p>
<p>we can test this hypothesis by examining the search rate for each combination of gender and violation. If the hypothesis was true, out would find that males and females are searched at about the same rate for each violation. Let’s find out below if that’s the case!</p>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the search rate for each combination of gender and violation</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>ri.groupby([<span class="st">"driver_gender"</span>, <span class="st">"violation"</span>]).search_conducted.mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>driver_gender  violation          
F              Equipment              0.039984
               Moving violation       0.039257
               Other                  0.041018
               Registration/plates    0.054924
               Seat belt              0.017301
               Speeding               0.008309
M              Equipment              0.071496
               Moving violation       0.061524
               Other                  0.046191
               Registration/plates    0.108802
               Seat belt              0.035119
               Speeding               0.027885
Name: search_conducted, dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>ri.groupby([<span class="st">"violation"</span>, <span class="st">"driver_gender"</span>]).search_conducted.mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>violation            driver_gender
Equipment            F                0.039984
                     M                0.071496
Moving violation     F                0.039257
                     M                0.061524
Other                F                0.041018
                     M                0.046191
Registration/plates  F                0.054924
                     M                0.108802
Seat belt            F                0.017301
                     M                0.035119
Speeding             F                0.008309
                     M                0.027885
Name: search_conducted, dtype: float64</code></pre>
</div>
</div>
<p>For all types of violations, the search rate is higher for males than for females, disproving our hypothesis.</p>
</section>
</section>
<section id="does-gender-affect-who-is-frisked-during-a-search" class="level2">
<h2 class="anchored" data-anchor-id="does-gender-affect-who-is-frisked-during-a-search">Does gender affect who is frisked during a search?</h2>
<section id="counting-protective-frisks" class="level3">
<h3 class="anchored" data-anchor-id="counting-protective-frisks">Counting protective frisks</h3>
<p>During a vehicle search, the police officer may pat down the driver to check if they have a weapon. This is known as a “protective frisk.”</p>
<p>We’ll first check to see how many times “Protective Frisk” was the only search type. Then, we’ll use a string method to locate all instances in which the driver was frisked.</p>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Count the 'search_type' values</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>display(ri.search_type.value_counts())</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if 'search_type' contains the string 'Protective Frisk'</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>ri[<span class="st">'frisk'</span>] <span class="op">=</span> ri.search_type.<span class="bu">str</span>.contains(<span class="st">'Protective Frisk'</span>, na<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Check the data type of 'frisk'</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(ri.frisk.dtype)</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Take the sum of 'frisk'</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(ri.frisk.<span class="bu">sum</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Incident to Arrest                                          1290
Probable Cause                                               924
Inventory                                                    219
Reasonable Suspicion                                         214
Protective Frisk                                             164
Incident to Arrest,Inventory                                 123
Incident to Arrest,Probable Cause                            100
Probable Cause,Reasonable Suspicion                           54
Probable Cause,Protective Frisk                               35
Incident to Arrest,Inventory,Probable Cause                   35
Incident to Arrest,Protective Frisk                           33
Inventory,Probable Cause                                      25
Protective Frisk,Reasonable Suspicion                         19
Incident to Arrest,Inventory,Protective Frisk                 18
Incident to Arrest,Probable Cause,Protective Frisk            13
Inventory,Protective Frisk                                    12
Incident to Arrest,Reasonable Suspicion                        8
Probable Cause,Protective Frisk,Reasonable Suspicion           5
Incident to Arrest,Probable Cause,Reasonable Suspicion         5
Incident to Arrest,Inventory,Reasonable Suspicion              4
Incident to Arrest,Protective Frisk,Reasonable Suspicion       2
Inventory,Reasonable Suspicion                                 2
Inventory,Probable Cause,Protective Frisk                      1
Inventory,Probable Cause,Reasonable Suspicion                  1
Inventory,Protective Frisk,Reasonable Suspicion                1
Name: search_type, dtype: int64</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>bool
303</code></pre>
</div>
</div>
<p>It looks like there were 303 drivers who were frisked. Next, we’ll examine whether gender affects who is frisked.</p>
</section>
<section id="comparing-frisk-rates-by-gender" class="level3">
<h3 class="anchored" data-anchor-id="comparing-frisk-rates-by-gender">Comparing frisk rates by gender</h3>
<p>We’ll compare the rates at which female and male drivers are frisked during a search. Are males frisked more often than females, perhaps because police officers consider them to be higher risk?</p>
<p>Before doing any calculations, it’s important to filter the DataFrame to only include the relevant subset of data, namely stops in which a search was conducted.</p>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a DataFrame of stops in which a search was conducted</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>searched <span class="op">=</span> ri[ri.search_conducted <span class="op">==</span> <span class="va">True</span>]</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the overall frisk rate by taking the mean of 'frisk'</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(searched.frisk.mean())</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the frisk rate for each gender</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>searched.groupby(<span class="st">"driver_gender"</span>).frisk.mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.09162382824312065</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>driver_gender
F    0.074561
M    0.094353
Name: frisk, dtype: float64</code></pre>
</div>
</div>
<p>The frisk rate is higher for males than for females, though we can’t conclude that this difference is caused by the driver’s gender.</p>
</section>
</section>
</section>
<section id="visual-exploratory-data-analysis" class="level1">
<h1>Visual exploratory data analysis</h1>
<p>Are you more likely to get arrested at a certain time of day? Are drug-related stops on the rise? We will answer these and other questions by analyzing the dataset visually, since plots can help us to understand trends in a way that examining the raw data cannot.</p>
<section id="does-time-of-the-day-affect-arrest-rate" class="level2">
<h2 class="anchored" data-anchor-id="does-time-of-the-day-affect-arrest-rate">Does time of the day affect arrest rate?</h2>
<section id="calculating-the-hourly-arrest-rate" class="level3">
<h3 class="anchored" data-anchor-id="calculating-the-hourly-arrest-rate">Calculating the hourly arrest rate</h3>
<p>When a police officer stops a driver, a small percentage of those stops ends in an arrest. This is known as the arrest rate. We’ll find out whether the arrest rate varies by time of day.</p>
<p>First, we’ll calculate the arrest rate across all stops in the <code>ri</code> DataFrame. Then, we’ll calculate the hourly arrest rate by using the hour attribute of the index. The hour ranges from 0 to 23, in which:</p>
<ul>
<li>0 = midnight</li>
<li>12 = noon</li>
<li>23 = 11 PM</li>
</ul>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the overall arrest rate</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(ri.is_arrested.mean())</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the hourly arrest rate</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the hourly arrest rate</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>hourly_arrest_rate <span class="op">=</span> ri.groupby(ri.index.hour).is_arrested.mean()</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>hourly_arrest_rate</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.0355690117407784</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>stop_date_time
0     0.051431
1     0.064932
2     0.060798
3     0.060549
4     0.048000
5     0.042781
6     0.013813
7     0.013032
8     0.021854
9     0.025206
10    0.028213
11    0.028897
12    0.037399
13    0.030776
14    0.030605
15    0.030679
16    0.035281
17    0.040619
18    0.038204
19    0.032245
20    0.038107
21    0.064541
22    0.048666
23    0.047592
Name: is_arrested, dtype: float64</code></pre>
</div>
</div>
<p>Next we’ll plot the data so that you can visually examine the arrest rate trends.</p>
<p>### Plotting the hourly arrest rate</p>
<p>We’ll create a line plot from the <code>hourly_arrest_rate</code> object.</p>
<div class="callout-important callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>A line plot is appropriate in this case because you’re showing how a quantity changes over time.</p>
</div>
</div>
<p>This plot should help us to spot some trends that may not have been obvious when examining the raw numbers!</p>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a line plot of 'hourly_arrest_rate'</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>hourly_arrest_rate.plot()</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the xlabel, ylabel, and title</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Hour"</span>)</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Arrest Rate"</span>)</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Arrest Rate by Time of Day"</span>)</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2020-09-28-Analyzing Police Activity with pandas_files/figure-html/cell-22-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>The arrest rate has a significant spike overnight, and then dips in the early morning hours.</p>
<p>## Are drug-related stops on the rise?</p>
</section>
<section id="plotting-drug-related-stops" class="level3">
<h3 class="anchored" data-anchor-id="plotting-drug-related-stops">Plotting drug-related stops</h3>
<p>In a small portion of traffic stops, drugs are found in the vehicle during a search. In this exercise, you’ll assess whether these drug-related stops are becoming more common over time.</p>
<p>The Boolean column <code>drugs_related_stop</code> indicates whether drugs were found during a given stop. We’ll calculate the annual drug rate by resampling this column, and then we’ll use a line plot to visualize how the rate has changed over time.</p>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the annual rate of drug-related stops</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the annual rate of drug-related stops</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>annual_drug_rate <span class="op">=</span> ri.drugs_related_stop.resample(<span class="st">"A"</span>).mean()</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>display(annual_drug_rate)</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a line plot of 'annual_drug_rate'</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>annual_drug_rate.plot()</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>stop_date_time
2005-12-31    0.006501
2006-12-31    0.007258
2007-12-31    0.007970
2008-12-31    0.007505
2009-12-31    0.009889
2010-12-31    0.010081
2011-12-31    0.009731
2012-12-31    0.009921
2013-12-31    0.013094
2014-12-31    0.013826
2015-12-31    0.012266
Freq: A-DEC, Name: drugs_related_stop, dtype: float64</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2020-09-28-Analyzing Police Activity with pandas_files/figure-html/cell-23-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>The rate of drug-related stops nearly doubled over the course of 10 years. Why might that be the case?</p>
</section>
<section id="comparing-drug-and-search-rates" class="level3">
<h3 class="anchored" data-anchor-id="comparing-drug-and-search-rates">Comparing drug and search rates</h3>
<p>The rate of drug-related stops increased significantly between 2005 and 2015. We might hypothesize that the rate of vehicle searches was also increasing, which would have led to an increase in drug-related stops even if more drivers were not carrying drugs.</p>
<p>We can test this hypothesis by calculating the annual search rate, and then plotting it against the annual drug rate. If the hypothesis is true, then we’ll see both rates increasing over time.</p>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate and save the annual search rate</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>annual_search_rate <span class="op">=</span> ri.search_conducted.resample(<span class="st">"A"</span>).mean()</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Concatenate 'annual_drug_rate' and 'annual_search_rate'</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>annual <span class="op">=</span> pd.concat([annual_drug_rate, annual_search_rate], axis<span class="op">=</span><span class="st">"columns"</span>)</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create subplots from 'annual'</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>annual.plot(subplots<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the subplots</span></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2020-09-28-Analyzing Police Activity with pandas_files/figure-html/cell-24-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>The rate of drug-related stops increased even though the search rate decreased, disproving our hypothesis.</p>
</section>
</section>
<section id="what-violations-are-caught-in-each-district" class="level2">
<h2 class="anchored" data-anchor-id="what-violations-are-caught-in-each-district">What violations are caught in each district?</h2>
<section id="tallying-violations-by-district" class="level3">
<h3 class="anchored" data-anchor-id="tallying-violations-by-district">Tallying violations by district</h3>
<p>The state of Rhode Island is broken into six police districts, also known as zones. How do the zones compare in terms of what violations are caught by police?</p>
<p>We’ll create a frequency table to determine how many violations of each type took place in each of the six zones. Then, we’ll filter the table to focus on the “K” zones, which we’ll examine further.</p>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a frequency table of districts and violations</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the frequency table as 'all_zones'</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>all_zones <span class="op">=</span> pd.crosstab(ri.district, ri.violation)</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>display(all_zones)</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Select rows 'Zone K1' through 'Zone K3'</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the smaller table as 'k_zones'</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>k_zones <span class="op">=</span> all_zones.loc[<span class="st">"Zone K1"</span>:<span class="st">"Zone K3"</span>]</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>k_zones</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th>violation</th>
      <th>Equipment</th>
      <th>Moving violation</th>
      <th>Other</th>
      <th>Registration/plates</th>
      <th>Seat belt</th>
      <th>Speeding</th>
    </tr>
    <tr>
      <th>district</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Zone K1</th>
      <td>672</td>
      <td>1254</td>
      <td>290</td>
      <td>120</td>
      <td>0</td>
      <td>5960</td>
    </tr>
    <tr>
      <th>Zone K2</th>
      <td>2061</td>
      <td>2962</td>
      <td>942</td>
      <td>768</td>
      <td>481</td>
      <td>10448</td>
    </tr>
    <tr>
      <th>Zone K3</th>
      <td>2302</td>
      <td>2898</td>
      <td>705</td>
      <td>695</td>
      <td>638</td>
      <td>12322</td>
    </tr>
    <tr>
      <th>Zone X1</th>
      <td>296</td>
      <td>671</td>
      <td>143</td>
      <td>38</td>
      <td>74</td>
      <td>1119</td>
    </tr>
    <tr>
      <th>Zone X3</th>
      <td>2049</td>
      <td>3086</td>
      <td>769</td>
      <td>671</td>
      <td>820</td>
      <td>8779</td>
    </tr>
    <tr>
      <th>Zone X4</th>
      <td>3541</td>
      <td>5353</td>
      <td>1560</td>
      <td>1411</td>
      <td>843</td>
      <td>9795</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="25">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th>violation</th>
      <th>Equipment</th>
      <th>Moving violation</th>
      <th>Other</th>
      <th>Registration/plates</th>
      <th>Seat belt</th>
      <th>Speeding</th>
    </tr>
    <tr>
      <th>district</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Zone K1</th>
      <td>672</td>
      <td>1254</td>
      <td>290</td>
      <td>120</td>
      <td>0</td>
      <td>5960</td>
    </tr>
    <tr>
      <th>Zone K2</th>
      <td>2061</td>
      <td>2962</td>
      <td>942</td>
      <td>768</td>
      <td>481</td>
      <td>10448</td>
    </tr>
    <tr>
      <th>Zone K3</th>
      <td>2302</td>
      <td>2898</td>
      <td>705</td>
      <td>695</td>
      <td>638</td>
      <td>12322</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>We’ll plot the violations so that you can compare these districts.</p>
</section>
<section id="plotting-violations-by-district" class="level3">
<h3 class="anchored" data-anchor-id="plotting-violations-by-district">Plotting violations by district</h3>
<p>Now that we’ve created a frequency table focused on the “K” zones, we’ll visualize the data to help us compare what violations are being caught in each zone.</p>
<p>First we’ll create a bar plot, which is an appropriate plot type since we’re comparing categorical data. Then we’ll create a stacked bar plot in order to get a slightly different look at the data.</p>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a bar plot of 'k_zones'</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>k_zones.plot(kind<span class="op">=</span><span class="st">"bar"</span>)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2020-09-28-Analyzing Police Activity with pandas_files/figure-html/cell-26-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a stacked bar plot of 'k_zones'</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>k_zones.plot(kind<span class="op">=</span><span class="st">"bar"</span>, stacked<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2020-09-28-Analyzing Police Activity with pandas_files/figure-html/cell-27-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>The vast majority of traffic stops in Zone K1 are for speeding, and Zones K2 and K3 are remarkably similar to one another in terms of violations.</p>
</section>
</section>
<section id="how-long-might-you-be-stopped-for-a-violation" class="level2">
<h2 class="anchored" data-anchor-id="how-long-might-you-be-stopped-for-a-violation">How long might you be stopped for a violation?</h2>
<section id="converting-stop-durations-to-numbers" class="level3">
<h3 class="anchored" data-anchor-id="converting-stop-durations-to-numbers">Converting stop durations to numbers</h3>
<p>In the traffic stops dataset, the <code>stop_duration</code> column tells us approximately how long the driver was detained by the officer. Unfortunately, the durations are stored as strings, such as <code>'0-15 Min'</code>. How can we make this data easier to analyze?</p>
<p>We’ll convert the stop durations to integers. Because the precise durations are not available, we’ll have to estimate the numbers using reasonable values:</p>
<ul>
<li>Convert <code>'0-15 Min'</code> to <code>8</code></li>
<li>Convert <code>'16-30 Min'</code> to <code>23</code></li>
<li>Convert <code>'30+ Min'</code> to <code>45</code></li>
</ul>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a dictionary that maps strings to integers</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>mapping <span class="op">=</span> {<span class="st">"0-15 Min"</span>:<span class="dv">8</span>, <span class="st">'16-30 Min'</span>:<span class="dv">23</span>, <span class="st">'30+ Min'</span>:<span class="dv">45</span>}</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the 'stop_duration' strings to integers using the 'mapping'</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>ri[<span class="st">'stop_minutes'</span>] <span class="op">=</span> ri.stop_duration.<span class="bu">map</span>(mapping)</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the unique values in 'stop_minutes'</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>ri.stop_minutes.unique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>array([ 8, 23, 45], dtype=int64)</code></pre>
</div>
</div>
<p>Next we’ll analyze the stop length for each type of violation.</p>
</section>
<section id="plotting-stop-length" class="level3">
<h3 class="anchored" data-anchor-id="plotting-stop-length">Plotting stop length</h3>
<p>If you were stopped for a particular violation, how long might you expect to be detained?</p>
<p>We’ll visualize the average length of time drivers are stopped for each type of violation. Rather than using the <code>violation</code> column we’ll use <code>violation_raw</code> since it contains more detailed descriptions of the violations.</p>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the mean 'stop_minutes' for each value in 'violation_raw'</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the resulting Series as 'stop_length'</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>stop_length <span class="op">=</span> ri.groupby(<span class="st">"violation_raw"</span>).stop_minutes.mean()</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>display(stop_length)</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort 'stop_length' by its values and create a horizontal bar plot</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>stop_length.sort_values().plot(kind<span class="op">=</span><span class="st">"barh"</span>)</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>violation_raw
APB                                 17.967033
Call for Service                    22.124371
Equipment/Inspection Violation      11.445655
Motorist Assist/Courtesy            17.741463
Other Traffic Violation             13.844490
Registration Violation              13.736970
Seatbelt Violation                   9.662815
Special Detail/Directed Patrol      15.123632
Speeding                            10.581562
Suspicious Person                   14.910714
Violation of City/Town Ordinance    13.254144
Warrant                             24.055556
Name: stop_minutes, dtype: float64</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2020-09-28-Analyzing Police Activity with pandas_files/figure-html/cell-29-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
</section>
<section id="analyzing-the-effect-of-weather-on-policing" class="level1">
<h1>Analyzing the effect of weather on policing</h1>
<p>We will use a second dataset to explore the impact of weather conditions on police behavior during traffic stops. We will be merging and reshaping datasets, assessing whether a data source is trustworthy, working with categorical data, and other advanced skills.</p>
<section id="exploring-the-weather-dataset" class="level2">
<h2 class="anchored" data-anchor-id="exploring-the-weather-dataset">Exploring the weather dataset</h2>
<section id="plotting-the-temperature" class="level3">
<h3 class="anchored" data-anchor-id="plotting-the-temperature">Plotting the temperature</h3>
<p>We’ll examine the temperature columns from the weather dataset to assess whether the data seems trustworthy. First we’ll print the summary statistics, and then you’ll visualize the data using a box plot.</p>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read 'weather.csv' into a DataFrame named 'weather'</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>weather <span class="op">=</span> pd.read_csv(<span class="st">"../datasets/weather.csv"</span>)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>display(weather.head())</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Describe the temperature columns</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>display(weather[[<span class="st">"TMIN"</span>, <span class="st">"TAVG"</span>, <span class="st">"TMAX"</span>]].describe().T)</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a box plot of the temperature columns</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>weather[[<span class="st">"TMIN"</span>, <span class="st">"TAVG"</span>, <span class="st">"TMAX"</span>]].plot(kind<span class="op">=</span><span class="st">'box'</span>)</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>STATION</th>
      <th>DATE</th>
      <th>TAVG</th>
      <th>TMIN</th>
      <th>TMAX</th>
      <th>AWND</th>
      <th>WSF2</th>
      <th>WT01</th>
      <th>WT02</th>
      <th>WT03</th>
      <th>...</th>
      <th>WT11</th>
      <th>WT13</th>
      <th>WT14</th>
      <th>WT15</th>
      <th>WT16</th>
      <th>WT17</th>
      <th>WT18</th>
      <th>WT19</th>
      <th>WT21</th>
      <th>WT22</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>USW00014765</td>
      <td>2005-01-01</td>
      <td>44.0</td>
      <td>35</td>
      <td>53</td>
      <td>8.95</td>
      <td>25.1</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>USW00014765</td>
      <td>2005-01-02</td>
      <td>36.0</td>
      <td>28</td>
      <td>44</td>
      <td>9.40</td>
      <td>14.1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>USW00014765</td>
      <td>2005-01-03</td>
      <td>49.0</td>
      <td>44</td>
      <td>53</td>
      <td>6.93</td>
      <td>17.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>USW00014765</td>
      <td>2005-01-04</td>
      <td>42.0</td>
      <td>39</td>
      <td>45</td>
      <td>6.93</td>
      <td>16.1</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>USW00014765</td>
      <td>2005-01-05</td>
      <td>36.0</td>
      <td>28</td>
      <td>43</td>
      <td>7.83</td>
      <td>17.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 27 columns</p>
</div>
</div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>TMIN</th>
      <td>4017.0</td>
      <td>43.484441</td>
      <td>17.020298</td>
      <td>-5.0</td>
      <td>30.0</td>
      <td>44.0</td>
      <td>58.0</td>
      <td>77.0</td>
    </tr>
    <tr>
      <th>TAVG</th>
      <td>1217.0</td>
      <td>52.493016</td>
      <td>17.830714</td>
      <td>6.0</td>
      <td>39.0</td>
      <td>54.0</td>
      <td>68.0</td>
      <td>86.0</td>
    </tr>
    <tr>
      <th>TMAX</th>
      <td>4017.0</td>
      <td>61.268608</td>
      <td>18.199517</td>
      <td>15.0</td>
      <td>47.0</td>
      <td>62.0</td>
      <td>77.0</td>
      <td>102.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<div class="cell-output cell-output-display">
<p><img src="2020-09-28-Analyzing Police Activity with pandas_files/figure-html/cell-30-output-3.png" class="img-fluid"></p>
</div>
</div>
<p>The temperature data looks good so far: the <code>TAVG</code> values are in between <code>TMIN</code> and <code>TMAX</code>, and the measurements and ranges seem reasonable.</p>
<p>### Plotting the temperature difference</p>
<p>We’ll continue to assess whether the dataset seems trustworthy by plotting the difference between the maximum and minimum temperatures.</p>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a 'TDIFF' column that represents temperature difference</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>weather[<span class="st">"TDIFF"</span>] <span class="op">=</span> weather.TMAX <span class="op">-</span> weather.TMIN</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Describe the 'TDIFF' column</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>display(weather.TDIFF.describe())</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a histogram with 20 bins to visualize 'TDIFF'</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>weather.TDIFF.plot(kind<span class="op">=</span><span class="st">"hist"</span>, bins<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>count    4017.000000
mean       17.784167
std         6.350720
min         2.000000
25%        14.000000
50%        18.000000
75%        22.000000
max        43.000000
Name: TDIFF, dtype: float64</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2020-09-28-Analyzing Police Activity with pandas_files/figure-html/cell-31-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>The <code>TDIFF</code> column has no negative values and its distribution is approximately normal, both of which are signs that the data is trustworthy.</p>
</section>
</section>
<section id="categorizing-the-weather" class="level2">
<h2 class="anchored" data-anchor-id="categorizing-the-weather">Categorizing the weather</h2>
<section id="counting-bad-weather-conditions" class="level3">
<h3 class="anchored" data-anchor-id="counting-bad-weather-conditions">Counting bad weather conditions</h3>
<p>The <code>weather</code> DataFrame contains 20 columns that start with <code>'WT'</code>, each of which represents a bad weather condition. For example:</p>
<ul>
<li><code>WT05</code> indicates “Hail”</li>
<li><code>WT11</code> indicates “High or damaging winds”</li>
<li><code>WT17</code> indicates “Freezing rain”</li>
</ul>
<p>For every row in the dataset, each <code>WT</code> column contains either a <code>1</code> (meaning the condition was present that day) or <code>NaN</code> (meaning the condition was not present).</p>
<p>We’ll quantify “how bad” the weather was each day by counting the number of 1 values in each row.</p>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Copy 'WT01' through 'WT22' to a new DataFrame</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>WT <span class="op">=</span> weather.loc[:, <span class="st">"WT01"</span>:<span class="st">"WT22"</span>]</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the sum of each row in 'WT'</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>weather[<span class="st">'bad_conditions'</span>] <span class="op">=</span> WT.<span class="bu">sum</span>(axis<span class="op">=</span><span class="st">"columns"</span>)</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace missing values in 'bad_conditions' with '0'</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>weather[<span class="st">'bad_conditions'</span>] <span class="op">=</span> weather.bad_conditions.fillna(<span class="dv">0</span>).astype(<span class="st">'int'</span>)</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a histogram to visualize 'bad_conditions'</span></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>weather.bad_conditions.plot(kind<span class="op">=</span><span class="st">"hist"</span>)</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2020-09-28-Analyzing Police Activity with pandas_files/figure-html/cell-32-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>It looks like many days didn’t have any bad weather conditions, and only a small portion of days had more than four bad weather conditions.</p>
</section>
<section id="rating-the-weather-conditions" class="level3">
<h3 class="anchored" data-anchor-id="rating-the-weather-conditions">Rating the weather conditions</h3>
<p>We counted the number of bad weather conditions each day. We’ll use the counts to create a rating system for the weather.</p>
<p>The counts range from 0 to 9, and should be converted to ratings as follows:</p>
<ul>
<li>Convert 0 to ‘good’</li>
<li>Convert 1 through 4 to ‘bad’</li>
<li>Convert 5 through 9 to ‘worse’</li>
</ul>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Count the unique values in 'bad_conditions' and sort the index</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>display(weather.bad_conditions.value_counts().sort_index())</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a dictionary that maps integers to strings</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>mapping <span class="op">=</span> {<span class="dv">0</span>:<span class="st">'good'</span>, <span class="dv">1</span>:<span class="st">'bad'</span>, <span class="dv">2</span>:<span class="st">'bad'</span>, <span class="dv">3</span>:<span class="st">'bad'</span>, <span class="dv">4</span>:<span class="st">'bad'</span>, <span class="dv">5</span>:<span class="st">'worse'</span>, <span class="dv">6</span>:<span class="st">'worse'</span>, <span class="dv">7</span>:<span class="st">'worse'</span>, <span class="dv">8</span>:<span class="st">'worse'</span>, <span class="dv">9</span>:<span class="st">'worse'</span>}</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the 'bad_conditions' integers to strings using the 'mapping'</span></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>weather[<span class="st">'rating'</span>] <span class="op">=</span> weather.bad_conditions.<span class="bu">map</span>(mapping)</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Count the unique values in 'rating'</span></span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>weather.rating.value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0    1749
1     613
2     367
3     380
4     476
5     282
6     101
7      41
8       4
9       4
Name: bad_conditions, dtype: int64</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>bad      1836
good     1749
worse     432
Name: rating, dtype: int64</code></pre>
</div>
</div>
</section>
<section id="changing-the-data-type-to-category" class="level3">
<h3 class="anchored" data-anchor-id="changing-the-data-type-to-category">Changing the data type to category</h3>
<p>Since the <code>rating</code> column only has a few possible values, we’ll change its data type to category in order to store the data more efficiently. we’ll also specify a logical order for the categories, which will be useful for future work.</p>
<div class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a list of weather ratings in logical order</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>cats <span class="op">=</span> [<span class="st">'good'</span>, <span class="st">'bad'</span>, <span class="st">'worse'</span>]</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Change the data type of 'rating' to category</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>weather[<span class="st">'rating'</span>] <span class="op">=</span> weather.rating.astype(CategoricalDtype(ordered<span class="op">=</span><span class="va">True</span>, categories<span class="op">=</span>cats))</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine the head of 'rating'</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>weather.rating.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<pre><code>0    bad
1    bad
2    bad
3    bad
4    bad
Name: rating, dtype: category
Categories (3, object): [good &lt; bad &lt; worse]</code></pre>
</div>
</div>
<p>We’ll use the rating column in future exercises to analyze the effects of weather on police behavior.</p>
</section>
</section>
<section id="merging-datasets" class="level2">
<h2 class="anchored" data-anchor-id="merging-datasets">Merging datasets</h2>
<section id="preparing-the-dataframes" class="level3">
<h3 class="anchored" data-anchor-id="preparing-the-dataframes">Preparing the DataFrames</h3>
<p>We’ll prepare the traffic stop and weather rating DataFrames so that they’re ready to be merged:</p>
<ul>
<li>With the <code>ri</code> DataFrame, we’ll move the <code>stop_datetime</code> index to a column since the index will be lost during the merge.</li>
<li>With the weather DataFrame, we’ll select the <code>DATE</code> and <code>rating</code> columns and put them in a new DataFrame.</li>
</ul>
<div class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reset the index of 'ri'</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>ri.reset_index(inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine the head of 'ri'</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>display(ri.head())</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a DataFrame from the 'DATE' and 'rating' columns</span></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>weather_rating <span class="op">=</span> weather[[<span class="st">"DATE"</span>, <span class="st">"rating"</span>]]</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine the head of 'weather_rating'</span></span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>weather_rating.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>stop_date_time</th>
      <th>stop_date</th>
      <th>stop_time</th>
      <th>driver_gender</th>
      <th>driver_race</th>
      <th>violation_raw</th>
      <th>violation</th>
      <th>search_conducted</th>
      <th>search_type</th>
      <th>stop_outcome</th>
      <th>is_arrested</th>
      <th>stop_duration</th>
      <th>drugs_related_stop</th>
      <th>district</th>
      <th>frisk</th>
      <th>stop_minutes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2005-01-04 12:55:00</td>
      <td>2005-01-04</td>
      <td>12:55</td>
      <td>M</td>
      <td>White</td>
      <td>Equipment/Inspection Violation</td>
      <td>Equipment</td>
      <td>False</td>
      <td>NaN</td>
      <td>Citation</td>
      <td>False</td>
      <td>0-15 Min</td>
      <td>False</td>
      <td>Zone X4</td>
      <td>False</td>
      <td>8</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2005-01-23 23:15:00</td>
      <td>2005-01-23</td>
      <td>23:15</td>
      <td>M</td>
      <td>White</td>
      <td>Speeding</td>
      <td>Speeding</td>
      <td>False</td>
      <td>NaN</td>
      <td>Citation</td>
      <td>False</td>
      <td>0-15 Min</td>
      <td>False</td>
      <td>Zone K3</td>
      <td>False</td>
      <td>8</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2005-02-17 04:15:00</td>
      <td>2005-02-17</td>
      <td>04:15</td>
      <td>M</td>
      <td>White</td>
      <td>Speeding</td>
      <td>Speeding</td>
      <td>False</td>
      <td>NaN</td>
      <td>Citation</td>
      <td>False</td>
      <td>0-15 Min</td>
      <td>False</td>
      <td>Zone X4</td>
      <td>False</td>
      <td>8</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2005-02-20 17:15:00</td>
      <td>2005-02-20</td>
      <td>17:15</td>
      <td>M</td>
      <td>White</td>
      <td>Call for Service</td>
      <td>Other</td>
      <td>False</td>
      <td>NaN</td>
      <td>Arrest Driver</td>
      <td>True</td>
      <td>16-30 Min</td>
      <td>False</td>
      <td>Zone X1</td>
      <td>False</td>
      <td>23</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2005-02-24 01:20:00</td>
      <td>2005-02-24</td>
      <td>01:20</td>
      <td>F</td>
      <td>White</td>
      <td>Speeding</td>
      <td>Speeding</td>
      <td>False</td>
      <td>NaN</td>
      <td>Citation</td>
      <td>False</td>
      <td>0-15 Min</td>
      <td>False</td>
      <td>Zone X3</td>
      <td>False</td>
      <td>8</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="38">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>DATE</th>
      <th>rating</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2005-01-01</td>
      <td>bad</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2005-01-02</td>
      <td>bad</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2005-01-03</td>
      <td>bad</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2005-01-04</td>
      <td>bad</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2005-01-05</td>
      <td>bad</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>The <code>ri</code> and <code>weather_rating</code> DataFrames are now ready to be merged.</p>
</section>
<section id="merging-the-dataframes" class="level3">
<h3 class="anchored" data-anchor-id="merging-the-dataframes">Merging the DataFrames</h3>
<p>We’ll merge the <code>ri</code> and <code>weather_rating</code> DataFrames into a new DataFrame, <code>ri_weather</code>.</p>
<p>The DataFrames will be joined using the <code>stop_date</code> column from <code>ri</code> and the <code>DATE</code> column from <code>weather_rating</code>. Thankfully the date formatting matches exactly, which is not always the case!</p>
<p>Once the merge is complete, we’ll set <code>stop_datetime</code> as the index</p>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine the shape of 'ri'</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(ri.shape)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge 'ri' and 'weather_rating' using a left join</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>ri_weather <span class="op">=</span> pd.merge(left<span class="op">=</span>ri, right<span class="op">=</span>weather_rating, left_on<span class="op">=</span><span class="st">'stop_date'</span>, right_on<span class="op">=</span><span class="st">'DATE'</span>, how<span class="op">=</span><span class="st">'left'</span>)</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine the shape of 'ri_weather'</span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(ri_weather.shape)</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Set 'stop_datetime' as the index of 'ri_weather'</span></span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>ri_weather.set_index(<span class="st">'stop_date_time'</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>ri_weather.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(86536, 16)
(86536, 18)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="39">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>stop_date</th>
      <th>stop_time</th>
      <th>driver_gender</th>
      <th>driver_race</th>
      <th>violation_raw</th>
      <th>violation</th>
      <th>search_conducted</th>
      <th>search_type</th>
      <th>stop_outcome</th>
      <th>is_arrested</th>
      <th>stop_duration</th>
      <th>drugs_related_stop</th>
      <th>district</th>
      <th>frisk</th>
      <th>stop_minutes</th>
      <th>DATE</th>
      <th>rating</th>
    </tr>
    <tr>
      <th>stop_date_time</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2005-01-04 12:55:00</th>
      <td>2005-01-04</td>
      <td>12:55</td>
      <td>M</td>
      <td>White</td>
      <td>Equipment/Inspection Violation</td>
      <td>Equipment</td>
      <td>False</td>
      <td>NaN</td>
      <td>Citation</td>
      <td>False</td>
      <td>0-15 Min</td>
      <td>False</td>
      <td>Zone X4</td>
      <td>False</td>
      <td>8</td>
      <td>2005-01-04</td>
      <td>bad</td>
    </tr>
    <tr>
      <th>2005-01-23 23:15:00</th>
      <td>2005-01-23</td>
      <td>23:15</td>
      <td>M</td>
      <td>White</td>
      <td>Speeding</td>
      <td>Speeding</td>
      <td>False</td>
      <td>NaN</td>
      <td>Citation</td>
      <td>False</td>
      <td>0-15 Min</td>
      <td>False</td>
      <td>Zone K3</td>
      <td>False</td>
      <td>8</td>
      <td>2005-01-23</td>
      <td>worse</td>
    </tr>
    <tr>
      <th>2005-02-17 04:15:00</th>
      <td>2005-02-17</td>
      <td>04:15</td>
      <td>M</td>
      <td>White</td>
      <td>Speeding</td>
      <td>Speeding</td>
      <td>False</td>
      <td>NaN</td>
      <td>Citation</td>
      <td>False</td>
      <td>0-15 Min</td>
      <td>False</td>
      <td>Zone X4</td>
      <td>False</td>
      <td>8</td>
      <td>2005-02-17</td>
      <td>good</td>
    </tr>
    <tr>
      <th>2005-02-20 17:15:00</th>
      <td>2005-02-20</td>
      <td>17:15</td>
      <td>M</td>
      <td>White</td>
      <td>Call for Service</td>
      <td>Other</td>
      <td>False</td>
      <td>NaN</td>
      <td>Arrest Driver</td>
      <td>True</td>
      <td>16-30 Min</td>
      <td>False</td>
      <td>Zone X1</td>
      <td>False</td>
      <td>23</td>
      <td>2005-02-20</td>
      <td>bad</td>
    </tr>
    <tr>
      <th>2005-02-24 01:20:00</th>
      <td>2005-02-24</td>
      <td>01:20</td>
      <td>F</td>
      <td>White</td>
      <td>Speeding</td>
      <td>Speeding</td>
      <td>False</td>
      <td>NaN</td>
      <td>Citation</td>
      <td>False</td>
      <td>0-15 Min</td>
      <td>False</td>
      <td>Zone X3</td>
      <td>False</td>
      <td>8</td>
      <td>2005-02-24</td>
      <td>bad</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>We’ll use ri_weather to analyze the relationship between weather conditions and police behavior.</p>
</section>
</section>
<section id="does-weather-affect-the-arrest-rate" class="level2">
<h2 class="anchored" data-anchor-id="does-weather-affect-the-arrest-rate">Does weather affect the arrest rate?</h2>
<section id="comparing-arrest-rates-by-weather-rating" class="level3">
<h3 class="anchored" data-anchor-id="comparing-arrest-rates-by-weather-rating">Comparing arrest rates by weather rating</h3>
<p>Do police officers arrest drivers more often when the weather is bad? Let’s find out below!</p>
<ul>
<li>First, we’ll calculate the overall arrest rate.</li>
<li>Then, we’ll calculate the arrest rate for each of the weather ratings we previously assigned.</li>
<li>Finally, we’ll add violation type as a second factor in the analysis, to see if that accounts for any differences in the arrest rate.</li>
</ul>
<p>Since we previously defined a logical order for the weather categories, good &lt; bad &lt; worse, they will be sorted that way in the results.</p>
<div class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the overall arrest rate</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(ri_weather.is_arrested.mean())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.0355690117407784</code></pre>
</div>
</div>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the arrest rate for each 'rating'</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>ri_weather.groupby(<span class="st">"rating"</span>).is_arrested.mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">
<pre><code>rating
good     0.033715
bad      0.036261
worse    0.041667
Name: is_arrested, dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the arrest rate for each 'violation' and 'rating'</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>ri_weather.groupby([<span class="st">"violation"</span>, <span class="st">'rating'</span>]).is_arrested.mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<pre><code>violation            rating
Equipment            good      0.059007
                     bad       0.066311
                     worse     0.097357
Moving violation     good      0.056227
                     bad       0.058050
                     worse     0.065860
Other                good      0.076966
                     bad       0.087443
                     worse     0.062893
Registration/plates  good      0.081574
                     bad       0.098160
                     worse     0.115625
Seat belt            good      0.028587
                     bad       0.022493
                     worse     0.000000
Speeding             good      0.013405
                     bad       0.013314
                     worse     0.016886
Name: is_arrested, dtype: float64</code></pre>
</div>
</div>
<p>The arrest rate increases as the weather gets worse, and that trend persists across many of the violation types. This doesn’t prove a causal link, but it’s quite an interesting result!</p>
</section>
<section id="selecting-from-a-multi-indexed-series" class="level3">
<h3 class="anchored" data-anchor-id="selecting-from-a-multi-indexed-series">Selecting from a multi-indexed Series</h3>
<p>The output of a single <code>.groupby()</code> operation on multiple columns is a Series with a MultiIndex. Working with this type of object is similar to working with a DataFrame:</p>
<ul>
<li>The outer index level is like the DataFrame rows.</li>
<li>The inner index level is like the DataFrame columns.</li>
</ul>
<div class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the output of the groupby operation from the last exercise</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>arrest_rate <span class="op">=</span> ri_weather.groupby([<span class="st">'violation'</span>, <span class="st">'rating'</span>]).is_arrested.mean()</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the arrest rate for moving violations in bad weather</span></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>display(arrest_rate.loc[<span class="st">"Moving violation"</span>, <span class="st">"bad"</span>])</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the arrest rates for speeding violations in all three weather conditions</span></span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>arrest_rate.loc[<span class="st">"Speeding"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0.05804964058049641</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="43">
<pre><code>rating
good     0.013405
bad      0.013314
worse    0.016886
Name: is_arrested, dtype: float64</code></pre>
</div>
</div>
</section>
<section id="reshaping-the-arrest-rate-data" class="level3">
<h3 class="anchored" data-anchor-id="reshaping-the-arrest-rate-data">Reshaping the arrest rate data</h3>
<p>We’ll start by reshaping the arrest_rate Series into a DataFrame. This is a useful step when working with any multi-indexed Series, since it enables you to access the full range of DataFrame methods.</p>
<p>Then, we’ll create the exact same DataFrame using a pivot table. This is a great example of how pandas often gives you more than one way to reach the same result!</p>
<div class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Unstack the 'arrest_rate' Series into a DataFrame</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>display(arrest_rate.unstack())</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the same DataFrame using a pivot table</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>ri_weather.pivot_table(index<span class="op">=</span><span class="st">'violation'</span>, columns<span class="op">=</span><span class="st">'rating'</span>, values<span class="op">=</span><span class="st">'is_arrested'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th>rating</th>
      <th>good</th>
      <th>bad</th>
      <th>worse</th>
    </tr>
    <tr>
      <th>violation</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Equipment</th>
      <td>0.059007</td>
      <td>0.066311</td>
      <td>0.097357</td>
    </tr>
    <tr>
      <th>Moving violation</th>
      <td>0.056227</td>
      <td>0.058050</td>
      <td>0.065860</td>
    </tr>
    <tr>
      <th>Other</th>
      <td>0.076966</td>
      <td>0.087443</td>
      <td>0.062893</td>
    </tr>
    <tr>
      <th>Registration/plates</th>
      <td>0.081574</td>
      <td>0.098160</td>
      <td>0.115625</td>
    </tr>
    <tr>
      <th>Seat belt</th>
      <td>0.028587</td>
      <td>0.022493</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>Speeding</th>
      <td>0.013405</td>
      <td>0.013314</td>
      <td>0.016886</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="44">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th>rating</th>
      <th>good</th>
      <th>bad</th>
      <th>worse</th>
    </tr>
    <tr>
      <th>violation</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Equipment</th>
      <td>0.059007</td>
      <td>0.066311</td>
      <td>0.097357</td>
    </tr>
    <tr>
      <th>Moving violation</th>
      <td>0.056227</td>
      <td>0.058050</td>
      <td>0.065860</td>
    </tr>
    <tr>
      <th>Other</th>
      <td>0.076966</td>
      <td>0.087443</td>
      <td>0.062893</td>
    </tr>
    <tr>
      <th>Registration/plates</th>
      <td>0.081574</td>
      <td>0.098160</td>
      <td>0.115625</td>
    </tr>
    <tr>
      <th>Seat belt</th>
      <td>0.028587</td>
      <td>0.022493</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>Speeding</th>
      <td>0.013405</td>
      <td>0.013314</td>
      <td>0.016886</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>