<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Victor Omondi">
<meta name="dcterms.date" content="2020-07-08">
<meta name="description" content="Expanding and honing hacker stats toolbox to perform the two key tasks in statistical inference, parameter estimation and hypothesis testing.">

<title>blog - Statistical Thinking in Python (Part 2)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">blog</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../about.html">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/VictorOmondi1997"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/VictorOmondi197"><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Statistical Thinking in Python (Part 2)</h1>
                  <div>
        <div class="description">
          Expanding and honing hacker stats toolbox to perform the two key tasks in statistical inference, parameter estimation and hypothesis testing.
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">statistical-thinking</div>
                <div class="quarto-category">hypothesis-testing</div>
                <div class="quarto-category">data-science</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Victor Omondi </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">July 8, 2020</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#libraries" id="toc-libraries" class="nav-link active" data-scroll-target="#libraries">Libraries</a></li>
  <li><a href="#parameter-estimation-by-optimization" id="toc-parameter-estimation-by-optimization" class="nav-link" data-scroll-target="#parameter-estimation-by-optimization">Parameter estimation by optimization</a>
  <ul class="collapse">
  <li><a href="#optimal-parameters" id="toc-optimal-parameters" class="nav-link" data-scroll-target="#optimal-parameters">Optimal parameters</a>
  <ul class="collapse">
  <li><a href="#how-often-do-we-get-no-hitters" id="toc-how-often-do-we-get-no-hitters" class="nav-link" data-scroll-target="#how-often-do-we-get-no-hitters">How often do we get no-hitters?</a></li>
  <li><a href="#do-the-data-follow-our-story" id="toc-do-the-data-follow-our-story" class="nav-link" data-scroll-target="#do-the-data-follow-our-story">Do the data follow our story?</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#how-is-this-parameter-optimal" id="toc-how-is-this-parameter-optimal" class="nav-link" data-scroll-target="#how-is-this-parameter-optimal">How is this parameter optimal?</a>
  <ul class="collapse">
  <li><a href="#linear-regression-by-least-squares" id="toc-linear-regression-by-least-squares" class="nav-link" data-scroll-target="#linear-regression-by-least-squares">Linear regression by least squares</a>
  <ul class="collapse">
  <li><a href="#eda-of-literacyfertility-data" id="toc-eda-of-literacyfertility-data" class="nav-link" data-scroll-target="#eda-of-literacyfertility-data">EDA of literacy/fertility data</a></li>
  <li><a href="#linear-regression" id="toc-linear-regression" class="nav-link" data-scroll-target="#linear-regression">Linear regression</a></li>
  <li><a href="#how-is-it-optimal" id="toc-how-is-it-optimal" class="nav-link" data-scroll-target="#how-is-it-optimal">How is it optimal?</a></li>
  </ul></li>
  <li><a href="#the-importance-of-eda-anscombes-quartet" id="toc-the-importance-of-eda-anscombes-quartet" class="nav-link" data-scroll-target="#the-importance-of-eda-anscombes-quartet">The importance of EDA: Anscombe’s quartet</a>
  <ul class="collapse">
  <li><a href="#linear-regression-on-appropriate-anscombe-data" id="toc-linear-regression-on-appropriate-anscombe-data" class="nav-link" data-scroll-target="#linear-regression-on-appropriate-anscombe-data">Linear regression on appropriate Anscombe data</a></li>
  <li><a href="#linear-regression-on-all-anscombe-data" id="toc-linear-regression-on-all-anscombe-data" class="nav-link" data-scroll-target="#linear-regression-on-all-anscombe-data">Linear regression on all Anscombe data</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#bootstrap-confidence-intervals" id="toc-bootstrap-confidence-intervals" class="nav-link" data-scroll-target="#bootstrap-confidence-intervals">Bootstrap confidence intervals</a>
  <ul class="collapse">
  <li><a href="#generating-bootstrap-replicates" id="toc-generating-bootstrap-replicates" class="nav-link" data-scroll-target="#generating-bootstrap-replicates">Generating bootstrap replicates</a>
  <ul class="collapse">
  <li><a href="#getting-the-terminology-down" id="toc-getting-the-terminology-down" class="nav-link" data-scroll-target="#getting-the-terminology-down">Getting the terminology down</a></li>
  <li><a href="#visualizing-bootstrap-samples" id="toc-visualizing-bootstrap-samples" class="nav-link" data-scroll-target="#visualizing-bootstrap-samples">Visualizing bootstrap samples</a></li>
  </ul></li>
  <li><a href="#bootstrap-confidence-intervals-1" id="toc-bootstrap-confidence-intervals-1" class="nav-link" data-scroll-target="#bootstrap-confidence-intervals-1">Bootstrap confidence intervals</a>
  <ul class="collapse">
  <li><a href="#generating-many-bootstrap-replicates" id="toc-generating-many-bootstrap-replicates" class="nav-link" data-scroll-target="#generating-many-bootstrap-replicates">Generating many bootstrap replicates</a></li>
  <li><a href="#bootstrap-replicates-of-the-mean-and-the-sem" id="toc-bootstrap-replicates-of-the-mean-and-the-sem" class="nav-link" data-scroll-target="#bootstrap-replicates-of-the-mean-and-the-sem">Bootstrap replicates of the mean and the SEM</a></li>
  <li><a href="#confidence-intervals-of-rainfall-data" id="toc-confidence-intervals-of-rainfall-data" class="nav-link" data-scroll-target="#confidence-intervals-of-rainfall-data">Confidence intervals of rainfall data</a></li>
  <li><a href="#bootstrap-replicates-of-other-statistics" id="toc-bootstrap-replicates-of-other-statistics" class="nav-link" data-scroll-target="#bootstrap-replicates-of-other-statistics">Bootstrap replicates of other statistics</a></li>
  <li><a href="#confidence-interval-on-the-rate-of-no-hitters" id="toc-confidence-interval-on-the-rate-of-no-hitters" class="nav-link" data-scroll-target="#confidence-interval-on-the-rate-of-no-hitters">Confidence interval on the rate of no-hitters</a></li>
  </ul></li>
  <li><a href="#pairs-bootstrap" id="toc-pairs-bootstrap" class="nav-link" data-scroll-target="#pairs-bootstrap">Pairs bootstrap</a>
  <ul class="collapse">
  <li><a href="#a-function-to-do-pairs-bootstrap" id="toc-a-function-to-do-pairs-bootstrap" class="nav-link" data-scroll-target="#a-function-to-do-pairs-bootstrap">A function to do pairs bootstrap</a></li>
  <li><a href="#pairs-bootstrap-of-literacyfertility-data" id="toc-pairs-bootstrap-of-literacyfertility-data" class="nav-link" data-scroll-target="#pairs-bootstrap-of-literacyfertility-data">Pairs bootstrap of literacy/fertility data</a></li>
  <li><a href="#plotting-bootstrap-regressions" id="toc-plotting-bootstrap-regressions" class="nav-link" data-scroll-target="#plotting-bootstrap-regressions">Plotting bootstrap regressions</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#introduction-to-hypothesis-testing" id="toc-introduction-to-hypothesis-testing" class="nav-link" data-scroll-target="#introduction-to-hypothesis-testing">Introduction to hypothesis testing</a>
  <ul class="collapse">
  <li><a href="#formulating-and-simulating-a-hypothesis" id="toc-formulating-and-simulating-a-hypothesis" class="nav-link" data-scroll-target="#formulating-and-simulating-a-hypothesis">Formulating and simulating a hypothesis</a>
  <ul class="collapse">
  <li><a href="#generating-a-permutation-sample" id="toc-generating-a-permutation-sample" class="nav-link" data-scroll-target="#generating-a-permutation-sample">Generating a permutation sample</a></li>
  <li><a href="#visualizing-permutation-sampling" id="toc-visualizing-permutation-sampling" class="nav-link" data-scroll-target="#visualizing-permutation-sampling">Visualizing permutation sampling</a></li>
  </ul></li>
  <li><a href="#test-statistics-and-p-values" id="toc-test-statistics-and-p-values" class="nav-link" data-scroll-target="#test-statistics-and-p-values">Test statistics and p-values</a>
  <ul class="collapse">
  <li><a href="#test-statistics" id="toc-test-statistics" class="nav-link" data-scroll-target="#test-statistics">Test statistics</a></li>
  <li><a href="#p-value-1" id="toc-p-value-1" class="nav-link" data-scroll-target="#p-value-1">p-value</a></li>
  <li><a href="#generating-permutation-replicates" id="toc-generating-permutation-replicates" class="nav-link" data-scroll-target="#generating-permutation-replicates">Generating permutation replicates</a></li>
  <li><a href="#look-before-you-leap-eda-before-hypothesis-testing" id="toc-look-before-you-leap-eda-before-hypothesis-testing" class="nav-link" data-scroll-target="#look-before-you-leap-eda-before-hypothesis-testing">Look before you leap: EDA before hypothesis testing</a></li>
  <li><a href="#permutation-test-on-frog-data" id="toc-permutation-test-on-frog-data" class="nav-link" data-scroll-target="#permutation-test-on-frog-data">Permutation test on frog data</a></li>
  </ul></li>
  <li><a href="#bootstrap-hypothesis-tests" id="toc-bootstrap-hypothesis-tests" class="nav-link" data-scroll-target="#bootstrap-hypothesis-tests">Bootstrap hypothesis tests</a>
  <ul class="collapse">
  <li><a href="#a-one-sample-bootstrap-hypothesis-test" id="toc-a-one-sample-bootstrap-hypothesis-test" class="nav-link" data-scroll-target="#a-one-sample-bootstrap-hypothesis-test">A one-sample bootstrap hypothesis test</a></li>
  <li><a href="#a-two-sample-bootstrap-hypothesis-test-for-difference-of-means" id="toc-a-two-sample-bootstrap-hypothesis-test-for-difference-of-means" class="nav-link" data-scroll-target="#a-two-sample-bootstrap-hypothesis-test-for-difference-of-means">A two-sample bootstrap hypothesis test for difference of means</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#hypothesis-test-examples" id="toc-hypothesis-test-examples" class="nav-link" data-scroll-target="#hypothesis-test-examples">Hypothesis test examples</a>
  <ul class="collapse">
  <li><a href="#ab-testing" id="toc-ab-testing" class="nav-link" data-scroll-target="#ab-testing">A/B testing</a>
  <ul class="collapse">
  <li><a href="#the-vote-for-the-civil-rights-act-in-1964" id="toc-the-vote-for-the-civil-rights-act-in-1964" class="nav-link" data-scroll-target="#the-vote-for-the-civil-rights-act-in-1964">The vote for the Civil Rights Act in 1964</a></li>
  <li><a href="#a-time-on-website-analog" id="toc-a-time-on-website-analog" class="nav-link" data-scroll-target="#a-time-on-website-analog">A time-on-website analog</a></li>
  </ul></li>
  <li><a href="#test-of-correlation" id="toc-test-of-correlation" class="nav-link" data-scroll-target="#test-of-correlation">Test of correlation</a>
  <ul class="collapse">
  <li><a href="#simulating-a-null-hypothesis-concerning-correlation" id="toc-simulating-a-null-hypothesis-concerning-correlation" class="nav-link" data-scroll-target="#simulating-a-null-hypothesis-concerning-correlation">Simulating a null hypothesis concerning correlation</a></li>
  <li><a href="#hypothesis-test-on-pearson-correlation" id="toc-hypothesis-test-on-pearson-correlation" class="nav-link" data-scroll-target="#hypothesis-test-on-pearson-correlation">Hypothesis test on Pearson correlation</a></li>
  <li><a href="#do-neonicotinoid-insecticides-have-unintended-consequences" id="toc-do-neonicotinoid-insecticides-have-unintended-consequences" class="nav-link" data-scroll-target="#do-neonicotinoid-insecticides-have-unintended-consequences">Do neonicotinoid insecticides have unintended consequences?</a></li>
  <li><a href="#bootstrap-hypothesis-test-on-bee-sperm-counts" id="toc-bootstrap-hypothesis-test-on-bee-sperm-counts" class="nav-link" data-scroll-target="#bootstrap-hypothesis-test-on-bee-sperm-counts">Bootstrap hypothesis test on bee sperm counts</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#a-case-study" id="toc-a-case-study" class="nav-link" data-scroll-target="#a-case-study">a case study</a>
  <ul class="collapse">
  <li><a href="#eda-of-beak-depths-of-darwins-finches" id="toc-eda-of-beak-depths-of-darwins-finches" class="nav-link" data-scroll-target="#eda-of-beak-depths-of-darwins-finches">EDA of beak depths of Darwin’s finches</a></li>
  <li><a href="#ecdfs-of-beak-depths" id="toc-ecdfs-of-beak-depths" class="nav-link" data-scroll-target="#ecdfs-of-beak-depths">ECDFs of beak depths</a></li>
  <li><a href="#parameter-estimates-of-beak-depths" id="toc-parameter-estimates-of-beak-depths" class="nav-link" data-scroll-target="#parameter-estimates-of-beak-depths">Parameter estimates of beak depths</a></li>
  <li><a href="#hypothesis-test-are-beaks-deeper-in-2012" id="toc-hypothesis-test-are-beaks-deeper-in-2012" class="nav-link" data-scroll-target="#hypothesis-test-are-beaks-deeper-in-2012">Hypothesis test: Are beaks deeper in 2012?</a></li>
  <li><a href="#variation-in-beak-shapes" id="toc-variation-in-beak-shapes" class="nav-link" data-scroll-target="#variation-in-beak-shapes">Variation in beak shapes</a>
  <ul class="collapse">
  <li><a href="#eda-of-beak-length-and-depth" id="toc-eda-of-beak-length-and-depth" class="nav-link" data-scroll-target="#eda-of-beak-length-and-depth">EDA of beak length and depth</a></li>
  <li><a href="#linear-regressions" id="toc-linear-regressions" class="nav-link" data-scroll-target="#linear-regressions">Linear regressions</a></li>
  <li><a href="#displaying-the-linear-regression-results" id="toc-displaying-the-linear-regression-results" class="nav-link" data-scroll-target="#displaying-the-linear-regression-results">Displaying the linear regression results</a></li>
  <li><a href="#beak-length-to-depth-ratio" id="toc-beak-length-to-depth-ratio" class="nav-link" data-scroll-target="#beak-length-to-depth-ratio">Beak length to depth ratio</a></li>
  </ul></li>
  <li><a href="#calculation-of-heritability" id="toc-calculation-of-heritability" class="nav-link" data-scroll-target="#calculation-of-heritability">Calculation of heritability</a>
  <ul class="collapse">
  <li><a href="#eda-of-heritability" id="toc-eda-of-heritability" class="nav-link" data-scroll-target="#eda-of-heritability">EDA of heritability</a></li>
  <li><a href="#correlation-of-offspring-and-parental-data" id="toc-correlation-of-offspring-and-parental-data" class="nav-link" data-scroll-target="#correlation-of-offspring-and-parental-data">Correlation of offspring and parental data</a></li>
  <li><a href="#pearson-correlation-of-offspring-and-parental-data" id="toc-pearson-correlation-of-offspring-and-parental-data" class="nav-link" data-scroll-target="#pearson-correlation-of-offspring-and-parental-data">Pearson correlation of offspring and parental data</a></li>
  <li><a href="#measuring-heritability" id="toc-measuring-heritability" class="nav-link" data-scroll-target="#measuring-heritability">Measuring heritability</a></li>
  <li><a href="#is-beak-depth-heritable-at-all-in-g.-scandens" id="toc-is-beak-depth-heritable-at-all-in-g.-scandens" class="nav-link" data-scroll-target="#is-beak-depth-heritable-at-all-in-g.-scandens">Is beak depth heritable at all in G. scandens?</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="libraries" class="level1">
<h1>Libraries</h1>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>sns.<span class="bu">set</span>()</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="parameter-estimation-by-optimization" class="level1">
<h1>Parameter estimation by optimization</h1>
<p>When doing statistical inference, we speak the language of probability. A probability distribution that describes your data has parameters. So, a major goal of statistical inference is to estimate the values of these parameters, which allows us to concisely and unambiguously describe our data and draw conclusions from it. We will find the optimal parameters, those that best describe your data.</p>
<section id="optimal-parameters" class="level2">
<h2 class="anchored" data-anchor-id="optimal-parameters">Optimal parameters</h2>
<blockquote class="blockquote">
<h3 id="optimal-parameters-1" class="anchored">Optimal parameters</h3>
<ul>
<li>Parameter values that bring the model in closest agreement with the data</li>
</ul>
</blockquote>
<blockquote class="blockquote">
<h3 id="packages-to-do-statistical-inference" class="anchored">Packages to do statistical inference</h3>
<table class="table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th>package</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><img src="https://docs.scipy.org/doc/scipy/reference/_static/img/scipy_org_logo.png" alt="scipy_org_logo" width="250"></td>
<td><code>scipy.stats</code></td>
</tr>
<tr class="even">
<td><img src="https://www.statsmodels.org/stable/_images/statsmodels-logo-v2-horizontal.svg" alt="statsmodels-logo-v2-horizontal" width="250"></td>
<td><code>statsmodels</code></td>
</tr>
<tr class="odd">
<td><img src="https://numpy.org/images/logos/numpy.svg" alt="numpy" style="height:50px"></td>
<td>hacker stats with <code>numpy</code></td>
</tr>
</tbody>
</table>
</blockquote>
<section id="how-often-do-we-get-no-hitters" class="level3">
<h3 class="anchored" data-anchor-id="how-often-do-we-get-no-hitters">How often do we get no-hitters?</h3>
<p>The number of games played between each no-hitter in the modern era (<span class="math inline">\(1901-2015\)</span>) of Major League Baseball is stored in the array <code>nohitter_times.</code></p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>nohitter_times <span class="op">=</span> np.array([ <span class="dv">843</span>, <span class="dv">1613</span>, <span class="dv">1101</span>,  <span class="dv">215</span>,  <span class="dv">684</span>,  <span class="dv">814</span>,  <span class="dv">278</span>,  <span class="dv">324</span>,  <span class="dv">161</span>,  <span class="dv">219</span>,  <span class="dv">545</span>,</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>                           <span class="dv">715</span>,  <span class="dv">966</span>,  <span class="dv">624</span>,   <span class="dv">29</span>,  <span class="dv">450</span>,  <span class="dv">107</span>,   <span class="dv">20</span>,   <span class="dv">91</span>, <span class="dv">1325</span>,  <span class="dv">124</span>, <span class="dv">1468</span>,</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>                           <span class="dv">104</span>, <span class="dv">1309</span>,  <span class="dv">429</span>,   <span class="dv">62</span>, <span class="dv">1878</span>, <span class="dv">1104</span>,  <span class="dv">123</span>,  <span class="dv">251</span>,   <span class="dv">93</span>,  <span class="dv">188</span>,  <span class="dv">983</span>,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>                           <span class="dv">166</span>,   <span class="dv">96</span>,  <span class="dv">702</span>,   <span class="dv">23</span>,  <span class="dv">524</span>,   <span class="dv">26</span>,  <span class="dv">299</span>,   <span class="dv">59</span>,   <span class="dv">39</span>,   <span class="dv">12</span>,    <span class="dv">2</span>,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>                           <span class="dv">308</span>, <span class="dv">1114</span>,  <span class="dv">813</span>,  <span class="dv">887</span>,  <span class="dv">645</span>, <span class="dv">2088</span>,   <span class="dv">42</span>, <span class="dv">2090</span>,   <span class="dv">11</span>,  <span class="dv">886</span>, <span class="dv">1665</span>,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>                           <span class="dv">1084</span>, <span class="dv">2900</span>, <span class="dv">2432</span>,  <span class="dv">750</span>, <span class="dv">4021</span>, <span class="dv">1070</span>, <span class="dv">1765</span>, <span class="dv">1322</span>,   <span class="dv">26</span>,  <span class="dv">548</span>, <span class="dv">1525</span>,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>                           <span class="dv">77</span>, <span class="dv">2181</span>, <span class="dv">2752</span>,  <span class="dv">127</span>, <span class="dv">2147</span>,  <span class="dv">211</span>,   <span class="dv">41</span>, <span class="dv">1575</span>,  <span class="dv">151</span>,  <span class="dv">479</span>,  <span class="dv">697</span>,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>                           <span class="dv">557</span>, <span class="dv">2267</span>,  <span class="dv">542</span>,  <span class="dv">392</span>,   <span class="dv">73</span>,  <span class="dv">603</span>,  <span class="dv">233</span>,  <span class="dv">255</span>,  <span class="dv">528</span>,  <span class="dv">397</span>, <span class="dv">1529</span>,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>                           <span class="dv">1023</span>, <span class="dv">1194</span>,  <span class="dv">462</span>,  <span class="dv">583</span>,   <span class="dv">37</span>,  <span class="dv">943</span>,  <span class="dv">996</span>,  <span class="dv">480</span>, <span class="dv">1497</span>,  <span class="dv">717</span>,  <span class="dv">224</span>,</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>                           <span class="dv">219</span>, <span class="dv">1531</span>,  <span class="dv">498</span>,   <span class="dv">44</span>,  <span class="dv">288</span>,  <span class="dv">267</span>,  <span class="dv">600</span>,   <span class="dv">52</span>,  <span class="dv">269</span>, <span class="dv">1086</span>,  <span class="dv">386</span>,</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>                           <span class="dv">176</span>, <span class="dv">2199</span>,  <span class="dv">216</span>,   <span class="dv">54</span>,  <span class="dv">675</span>, <span class="dv">1243</span>,  <span class="dv">463</span>,  <span class="dv">650</span>,  <span class="dv">171</span>,  <span class="dv">327</span>,  <span class="dv">110</span>,</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>                           <span class="dv">774</span>,  <span class="dv">509</span>,    <span class="dv">8</span>,  <span class="dv">197</span>,  <span class="dv">136</span>,   <span class="dv">12</span>, <span class="dv">1124</span>,   <span class="dv">64</span>,  <span class="dv">380</span>,  <span class="dv">811</span>,  <span class="dv">232</span>,</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>                           <span class="dv">192</span>,  <span class="dv">731</span>,  <span class="dv">715</span>,  <span class="dv">226</span>,  <span class="dv">605</span>,  <span class="dv">539</span>, <span class="dv">1491</span>,  <span class="dv">323</span>,  <span class="dv">240</span>,  <span class="dv">179</span>,  <span class="dv">702</span>,</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>                           <span class="dv">156</span>,   <span class="dv">82</span>, <span class="dv">1397</span>,  <span class="dv">354</span>,  <span class="dv">778</span>,  <span class="dv">603</span>, <span class="dv">1001</span>,  <span class="dv">385</span>,  <span class="dv">986</span>,  <span class="dv">203</span>,  <span class="dv">149</span>,</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>                           <span class="dv">576</span>,  <span class="dv">445</span>,  <span class="dv">180</span>, <span class="dv">1403</span>,  <span class="dv">252</span>,  <span class="dv">675</span>, <span class="dv">1351</span>, <span class="dv">2983</span>, <span class="dv">1568</span>,   <span class="dv">45</span>,  <span class="dv">899</span>,</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>                           <span class="dv">3260</span>, <span class="dv">1025</span>,   <span class="dv">31</span>,  <span class="dv">100</span>, <span class="dv">2055</span>, <span class="dv">4043</span>,   <span class="dv">79</span>,  <span class="dv">238</span>, <span class="dv">3931</span>, <span class="dv">2351</span>,  <span class="dv">595</span>,</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>                           <span class="dv">110</span>,  <span class="dv">215</span>,    <span class="dv">0</span>,  <span class="dv">563</span>,  <span class="dv">206</span>,  <span class="dv">660</span>,  <span class="dv">242</span>,  <span class="dv">577</span>,  <span class="dv">179</span>,  <span class="dv">157</span>,  <span class="dv">192</span>,</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>                           <span class="dv">192</span>, <span class="dv">1848</span>,  <span class="dv">792</span>, <span class="dv">1693</span>,   <span class="dv">55</span>,  <span class="dv">388</span>,  <span class="dv">225</span>, <span class="dv">1134</span>, <span class="dv">1172</span>, <span class="dv">1555</span>,   <span class="dv">31</span>,</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>                           <span class="dv">1582</span>, <span class="dv">1044</span>,  <span class="dv">378</span>, <span class="dv">1687</span>, <span class="dv">2915</span>,  <span class="dv">280</span>,  <span class="dv">765</span>, <span class="dv">2819</span>,  <span class="dv">511</span>, <span class="dv">1521</span>,  <span class="dv">745</span>,</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>                           <span class="dv">2491</span>,  <span class="dv">580</span>, <span class="dv">2072</span>, <span class="dv">6450</span>,  <span class="dv">578</span>,  <span class="dv">745</span>, <span class="dv">1075</span>, <span class="dv">1103</span>, <span class="dv">1549</span>, <span class="dv">1520</span>,  <span class="dv">138</span>,</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>                           <span class="dv">1202</span>,  <span class="dv">296</span>,  <span class="dv">277</span>,  <span class="dv">351</span>,  <span class="dv">391</span>,  <span class="dv">950</span>,  <span class="dv">459</span>,   <span class="dv">62</span>, <span class="dv">1056</span>, <span class="dv">1128</span>,  <span class="dv">139</span>,</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>                           <span class="dv">420</span>,   <span class="dv">87</span>,   <span class="dv">71</span>,  <span class="dv">814</span>,  <span class="dv">603</span>, <span class="dv">1349</span>,  <span class="dv">162</span>, <span class="dv">1027</span>,  <span class="dv">783</span>,  <span class="dv">326</span>,  <span class="dv">101</span>,</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>                           <span class="dv">876</span>,  <span class="dv">381</span>,  <span class="dv">905</span>,  <span class="dv">156</span>,  <span class="dv">419</span>,  <span class="dv">239</span>,  <span class="dv">119</span>,  <span class="dv">129</span>,  <span class="dv">467</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If we assume that no-hitters are described as a Poisson process, then the time between no-hitters is Exponentially distributed. As we have seen, the Exponential distribution has a single parameter, which we will call τ, the typical interval time. The value of the parameter τ that makes the exponential distribution best match the data is the mean interval time (where time is in units of number of games) between no-hitters.</p>
<p>We will compute the value of this parameter from the data. Then, <code>use np.random.exponential()</code> to “repeat” the history of Major League Baseball by drawing inter-no-hitter times from an exponential distribution with the τ we found and plot the histogram as an approximation to the PDF.</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Seed random number generator</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute mean no-hitter time: tau</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>tau <span class="op">=</span> np.mean(nohitter_times)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Draw out of an exponential distribution with parameter tau: inter_nohitter_time</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>inter_nohitter_time <span class="op">=</span> np.random.exponential(tau, <span class="dv">100000</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the PDF and label axes</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.hist(inter_nohitter_time,</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>             bins<span class="op">=</span><span class="dv">50</span>, density<span class="op">=</span><span class="va">True</span>, histtype<span class="op">=</span><span class="st">"step"</span>)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.xlabel(<span class="st">'Games between no-hitters'</span>)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.ylabel(<span class="st">'PDF'</span>)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the plot</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2020-07-08-Statistical Thinking in Python (Part 2)_files/figure-html/cell-4-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>We see the typical shape of the Exponential distribution, going from a maximum at 0 and decaying to the right.</p>
</div>
</div>
</section>
<section id="do-the-data-follow-our-story" class="level3">
<h3 class="anchored" data-anchor-id="do-the-data-follow-our-story">Do the data follow our story?</h3>
<p>We have modeled no-hitters using an Exponential distribution. Let’s create an ECDF of the real data. Overlay the theoretical CDF with the ECDF from the data. This helps us to verify that the Exponential distribution describes the observed data.</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> ecdf(data):</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.sort(data), np.arange(<span class="dv">1</span>, <span class="bu">len</span>(data)<span class="op">+</span><span class="dv">1</span>) <span class="op">/</span> <span class="bu">len</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an ECDF from real data: x, y</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>x, y <span class="op">=</span> ecdf(nohitter_times)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a CDF from theoretical samples: x_theor, y_theor</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>x_theor, y_theor <span class="op">=</span> ecdf(inter_nohitter_time)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Overlay the plots</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>plt.plot(x_theor, y_theor)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>plt.plot(x, y, marker<span class="op">=</span><span class="st">"."</span>, linestyle<span class="op">=</span><span class="st">"none"</span>)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Margins and axis labels</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>plt.margins(<span class="fl">.02</span>)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Games between no-hitters'</span>)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'CDF'</span>)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the plot</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2020-07-08-Statistical Thinking in Python (Part 2)_files/figure-html/cell-6-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>It looks like no-hitters in the modern era of Major League Baseball are Exponentially distributed. Based on the story of the Exponential distribution, this suggests that they are a random process; when a no-hitter will happen is independent of when the last no-hitter was.</p>
</section>
</section>
</section>
<section id="how-is-this-parameter-optimal" class="level1">
<h1>How is this parameter optimal?</h1>
<p>We will now sample out of an exponential distribution with <span class="math inline">\(\tau\)</span> being twice as large as the optimal <span class="math inline">\(\tau\)</span>. Do it again for <span class="math inline">\(\tau\)</span> half as large. Make CDFs of these samples and overlay them with our data.</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the theoretical CDFs</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>plt.plot(x_theor, y_theor)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>plt.plot(x, y, marker<span class="op">=</span><span class="st">'.'</span>, linestyle<span class="op">=</span><span class="st">'none'</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>plt.margins(<span class="fl">0.02</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Games between no-hitters'</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'CDF'</span>)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Take samples with half tau: samples_half</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>samples_half <span class="op">=</span> np.random.exponential(tau<span class="op">/</span><span class="dv">2</span>, size<span class="op">=</span><span class="dv">10000</span>)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Take samples with double tau: samples_double</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>samples_double <span class="op">=</span> np.random.exponential(tau<span class="op">*</span><span class="dv">2</span>, size<span class="op">=</span><span class="dv">10000</span>)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate CDFs from these samples</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>x_half, y_half <span class="op">=</span> ecdf(samples_half)</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>x_double, y_double <span class="op">=</span> ecdf(samples_double)</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot these CDFs as lines</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.plot(x_half, y_half)</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.plot(x_double, y_double)</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the plot</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2020-07-08-Statistical Thinking in Python (Part 2)_files/figure-html/cell-7-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Notice how the value of tau given by the mean matches the data best. In this way, tau is an optimal parameter.</p>
</div>
</div>
<p>We can see that they do not reproduce the data as well. Thus, the <span class="math inline">\(\tau\)</span> we computed from the mean inter-no-hitter times is optimal in that it best reproduces the data.</p>
<section id="linear-regression-by-least-squares" class="level2">
<h2 class="anchored" data-anchor-id="linear-regression-by-least-squares">Linear regression by least squares</h2>
<blockquote class="blockquote">
<h3 id="least-squares" class="anchored">Least squares</h3>
<ul>
<li>The process of nding the parameters for which the sum ofthe squares ofthe residuals is minimal</li>
</ul>
</blockquote>
<section id="eda-of-literacyfertility-data" class="level3">
<h3 class="anchored" data-anchor-id="eda-of-literacyfertility-data">EDA of literacy/fertility data</h3>
<p>we will look at the correlation between female literacy and fertility (defined as the average number of children born per woman) throughout the world. For ease of analysis and interpretation, we will work with the illiteracy rate.</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>illiteracy<span class="op">=</span> np.array([ <span class="fl">9.5</span>, <span class="fl">49.2</span>,  <span class="fl">1.</span> , <span class="fl">11.2</span>,  <span class="fl">9.8</span>, <span class="fl">60.</span> , <span class="fl">50.2</span>, <span class="fl">51.2</span>,  <span class="fl">0.6</span>,  <span class="fl">1.</span> ,  <span class="fl">8.5</span>,</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>                      <span class="fl">6.1</span>,  <span class="fl">9.8</span>,  <span class="fl">1.</span> , <span class="fl">42.2</span>, <span class="fl">77.2</span>, <span class="fl">18.7</span>, <span class="fl">22.8</span>,  <span class="fl">8.5</span>, <span class="fl">43.9</span>,  <span class="fl">1.</span> ,  <span class="fl">1.</span> ,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                      <span class="fl">1.5</span>, <span class="fl">10.8</span>, <span class="fl">11.9</span>,  <span class="fl">3.4</span>,  <span class="fl">0.4</span>,  <span class="fl">3.1</span>,  <span class="fl">6.6</span>, <span class="fl">33.7</span>, <span class="fl">40.4</span>,  <span class="fl">2.3</span>, <span class="fl">17.2</span>,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>                      <span class="fl">0.7</span>, <span class="fl">36.1</span>,  <span class="fl">1.</span> , <span class="fl">33.2</span>, <span class="fl">55.9</span>, <span class="fl">30.8</span>, <span class="fl">87.4</span>, <span class="fl">15.4</span>, <span class="fl">54.6</span>,  <span class="fl">5.1</span>,  <span class="fl">1.1</span>,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>                      <span class="fl">10.2</span>, <span class="fl">19.8</span>,  <span class="fl">0.</span> , <span class="fl">40.7</span>, <span class="fl">57.2</span>, <span class="fl">59.9</span>,  <span class="fl">3.1</span>, <span class="fl">55.7</span>, <span class="fl">22.8</span>, <span class="fl">10.9</span>, <span class="fl">34.7</span>,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>                      <span class="fl">32.2</span>, <span class="fl">43.</span> ,  <span class="fl">1.3</span>,  <span class="fl">1.</span> ,  <span class="fl">0.5</span>, <span class="fl">78.4</span>, <span class="fl">34.2</span>, <span class="fl">84.9</span>, <span class="fl">29.1</span>, <span class="fl">31.3</span>, <span class="fl">18.3</span>,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>                      <span class="fl">81.8</span>, <span class="fl">39.</span> , <span class="fl">11.2</span>, <span class="fl">67.</span> ,  <span class="fl">4.1</span>,  <span class="fl">0.2</span>, <span class="fl">78.1</span>,  <span class="fl">1.</span> ,  <span class="fl">7.1</span>,  <span class="fl">1.</span> , <span class="fl">29.</span> ,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>                      <span class="fl">1.1</span>, <span class="fl">11.7</span>, <span class="fl">73.6</span>, <span class="fl">33.9</span>, <span class="fl">14.</span> ,  <span class="fl">0.3</span>,  <span class="fl">1.</span> ,  <span class="fl">0.8</span>, <span class="fl">71.9</span>, <span class="fl">40.1</span>,  <span class="fl">1.</span> ,</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>                      <span class="fl">2.1</span>,  <span class="fl">3.8</span>, <span class="fl">16.5</span>,  <span class="fl">4.1</span>,  <span class="fl">0.5</span>, <span class="fl">44.4</span>, <span class="fl">46.3</span>, <span class="fl">18.7</span>,  <span class="fl">6.5</span>, <span class="fl">36.8</span>, <span class="fl">18.6</span>,</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>                      <span class="fl">11.1</span>, <span class="fl">22.1</span>, <span class="fl">71.1</span>,  <span class="fl">1.</span> ,  <span class="fl">0.</span> ,  <span class="fl">0.9</span>,  <span class="fl">0.7</span>, <span class="fl">45.5</span>,  <span class="fl">8.4</span>,  <span class="fl">0.</span> ,  <span class="fl">3.8</span>,</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>                      <span class="fl">8.5</span>,  <span class="fl">2.</span> ,  <span class="fl">1.</span> , <span class="fl">58.9</span>,  <span class="fl">0.3</span>,  <span class="fl">1.</span> , <span class="fl">14.</span> , <span class="fl">47.</span> ,  <span class="fl">4.1</span>,  <span class="fl">2.2</span>,  <span class="fl">7.2</span>,</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>                      <span class="fl">0.3</span>,  <span class="fl">1.5</span>, <span class="fl">50.5</span>,  <span class="fl">1.3</span>,  <span class="fl">0.6</span>, <span class="fl">19.1</span>,  <span class="fl">6.9</span>,  <span class="fl">9.2</span>,  <span class="fl">2.2</span>,  <span class="fl">0.2</span>, <span class="fl">12.3</span>,</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>                      <span class="fl">4.9</span>,  <span class="fl">4.6</span>,  <span class="fl">0.3</span>, <span class="fl">16.5</span>, <span class="fl">65.7</span>, <span class="fl">63.5</span>, <span class="fl">16.8</span>,  <span class="fl">0.2</span>,  <span class="fl">1.8</span>,  <span class="fl">9.6</span>, <span class="fl">15.2</span>,</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>                      <span class="fl">14.4</span>,  <span class="fl">3.3</span>, <span class="fl">10.6</span>, <span class="fl">61.3</span>, <span class="fl">10.9</span>, <span class="fl">32.2</span>,  <span class="fl">9.3</span>, <span class="fl">11.6</span>, <span class="fl">20.7</span>,  <span class="fl">6.5</span>,  <span class="fl">6.7</span>,</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>                      <span class="fl">3.5</span>,  <span class="fl">1.</span> ,  <span class="fl">1.6</span>, <span class="fl">20.5</span>,  <span class="fl">1.5</span>, <span class="fl">16.7</span>,  <span class="fl">2.</span> ,  <span class="fl">0.9</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>fertility <span class="op">=</span> np.array([<span class="fl">1.769</span>, <span class="fl">2.682</span>, <span class="fl">2.077</span>, <span class="fl">2.132</span>, <span class="fl">1.827</span>, <span class="fl">3.872</span>, <span class="fl">2.288</span>, <span class="fl">5.173</span>, <span class="fl">1.393</span>,</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>       <span class="fl">1.262</span>, <span class="fl">2.156</span>, <span class="fl">3.026</span>, <span class="fl">2.033</span>, <span class="fl">1.324</span>, <span class="fl">2.816</span>, <span class="fl">5.211</span>, <span class="fl">2.1</span>  , <span class="fl">1.781</span>,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>       <span class="fl">1.822</span>, <span class="fl">5.908</span>, <span class="fl">1.881</span>, <span class="fl">1.852</span>, <span class="fl">1.39</span> , <span class="fl">2.281</span>, <span class="fl">2.505</span>, <span class="fl">1.224</span>, <span class="fl">1.361</span>,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>       <span class="fl">1.468</span>, <span class="fl">2.404</span>, <span class="fl">5.52</span> , <span class="fl">4.058</span>, <span class="fl">2.223</span>, <span class="fl">4.859</span>, <span class="fl">1.267</span>, <span class="fl">2.342</span>, <span class="fl">1.579</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>       <span class="fl">6.254</span>, <span class="fl">2.334</span>, <span class="fl">3.961</span>, <span class="fl">6.505</span>, <span class="fl">2.53</span> , <span class="fl">2.823</span>, <span class="fl">2.498</span>, <span class="fl">2.248</span>, <span class="fl">2.508</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>       <span class="fl">3.04</span> , <span class="fl">1.854</span>, <span class="fl">4.22</span> , <span class="fl">5.1</span>  , <span class="fl">4.967</span>, <span class="fl">1.325</span>, <span class="fl">4.514</span>, <span class="fl">3.173</span>, <span class="fl">2.308</span>,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>       <span class="fl">4.62</span> , <span class="fl">4.541</span>, <span class="fl">5.637</span>, <span class="fl">1.926</span>, <span class="fl">1.747</span>, <span class="fl">2.294</span>, <span class="fl">5.841</span>, <span class="fl">5.455</span>, <span class="fl">7.069</span>,</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>       <span class="fl">2.859</span>, <span class="fl">4.018</span>, <span class="fl">2.513</span>, <span class="fl">5.405</span>, <span class="fl">5.737</span>, <span class="fl">3.363</span>, <span class="fl">4.89</span> , <span class="fl">1.385</span>, <span class="fl">1.505</span>,</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>       <span class="fl">6.081</span>, <span class="fl">1.784</span>, <span class="fl">1.378</span>, <span class="fl">1.45</span> , <span class="fl">1.841</span>, <span class="fl">1.37</span> , <span class="fl">2.612</span>, <span class="fl">5.329</span>, <span class="fl">5.33</span> ,</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>       <span class="fl">3.371</span>, <span class="fl">1.281</span>, <span class="fl">1.871</span>, <span class="fl">2.153</span>, <span class="fl">5.378</span>, <span class="fl">4.45</span> , <span class="fl">1.46</span> , <span class="fl">1.436</span>, <span class="fl">1.612</span>,</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>       <span class="fl">3.19</span> , <span class="fl">2.752</span>, <span class="fl">3.35</span> , <span class="fl">4.01</span> , <span class="fl">4.166</span>, <span class="fl">2.642</span>, <span class="fl">2.977</span>, <span class="fl">3.415</span>, <span class="fl">2.295</span>,</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>       <span class="fl">3.019</span>, <span class="fl">2.683</span>, <span class="fl">5.165</span>, <span class="fl">1.849</span>, <span class="fl">1.836</span>, <span class="fl">2.518</span>, <span class="fl">2.43</span> , <span class="fl">4.528</span>, <span class="fl">1.263</span>,</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>       <span class="fl">1.885</span>, <span class="fl">1.943</span>, <span class="fl">1.899</span>, <span class="fl">1.442</span>, <span class="fl">1.953</span>, <span class="fl">4.697</span>, <span class="fl">1.582</span>, <span class="fl">2.025</span>, <span class="fl">1.841</span>,</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>       <span class="fl">5.011</span>, <span class="fl">1.212</span>, <span class="fl">1.502</span>, <span class="fl">2.516</span>, <span class="fl">1.367</span>, <span class="fl">2.089</span>, <span class="fl">4.388</span>, <span class="fl">1.854</span>, <span class="fl">1.748</span>,</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>       <span class="fl">2.978</span>, <span class="fl">2.152</span>, <span class="fl">2.362</span>, <span class="fl">1.988</span>, <span class="fl">1.426</span>, <span class="fl">3.29</span> , <span class="fl">3.264</span>, <span class="fl">1.436</span>, <span class="fl">1.393</span>,</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>       <span class="fl">2.822</span>, <span class="fl">4.969</span>, <span class="fl">5.659</span>, <span class="fl">3.24</span> , <span class="fl">1.693</span>, <span class="fl">1.647</span>, <span class="fl">2.36</span> , <span class="fl">1.792</span>, <span class="fl">3.45</span> ,</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>       <span class="fl">1.516</span>, <span class="fl">2.233</span>, <span class="fl">2.563</span>, <span class="fl">5.283</span>, <span class="fl">3.885</span>, <span class="fl">0.966</span>, <span class="fl">2.373</span>, <span class="fl">2.663</span>, <span class="fl">1.251</span>,</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>       <span class="fl">2.052</span>, <span class="fl">3.371</span>, <span class="fl">2.093</span>, <span class="fl">2.</span>   , <span class="fl">3.883</span>, <span class="fl">3.852</span>, <span class="fl">3.718</span>, <span class="fl">1.732</span>, <span class="fl">3.928</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>It is always a good idea to do some EDA ahead of our analysis. To this end, we will plot the <code>fertility</code> versus <code>illiteracy</code> and compute the Pearson correlation coefficient.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The Numpy array <code>illiteracy</code> has the illiteracy rate among females for most of the world’s nations.</p>
</div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The array <code>fertility</code> has the corresponding fertility data.</p>
</div>
</div>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> pearson_r(x, y):</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.corrcoef(x, y)[<span class="dv">0</span>,<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the illiteracy rate versus fertility</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.plot(illiteracy, fertility, marker<span class="op">=</span><span class="st">'.'</span>, linestyle<span class="op">=</span><span class="st">'none'</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the margins and label axes</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>plt.margins(<span class="fl">.02</span>)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.xlabel(<span class="st">'percent illiterate'</span>)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.ylabel(<span class="st">'fertility'</span>)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the plot</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the Pearson correlation coefficient</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>pearson_r(illiteracy, fertility)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2020-07-08-Statistical Thinking in Python (Part 2)_files/figure-html/cell-11-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>0.8041324026815346</code></pre>
</div>
</div>
<p>We can see the correlation between illiteracy and fertility by eye, and by the substantial Pearson correlation coefficient of 0.8. It is difficult to resolve in the scatter plot, but there are many points around near-zero illiteracy and about 1.8 children/woman.</p>
</section>
<section id="linear-regression" class="level3">
<h3 class="anchored" data-anchor-id="linear-regression">Linear regression</h3>
<p>We will assume that fertility is a linear function of the female illiteracy rate. That is, <span class="math inline">\(f=ai+b\)</span>, where <span class="math inline">\(a\)</span> is the <strong>slope</strong> and <span class="math inline">\(b\)</span> is the <strong>intercept</strong>.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>We can think of the intercept as the minimal fertility rate, probably somewhere between one and two.</p>
</div>
</div>
<p>The slope tells us how the fertility rate varies with illiteracy. We can find the best fit line using <code>np.polyfit()</code>.</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the illiteracy rate versus fertility</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.plot(illiteracy, fertility, marker<span class="op">=</span><span class="st">'.'</span>, linestyle<span class="op">=</span><span class="st">'none'</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>plt.margins(<span class="fl">0.02</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.xlabel(<span class="st">'percent illiterate'</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.ylabel(<span class="st">'fertility'</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform a linear regression using np.polyfit(): a, b</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>a, b <span class="op">=</span> np.polyfit(illiteracy, fertility, deg<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the results to the screen</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'slope ='</span>, a, <span class="st">'children per woman / percent illiterate'</span>)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'intercept ='</span>, b, <span class="st">'children per woman'</span>)</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Make theoretical line to plot</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.array([<span class="dv">0</span>, <span class="dv">100</span>])</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> a <span class="op">*</span> x <span class="op">+</span> b</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Add regression line to your plot</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.plot(x, y)</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Draw the plot</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>slope = 0.04979854809063423 children per woman / percent illiterate
intercept = 1.8880506106365562 children per woman</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2020-07-08-Statistical Thinking in Python (Part 2)_files/figure-html/cell-12-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="how-is-it-optimal" class="level3">
<h3 class="anchored" data-anchor-id="how-is-it-optimal">How is it optimal?</h3>
<p>The function <code>np.polyfit()</code> that we used to get your regression parameters finds the optimal slope and intercept. It is optimizing the sum of the squares of the residuals, also known as RSS ( <em>for residual sum of squares</em> ).</p>
<p>We will plot the function that is being optimized, the RSS, versus the slope parameter <span class="math inline">\(a\)</span>. To do this, we will fix the intercept to be what we found in the optimization. Then, plot the RSS vs.&nbsp;the slope.</p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify slopes to consider: a_vals</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>a_vals <span class="op">=</span> np.linspace(<span class="dv">0</span>,<span class="fl">0.1</span>, <span class="dv">200</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize sum of square of residuals: rss</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>rss <span class="op">=</span> np.empty_like(a_vals)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute sum of square of residuals for each value of a_vals</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, a <span class="kw">in</span> <span class="bu">enumerate</span>(a_vals):</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    rss[i] <span class="op">=</span> np.<span class="bu">sum</span>((fertility <span class="op">-</span> a<span class="op">*</span>illiteracy <span class="op">-</span> b)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the RSS</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>plt.plot(a_vals, rss, <span class="st">'-'</span>)</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'slope (children per woman / percent illiterate)'</span>)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'sum of square of residuals'</span>)</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2020-07-08-Statistical Thinking in Python (Part 2)_files/figure-html/cell-13-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>that the minimum on the plot, that is the value of the slope that gives the minimum sum of the square of the residuals, is the same value you got when performing the regression.</p>
</div>
</div>
</section>
</section>
<section id="the-importance-of-eda-anscombes-quartet" class="level2">
<h2 class="anchored" data-anchor-id="the-importance-of-eda-anscombes-quartet">The importance of EDA: Anscombe’s quartet</h2>
<blockquote class="blockquote">
<h3 id="look-before-you-leap" class="anchored">Look before you leap!</h3>
<ul>
<li>Do graphical EDA rst</li>
</ul>
</blockquote>
<section id="linear-regression-on-appropriate-anscombe-data" class="level3">
<h3 class="anchored" data-anchor-id="linear-regression-on-appropriate-anscombe-data">Linear regression on appropriate Anscombe data</h3>
<p>We will perform a linear regression on the data set from Anscombe’s quartet that is most reasonably interpreted with linear regression.</p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.array([<span class="fl">10.</span>,  <span class="fl">8.</span>, <span class="fl">13.</span>,  <span class="fl">9.</span>, <span class="fl">11.</span>, <span class="fl">14.</span>,  <span class="fl">6.</span>,  <span class="fl">4.</span>, <span class="fl">12.</span>,  <span class="fl">7.</span>,  <span class="fl">5.</span>])</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.array([ <span class="fl">8.04</span>,  <span class="fl">6.95</span>,  <span class="fl">7.58</span>,  <span class="fl">8.81</span>,  <span class="fl">8.33</span>,  <span class="fl">9.96</span>,  <span class="fl">7.24</span>,  <span class="fl">4.26</span>, <span class="fl">10.84</span>,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>        <span class="fl">4.82</span>,  <span class="fl">5.68</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform linear regression: a, b</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>a, b <span class="op">=</span> np.polyfit(x,y, deg<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the slope and intercept</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(a, b)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate theoretical x and y data: x_theor, y_theor</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>x_theor <span class="op">=</span> np.array([<span class="dv">3</span>, <span class="dv">15</span>])</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>y_theor <span class="op">=</span> a <span class="op">*</span> x_theor <span class="op">+</span> b</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the Anscombe data and theoretical line</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.plot(x, y, marker<span class="op">=</span><span class="st">"."</span>, linestyle<span class="op">=</span><span class="st">"none"</span>)</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.plot(x_theor, y_theor)</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Label the axes</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'x'</span>)</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'y'</span>)</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the plot</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.5000909090909091 3.000090909090908</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2020-07-08-Statistical Thinking in Python (Part 2)_files/figure-html/cell-15-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="linear-regression-on-all-anscombe-data" class="level3">
<h3 class="anchored" data-anchor-id="linear-regression-on-all-anscombe-data">Linear regression on all Anscombe data</h3>
<p>Now, to verify that all four of the Anscombe data sets have the same slope and intercept from a linear regression, we will compute the slope and intercept for each set.</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>anscombe_x <span class="op">=</span> [np.array([<span class="fl">10.</span>,  <span class="fl">8.</span>, <span class="fl">13.</span>,  <span class="fl">9.</span>, <span class="fl">11.</span>, <span class="fl">14.</span>,  <span class="fl">6.</span>,  <span class="fl">4.</span>, <span class="fl">12.</span>,  <span class="fl">7.</span>,  <span class="fl">5.</span>]),</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a> np.array([<span class="fl">10.</span>,  <span class="fl">8.</span>, <span class="fl">13.</span>,  <span class="fl">9.</span>, <span class="fl">11.</span>, <span class="fl">14.</span>,  <span class="fl">6.</span>,  <span class="fl">4.</span>, <span class="fl">12.</span>,  <span class="fl">7.</span>,  <span class="fl">5.</span>]),</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a> np.array([<span class="fl">10.</span>,  <span class="fl">8.</span>, <span class="fl">13.</span>,  <span class="fl">9.</span>, <span class="fl">11.</span>, <span class="fl">14.</span>,  <span class="fl">6.</span>,  <span class="fl">4.</span>, <span class="fl">12.</span>,  <span class="fl">7.</span>,  <span class="fl">5.</span>]),</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a> np.array([ <span class="fl">8.</span>,  <span class="fl">8.</span>,  <span class="fl">8.</span>,  <span class="fl">8.</span>,  <span class="fl">8.</span>,  <span class="fl">8.</span>,  <span class="fl">8.</span>, <span class="fl">19.</span>,  <span class="fl">8.</span>,  <span class="fl">8.</span>,  <span class="fl">8.</span>])]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>anscombe_y <span class="op">=</span> [np.array([ <span class="fl">8.04</span>,  <span class="fl">6.95</span>,  <span class="fl">7.58</span>,  <span class="fl">8.81</span>,  <span class="fl">8.33</span>,  <span class="fl">9.96</span>,  <span class="fl">7.24</span>,  <span class="fl">4.26</span>, <span class="fl">10.84</span>,</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>         <span class="fl">4.82</span>,  <span class="fl">5.68</span>]),</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a> np.array([<span class="fl">9.14</span>, <span class="fl">8.14</span>, <span class="fl">8.74</span>, <span class="fl">8.77</span>, <span class="fl">9.26</span>, <span class="fl">8.1</span> , <span class="fl">6.13</span>, <span class="fl">3.1</span> , <span class="fl">9.13</span>, <span class="fl">7.26</span>, <span class="fl">4.74</span>]),</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a> np.array([ <span class="fl">7.46</span>,  <span class="fl">6.77</span>, <span class="fl">12.74</span>,  <span class="fl">7.11</span>,  <span class="fl">7.81</span>,  <span class="fl">8.84</span>,  <span class="fl">6.08</span>,  <span class="fl">5.39</span>,  <span class="fl">8.15</span>,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>         <span class="fl">6.42</span>,  <span class="fl">5.73</span>]),</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a> np.array([ <span class="fl">6.58</span>,  <span class="fl">5.76</span>,  <span class="fl">7.71</span>,  <span class="fl">8.84</span>,  <span class="fl">8.47</span>,  <span class="fl">7.04</span>,  <span class="fl">5.25</span>, <span class="fl">12.5</span> ,  <span class="fl">5.56</span>,</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>         <span class="fl">7.91</span>,  <span class="fl">6.89</span>])]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The data are stored in lists;</p>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Iterate through x,y pairs</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x, y <span class="kw">in</span> <span class="bu">zip</span>(anscombe_x, anscombe_y):</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Compute the slope and intercept: a, b</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    a, b <span class="op">=</span> np.polyfit(x,y, deg<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Print the result</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'slope:'</span>, a, <span class="st">'intercept:'</span>, b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>slope: 0.5000909090909091 intercept: 3.000090909090908
slope: 0.5 intercept: 3.0009090909090905
slope: 0.4997272727272729 intercept: 3.002454545454545
slope: 0.4999090909090908 intercept: 3.001727272727274</code></pre>
</div>
</div>
<div class="callout-important callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>Indeed, they all have the same slope and intercept.</p>
</div>
</div>
</section>
</section>
</section>
<section id="bootstrap-confidence-intervals" class="level1">
<h1>Bootstrap confidence intervals</h1>
<p>To “pull yourself up by your bootstraps” is a classic idiom meaning that you achieve a difficult task by yourself with no help at all. In statistical inference, we want to know what would happen if we could repeat our data acquisition an infinite number of times. This task is impossible, but can we use only the data we actually have to get close to the same result as an infinitude of experiments? The answer is yes! The technique to do it is aptly called <strong><em>bootstrapping</em></strong>.</p>
<section id="generating-bootstrap-replicates" class="level2">
<h2 class="anchored" data-anchor-id="generating-bootstrap-replicates">Generating bootstrap replicates</h2>
<blockquote class="blockquote">
<h3 id="bootstrapping" class="anchored">Bootstrapping</h3>
<ul>
<li>The use of resampled data to perform statistical inference</li>
</ul>
</blockquote>
<blockquote class="blockquote">
<h3 id="bootstrap-sample" class="anchored">Bootstrap sample</h3>
<ul>
<li>A resampled array ofthe data</li>
</ul>
</blockquote>
<blockquote class="blockquote">
<h3 id="bootstrap-replicate" class="anchored">Bootstrap replicate</h3>
<ul>
<li>A statistic computed from a resampled array</li>
</ul>
</blockquote>
<section id="getting-the-terminology-down" class="level3">
<h3 class="anchored" data-anchor-id="getting-the-terminology-down">Getting the terminology down</h3>
<p>If we have a data set with <span class="math inline">\(n\)</span> repeated measurements, a <strong>bootstrap sample</strong> is an array of length <span class="math inline">\(n\)</span> that was drawn from the original data with replacement. <strong>bootstrap replicate</strong> is A single value of a statistic computed from a bootstrap sample.</p>
</section>
<section id="visualizing-bootstrap-samples" class="level3">
<h3 class="anchored" data-anchor-id="visualizing-bootstrap-samples">Visualizing bootstrap samples</h3>
<p>We will generate bootstrap samples from the set of annual rainfall data measured at the Sheffield Weather Station in the UK from 1883 to 2015.</p>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>rainfall <span class="op">=</span> np.array([ <span class="fl">875.5</span>,  <span class="fl">648.2</span>,  <span class="fl">788.1</span>,  <span class="fl">940.3</span>,  <span class="fl">491.1</span>,  <span class="fl">743.5</span>,  <span class="fl">730.1</span>,  <span class="fl">686.5</span>,</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>        <span class="fl">878.8</span>,  <span class="fl">865.6</span>,  <span class="fl">654.9</span>,  <span class="fl">831.5</span>,  <span class="fl">798.1</span>,  <span class="fl">681.8</span>,  <span class="fl">743.8</span>,  <span class="fl">689.1</span>,</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>        <span class="fl">752.1</span>,  <span class="fl">837.2</span>,  <span class="fl">710.6</span>,  <span class="fl">749.2</span>,  <span class="fl">967.1</span>,  <span class="fl">701.2</span>,  <span class="fl">619.</span> ,  <span class="fl">747.6</span>,</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>        <span class="fl">803.4</span>,  <span class="fl">645.6</span>,  <span class="fl">804.1</span>,  <span class="fl">787.4</span>,  <span class="fl">646.8</span>,  <span class="fl">997.1</span>,  <span class="fl">774.</span> ,  <span class="fl">734.5</span>,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>        <span class="fl">835.</span> ,  <span class="fl">840.7</span>,  <span class="fl">659.6</span>,  <span class="fl">828.3</span>,  <span class="fl">909.7</span>,  <span class="fl">856.9</span>,  <span class="fl">578.3</span>,  <span class="fl">904.2</span>,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>        <span class="fl">883.9</span>,  <span class="fl">740.1</span>,  <span class="fl">773.9</span>,  <span class="fl">741.4</span>,  <span class="fl">866.8</span>,  <span class="fl">871.1</span>,  <span class="fl">712.5</span>,  <span class="fl">919.2</span>,</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>        <span class="fl">927.9</span>,  <span class="fl">809.4</span>,  <span class="fl">633.8</span>,  <span class="fl">626.8</span>,  <span class="fl">871.3</span>,  <span class="fl">774.3</span>,  <span class="fl">898.8</span>,  <span class="fl">789.6</span>,</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>        <span class="fl">936.3</span>,  <span class="fl">765.4</span>,  <span class="fl">882.1</span>,  <span class="fl">681.1</span>,  <span class="fl">661.3</span>,  <span class="fl">847.9</span>,  <span class="fl">683.9</span>,  <span class="fl">985.7</span>,</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>        <span class="fl">771.1</span>,  <span class="fl">736.6</span>,  <span class="fl">713.2</span>,  <span class="fl">774.5</span>,  <span class="fl">937.7</span>,  <span class="fl">694.5</span>,  <span class="fl">598.2</span>,  <span class="fl">983.8</span>,</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>        <span class="fl">700.2</span>,  <span class="fl">901.3</span>,  <span class="fl">733.5</span>,  <span class="fl">964.4</span>,  <span class="fl">609.3</span>, <span class="fl">1035.2</span>,  <span class="fl">718.</span> ,  <span class="fl">688.6</span>,</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>        <span class="fl">736.8</span>,  <span class="fl">643.3</span>, <span class="fl">1038.5</span>,  <span class="fl">969.</span> ,  <span class="fl">802.7</span>,  <span class="fl">876.6</span>,  <span class="fl">944.7</span>,  <span class="fl">786.6</span>,</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>        <span class="fl">770.4</span>,  <span class="fl">808.6</span>,  <span class="fl">761.3</span>,  <span class="fl">774.2</span>,  <span class="fl">559.3</span>,  <span class="fl">674.2</span>,  <span class="fl">883.6</span>,  <span class="fl">823.9</span>,</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>        <span class="fl">960.4</span>,  <span class="fl">877.8</span>,  <span class="fl">940.6</span>,  <span class="fl">831.8</span>,  <span class="fl">906.2</span>,  <span class="fl">866.5</span>,  <span class="fl">674.1</span>,  <span class="fl">998.1</span>,</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>        <span class="fl">789.3</span>,  <span class="fl">915.</span> ,  <span class="fl">737.1</span>,  <span class="fl">763.</span> ,  <span class="fl">666.7</span>,  <span class="fl">824.5</span>,  <span class="fl">913.8</span>,  <span class="fl">905.1</span>,</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>        <span class="fl">667.8</span>,  <span class="fl">747.4</span>,  <span class="fl">784.7</span>,  <span class="fl">925.4</span>,  <span class="fl">880.2</span>, <span class="fl">1086.9</span>,  <span class="fl">764.4</span>, <span class="fl">1050.1</span>,</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>        <span class="fl">595.2</span>,  <span class="fl">855.2</span>,  <span class="fl">726.9</span>,  <span class="fl">785.2</span>,  <span class="fl">948.8</span>,  <span class="fl">970.6</span>,  <span class="fl">896.</span> ,  <span class="fl">618.4</span>,</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>        <span class="fl">572.4</span>, <span class="fl">1146.4</span>,  <span class="fl">728.2</span>,  <span class="fl">864.2</span>,  <span class="fl">793.</span> ])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The data are stored in the NumPy array rainfall in units of millimeters (mm). By graphically displaying the bootstrap samples with an ECDF, we can get a feel for how bootstrap sampling allows probabilistic descriptions of data.</p>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">50</span>):</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Generate bootstrap sample: bs_sample</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    bs_sample <span class="op">=</span> np.random.choice(rainfall, size<span class="op">=</span><span class="bu">len</span>(rainfall))</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Compute and plot ECDF from bootstrap sample</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    x, y <span class="op">=</span> ecdf(bs_sample)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    _ <span class="op">=</span> plt.plot(x, y, marker<span class="op">=</span><span class="st">'.'</span>, linestyle<span class="op">=</span><span class="st">'none'</span>,</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>                 color<span class="op">=</span><span class="st">'gray'</span>, alpha<span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute and plot ECDF from original data</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>x, y <span class="op">=</span> ecdf(rainfall)</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.plot(x, y, marker<span class="op">=</span><span class="st">'.'</span>)</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Make margins and label axes</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>plt.margins(<span class="fl">0.02</span>)</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.xlabel(<span class="st">'yearly rainfall (mm)'</span>)</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.ylabel(<span class="st">'ECDF'</span>)</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the plot</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2020-07-08-Statistical Thinking in Python (Part 2)_files/figure-html/cell-20-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The bootstrap samples give an idea of how the distribution of rainfalls is spread.</p>
</div>
</div>
</section>
</section>
<section id="bootstrap-confidence-intervals-1" class="level2">
<h2 class="anchored" data-anchor-id="bootstrap-confidence-intervals-1">Bootstrap confidence intervals</h2>
<blockquote class="blockquote">
<h3 id="condence-interval-of-a-statistic" class="anchored">Condence interval of a statistic</h3>
<ul>
<li>If we repeated measurements over and over again, <span class="math inline">\(p\%\)</span> of the observed values would lie within the <span class="math inline">\(p\%\)</span> condence interval.</li>
</ul>
</blockquote>
<section id="generating-many-bootstrap-replicates" class="level3">
<h3 class="anchored" data-anchor-id="generating-many-bootstrap-replicates">Generating many bootstrap replicates</h3>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> bootstrap_replicate_1d(data, func):</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Generate bootstrap replicate of 1D data."""</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> func(np.random.choice(data, size<span class="op">=</span><span class="bu">len</span>(data)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We’ll write another function, <code>draw_bs_reps(data, func, size=1)</code>, which generates many bootstrap replicates from the data set.</p>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> draw_bs_reps(data, func, size<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Draw bootstrap replicates."""</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize array of replicates: bs_replicates</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    bs_replicates <span class="op">=</span> np.empty(size)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Generate replicates</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(size):</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>        bs_replicates[i] <span class="op">=</span> bootstrap_replicate_1d(data, func)</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> bs_replicates</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="bootstrap-replicates-of-the-mean-and-the-sem" class="level3">
<h3 class="anchored" data-anchor-id="bootstrap-replicates-of-the-mean-and-the-sem">Bootstrap replicates of the mean and the SEM</h3>
<p>We will compute a bootstrap estimate of the probability density function of the mean annual rainfall at the Sheffield Weather Station.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>we are estimating the mean annual rainfall we would get if the Sheffield Weather Station could repeat all of the measurements from 1883 to 2015 over and over again. This is a <em>probabilistic</em> estimate of the mean.</p>
</div>
</div>
<p>We will plot the PDF as a histogram, and you will see that it is Normal.</p>
<p>The standard deviation of this distribution, called the <strong>standard error of the mean</strong>, or SEM, is given by the standard deviation of the data divided by the square root of the number of data points. I.e., for a data set, <code>sem = np.std(data) / np.sqrt(len(data))</code>.</p>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Take 10,000 bootstrap replicates of the mean: bs_replicates</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>bs_replicates <span class="op">=</span> draw_bs_reps(rainfall, np.mean, size<span class="op">=</span><span class="dv">10000</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute and print SEM</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>sem <span class="op">=</span> np.std(rainfall) <span class="op">/</span> np.sqrt(<span class="bu">len</span>(rainfall))</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sem)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute and print standard deviation of bootstrap replicates</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>bs_std <span class="op">=</span> np.std(bs_replicates)</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(bs_std)</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a histogram of the results</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.hist(bs_replicates, bins<span class="op">=</span><span class="dv">50</span>, density<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.xlabel(<span class="st">'mean annual rainfall (mm)'</span>)</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.ylabel(<span class="st">'PDF'</span>)</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the plot</span></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>10.510549150506188
10.358764199574097</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2020-07-08-Statistical Thinking in Python (Part 2)_files/figure-html/cell-23-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>SEM we got from the known expression and the bootstrap replicates is the same and the distribution of the bootstrap replicates of the mean is Normal.</p>
</div>
</div>
</section>
<section id="confidence-intervals-of-rainfall-data" class="level3">
<h3 class="anchored" data-anchor-id="confidence-intervals-of-rainfall-data">Confidence intervals of rainfall data</h3>
<p>A <em>confidence interval</em> gives upper and lower bounds on the range of parameter values you might expect to get if we repeat our measurements. For named distributions, we can compute them analytically or look them up, but one of the many beautiful properties of the bootstrap method is that we can take percentiles of your bootstrap replicates to get your confidence interval. Conveniently, we can use the <code>np.percentile()</code> function.</p>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>np.percentile(bs_replicates, [<span class="fl">2.5</span>, <span class="fl">97.5</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>array([779.96900376, 820.62793233])</code></pre>
</div>
</div>
<p>it’s simple to get confidence intervals using bootstrap!</p>
</section>
<section id="bootstrap-replicates-of-other-statistics" class="level3">
<h3 class="anchored" data-anchor-id="bootstrap-replicates-of-other-statistics">Bootstrap replicates of other statistics</h3>
<p>We’ll generate bootstrap replicates for the variance of the annual rainfall at the Sheffield Weather Station and plot the histogram of the replicates.</p>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate 10,000 bootstrap replicates of the variance: bs_replicates</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>bs_replicates <span class="op">=</span> draw_bs_reps(rainfall, np.var, size<span class="op">=</span><span class="dv">10000</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Put the variance in units of square centimeters</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>bs_replicates <span class="op">=</span> bs_replicates<span class="op">/</span><span class="dv">100</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a histogram of the results</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.hist(bs_replicates, density<span class="op">=</span><span class="va">True</span>, bins<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.xlabel(<span class="st">'variance of annual rainfall (sq. cm)'</span>)</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.ylabel(<span class="st">'PDF'</span>)</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the plot</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2020-07-08-Statistical Thinking in Python (Part 2)_files/figure-html/cell-25-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>This is not normally distributed, as it has a longer tail to the right.</p>
</div>
</div>
</section>
<section id="confidence-interval-on-the-rate-of-no-hitters" class="level3">
<h3 class="anchored" data-anchor-id="confidence-interval-on-the-rate-of-no-hitters">Confidence interval on the rate of no-hitters</h3>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Draw bootstrap replicates of the mean no-hitter time (equal to tau): bs_replicates</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>bs_replicates <span class="op">=</span> draw_bs_reps(nohitter_times, np.mean, size<span class="op">=</span><span class="dv">10000</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the 95% confidence interval: conf_int</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>conf_int <span class="op">=</span> np.percentile(bs_replicates, [<span class="fl">2.5</span>, <span class="fl">97.5</span>])</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the confidence interval</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'95</span><span class="sc">% c</span><span class="st">onfidence interval ='</span>, conf_int, <span class="st">'games'</span>)</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the histogram of the replicates</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.hist(bs_replicates, bins<span class="op">=</span><span class="dv">50</span>, density<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.xlabel(<span class="vs">r'$\tau$ (games)'</span>)</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.ylabel(<span class="st">'PDF'</span>)</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the plot</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>95% confidence interval = [663.65229084 869.79741036] games</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2020-07-08-Statistical Thinking in Python (Part 2)_files/figure-html/cell-26-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>This gives us an estimate of what the typical time between no-hitters is. It could be anywhere between 660 and 870 games.</p>
</div>
</div>
</section>
</section>
<section id="pairs-bootstrap" class="level2">
<h2 class="anchored" data-anchor-id="pairs-bootstrap">Pairs bootstrap</h2>
<blockquote class="blockquote">
<h3 id="nonparametric-inference" class="anchored">Nonparametric inference</h3>
<ul>
<li>Make no assumptions about the model or probability distribution underlying the data</li>
</ul>
</blockquote>
<blockquote class="blockquote">
<h3 id="pairs-bootstrap-for-linear-regression" class="anchored">Pairs bootstrap for linear regression</h3>
<ul>
<li>Resample data in pairs</li>
<li>Compute slope and intercept from resampled data</li>
<li>Each slope and intercept is a bootstrap replicate</li>
<li>Compute condence intervals from percentiles of bootstrap replicates</li>
</ul>
</blockquote>
<section id="a-function-to-do-pairs-bootstrap" class="level3">
<h3 class="anchored" data-anchor-id="a-function-to-do-pairs-bootstrap">A function to do pairs bootstrap</h3>
<p>pairs bootstrap involves resampling pairs of data. Each collection of pairs fit with a line, in this case using <code>np.polyfit()</code>. We do this again and again, getting bootstrap replicates of the parameter values. To have a useful tool for doing pairs bootstrap, we will write a function to perform pairs bootstrap on a set of <code>x,y</code> data.</p>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> draw_bs_pairs_linreg(x, y, size<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Perform pairs bootstrap for linear regression."""</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set up array of indices to sample from: inds</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    inds <span class="op">=</span> np.arange(<span class="bu">len</span>(x))</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize replicates: bs_slope_reps, bs_intercept_reps</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    bs_slope_reps <span class="op">=</span> np.empty(size)</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>    bs_intercept_reps <span class="op">=</span> np.empty(size)</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Generate replicates</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(size):</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>        bs_inds <span class="op">=</span> np.random.choice(inds, size<span class="op">=</span><span class="bu">len</span>(inds))</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>        bs_x, bs_y <span class="op">=</span> x[bs_inds], y[bs_inds]</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>        bs_slope_reps[i], bs_intercept_reps[i] <span class="op">=</span> np.polyfit(bs_x, bs_y, deg<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> bs_slope_reps, bs_intercept_reps</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="pairs-bootstrap-of-literacyfertility-data" class="level3">
<h3 class="anchored" data-anchor-id="pairs-bootstrap-of-literacyfertility-data">Pairs bootstrap of literacy/fertility data</h3>
<p>Using the function we just wrote, we’ll perform pairs bootstrap to plot a histogram describing the estimate of the slope from the illiteracy/fertility data. Also reporting the 95% confidence interval of the slope.</p>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate replicates of slope and intercept using pairs bootstrap</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>bs_slope_reps, bs_intercept_reps <span class="op">=</span> draw_bs_pairs_linreg(illiteracy, fertility, size<span class="op">=</span><span class="dv">1000</span>)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute and print 95% CI for slope</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.percentile(bs_slope_reps, [<span class="fl">2.5</span>, <span class="fl">97.5</span>]))</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the histogram</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.hist(bs_slope_reps, bins<span class="op">=</span><span class="dv">50</span>, density<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.xlabel(<span class="st">'slope'</span>)</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.ylabel(<span class="st">'PDF'</span>)</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[0.04389859 0.05528877]</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2020-07-08-Statistical Thinking in Python (Part 2)_files/figure-html/cell-28-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="plotting-bootstrap-regressions" class="level3">
<h3 class="anchored" data-anchor-id="plotting-bootstrap-regressions">Plotting bootstrap regressions</h3>
<p>A nice way to visualize the variability we might expect in a linear regression is to plot the line we would get from each bootstrap replicate of the slope and intercept. We’ll do this for the first 100 of our bootstrap replicates of the slope and intercept</p>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate array of x-values for bootstrap lines: x</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.array([<span class="dv">0</span>,<span class="dv">100</span>])</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the bootstrap lines</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">100</span>):</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    _ <span class="op">=</span> plt.plot(x, </span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>                 bs_slope_reps[i]<span class="op">*</span>x <span class="op">+</span> bs_intercept_reps[i],</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>                 linewidth<span class="op">=</span><span class="fl">0.5</span>, alpha<span class="op">=</span><span class="fl">0.2</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the data</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.plot(illiteracy, fertility, marker<span class="op">=</span><span class="st">"."</span>, linestyle<span class="op">=</span><span class="st">"none"</span>)</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Label axes, set the margins, and show the plot</span></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.xlabel(<span class="st">'illiteracy'</span>)</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.ylabel(<span class="st">'fertility'</span>)</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>plt.margins(<span class="fl">0.02</span>)</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2020-07-08-Statistical Thinking in Python (Part 2)_files/figure-html/cell-29-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
</section>
<section id="introduction-to-hypothesis-testing" class="level1">
<h1>Introduction to hypothesis testing</h1>
<p>how reasonable is it to observe our data if a model is true? This question is addressed by <strong>hypothesis tests</strong>. They are the icing on the inference cake. We carefully construct and test hypotheses using hacker statistics.</p>
<section id="formulating-and-simulating-a-hypothesis" class="level2">
<h2 class="anchored" data-anchor-id="formulating-and-simulating-a-hypothesis">Formulating and simulating a hypothesis</h2>
<blockquote class="blockquote">
<h3 id="hypothesis-testing" class="anchored">Hypothesis testing</h3>
<ul>
<li>Assessment of how reasonable the observed data are assuming a hypothesis is true</li>
</ul>
</blockquote>
<blockquote class="blockquote">
<h3 id="null-hypothesis" class="anchored">Null hypothesis</h3>
<ul>
<li>Another name for the hypothesis you are testing</li>
</ul>
</blockquote>
<blockquote class="blockquote">
<h3 id="permutation" class="anchored">Permutation</h3>
<ul>
<li>Random reordering of entries in an array</li>
</ul>
</blockquote>
<section id="generating-a-permutation-sample" class="level3">
<h3 class="anchored" data-anchor-id="generating-a-permutation-sample">Generating a permutation sample</h3>
<p>permutation sampling is a great way to simulate the hypothesis that two variables have identical probability distributions. This is often a hypothesis you want to test, so we will write a function to generate a permutation sample from two data sets.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>a permutation sample of two arrays having respectively <code>n1</code> and <code>n2</code> entries is constructed by concatenating the arrays together, scrambling the contents of the concatenated array, and then taking the first <code>n1</code> entries as the permutation sample of the first array and the last <code>n2</code> entries as the permutation sample of the second array.</p>
</div>
</div>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> permutation_sample(data1, data2):</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Generate a permutation sample from two data sets."""</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Concatenate the data sets: data</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> np.concatenate((data1,data2))</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Permute the concatenated array: permuted_data</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>    permuted_data <span class="op">=</span> np.random.permutation(data)</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Split the permuted array into two: perm_sample_1, perm_sample_2</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>    perm_sample_1 <span class="op">=</span> permuted_data[:<span class="bu">len</span>(data1)]</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>    perm_sample_2 <span class="op">=</span> permuted_data[<span class="bu">len</span>(data1):]</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> perm_sample_1, perm_sample_2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="visualizing-permutation-sampling" class="level3">
<h3 class="anchored" data-anchor-id="visualizing-permutation-sampling">Visualizing permutation sampling</h3>
<p>To help see how permutation sampling works, we will generate permutation samples and look at them graphically.</p>
<p>We will use the Sheffield Weather Station data again, this time considering the monthly rainfall in June (a dry month) and November (a wet month). We expect these might be differently distributed, so we will take permutation samples to see how their ECDFs <em>would look if</em> they were identically distributed.</p>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>rain_june <span class="op">=</span> np.array([ <span class="fl">66.2</span>,  <span class="fl">39.7</span>,  <span class="fl">76.4</span>,  <span class="fl">26.5</span>,  <span class="fl">11.2</span>,  <span class="fl">61.8</span>,   <span class="fl">6.1</span>,  <span class="fl">48.4</span>,  <span class="fl">89.2</span>,</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>       <span class="fl">104.</span> ,  <span class="fl">34.</span> ,  <span class="fl">60.6</span>,  <span class="fl">57.1</span>,  <span class="fl">79.1</span>,  <span class="fl">90.9</span>,  <span class="fl">32.3</span>,  <span class="fl">63.8</span>,  <span class="fl">78.2</span>,</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>        <span class="fl">27.5</span>,  <span class="fl">43.4</span>,  <span class="fl">30.1</span>,  <span class="fl">17.3</span>,  <span class="fl">77.5</span>,  <span class="fl">44.9</span>,  <span class="fl">92.2</span>,  <span class="fl">39.6</span>,  <span class="fl">79.4</span>,</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>        <span class="fl">66.1</span>,  <span class="fl">53.5</span>,  <span class="fl">98.5</span>,  <span class="fl">20.8</span>,  <span class="fl">55.5</span>,  <span class="fl">39.6</span>,  <span class="fl">56.</span> ,  <span class="fl">65.1</span>,  <span class="fl">14.8</span>,</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>        <span class="fl">13.2</span>,  <span class="fl">88.1</span>,   <span class="fl">8.4</span>,  <span class="fl">32.1</span>,  <span class="fl">19.6</span>,  <span class="fl">40.4</span>,   <span class="fl">2.2</span>,  <span class="fl">77.5</span>, <span class="fl">105.4</span>,</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>        <span class="fl">77.2</span>,  <span class="fl">38.</span> ,  <span class="fl">27.1</span>, <span class="fl">111.8</span>,  <span class="fl">17.2</span>,  <span class="fl">26.7</span>,  <span class="fl">23.3</span>,  <span class="fl">77.2</span>,  <span class="fl">87.2</span>,</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>        <span class="fl">27.7</span>,  <span class="fl">50.6</span>,  <span class="fl">60.3</span>,  <span class="fl">15.1</span>,   <span class="fl">6.</span> ,  <span class="fl">29.4</span>,  <span class="fl">39.3</span>,  <span class="fl">56.3</span>,  <span class="fl">80.4</span>,</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>        <span class="fl">85.3</span>,  <span class="fl">68.4</span>,  <span class="fl">72.5</span>,  <span class="fl">13.3</span>,  <span class="fl">28.4</span>,  <span class="fl">14.7</span>,  <span class="fl">37.4</span>,  <span class="fl">49.5</span>,  <span class="fl">57.2</span>,</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>        <span class="fl">85.9</span>,  <span class="fl">82.1</span>,  <span class="fl">31.8</span>, <span class="fl">126.6</span>,  <span class="fl">30.7</span>,  <span class="fl">41.4</span>,  <span class="fl">33.9</span>,  <span class="fl">13.5</span>,  <span class="fl">99.1</span>,</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>        <span class="fl">70.2</span>,  <span class="fl">91.8</span>,  <span class="fl">61.3</span>,  <span class="fl">13.7</span>,  <span class="fl">54.9</span>,  <span class="fl">62.5</span>,  <span class="fl">24.2</span>,  <span class="fl">69.4</span>,  <span class="fl">83.1</span>,</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>        <span class="fl">44.</span> ,  <span class="fl">48.5</span>,  <span class="fl">11.9</span>,  <span class="fl">16.6</span>,  <span class="fl">66.4</span>,  <span class="fl">90.</span> ,  <span class="fl">34.9</span>, <span class="fl">132.8</span>,  <span class="fl">33.4</span>,</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>       <span class="fl">225.</span> ,   <span class="fl">7.6</span>,  <span class="fl">40.9</span>,  <span class="fl">76.5</span>,  <span class="fl">48.</span> , <span class="fl">140.</span> ,  <span class="fl">55.9</span>,  <span class="fl">54.1</span>,  <span class="fl">46.4</span>,</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>        <span class="fl">68.6</span>,  <span class="fl">52.2</span>, <span class="fl">108.3</span>,  <span class="fl">14.6</span>,  <span class="fl">11.3</span>,  <span class="fl">29.8</span>, <span class="fl">130.9</span>, <span class="fl">152.4</span>,  <span class="fl">61.</span> ,</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>        <span class="fl">46.6</span>,  <span class="fl">43.9</span>,  <span class="fl">30.9</span>, <span class="fl">111.1</span>,  <span class="fl">68.5</span>,  <span class="fl">42.2</span>,   <span class="fl">9.8</span>, <span class="fl">285.6</span>,  <span class="fl">56.7</span>,</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>       <span class="fl">168.2</span>,  <span class="fl">41.2</span>,  <span class="fl">47.8</span>, <span class="fl">166.6</span>,  <span class="fl">37.8</span>,  <span class="fl">45.4</span>,  <span class="fl">43.2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>rain_november <span class="op">=</span> np.array([ <span class="fl">83.6</span>,  <span class="fl">30.9</span>,  <span class="fl">62.2</span>,  <span class="fl">37.</span> ,  <span class="fl">41.</span> , <span class="fl">160.2</span>,  <span class="fl">18.2</span>, <span class="fl">122.4</span>,  <span class="fl">71.3</span>,</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>        <span class="fl">44.2</span>,  <span class="fl">49.1</span>,  <span class="fl">37.6</span>, <span class="fl">114.5</span>,  <span class="fl">28.8</span>,  <span class="fl">82.5</span>,  <span class="fl">71.9</span>,  <span class="fl">50.7</span>,  <span class="fl">67.7</span>,</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>       <span class="fl">112.</span> ,  <span class="fl">63.6</span>,  <span class="fl">42.8</span>,  <span class="fl">57.2</span>,  <span class="fl">99.1</span>,  <span class="fl">86.4</span>,  <span class="fl">84.4</span>,  <span class="fl">38.1</span>,  <span class="fl">17.7</span>,</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>       <span class="fl">102.2</span>, <span class="fl">101.3</span>,  <span class="fl">58.</span> ,  <span class="fl">82.</span> , <span class="fl">101.4</span>,  <span class="fl">81.4</span>, <span class="fl">100.1</span>,  <span class="fl">54.6</span>,  <span class="fl">39.6</span>,</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>        <span class="fl">57.5</span>,  <span class="fl">29.2</span>,  <span class="fl">48.8</span>,  <span class="fl">37.3</span>, <span class="fl">115.4</span>,  <span class="fl">55.6</span>,  <span class="fl">62.</span> ,  <span class="fl">95.</span> ,  <span class="fl">84.2</span>,</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>       <span class="fl">118.1</span>, <span class="fl">153.2</span>,  <span class="fl">83.4</span>, <span class="fl">104.7</span>,  <span class="fl">59.</span> ,  <span class="fl">46.4</span>,  <span class="fl">50.</span> , <span class="fl">147.6</span>,  <span class="fl">76.8</span>,</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>        <span class="fl">59.9</span>, <span class="fl">101.8</span>, <span class="fl">136.6</span>, <span class="fl">173.</span> ,  <span class="fl">92.5</span>,  <span class="fl">37.</span> ,  <span class="fl">59.8</span>, <span class="fl">142.1</span>,   <span class="fl">9.9</span>,</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>       <span class="fl">158.2</span>,  <span class="fl">72.6</span>,  <span class="fl">28.</span> , <span class="fl">112.9</span>, <span class="fl">119.3</span>, <span class="fl">199.2</span>,  <span class="fl">50.7</span>,  <span class="fl">44.</span> , <span class="fl">170.7</span>,</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>        <span class="fl">67.2</span>,  <span class="fl">21.4</span>,  <span class="fl">61.3</span>,  <span class="fl">15.6</span>, <span class="fl">106.</span> , <span class="fl">116.2</span>,  <span class="fl">42.3</span>,  <span class="fl">38.5</span>, <span class="fl">132.5</span>,</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>        <span class="fl">40.8</span>, <span class="fl">147.5</span>,  <span class="fl">93.9</span>,  <span class="fl">71.4</span>,  <span class="fl">87.3</span>, <span class="fl">163.7</span>, <span class="fl">141.4</span>,  <span class="fl">62.6</span>,  <span class="fl">84.9</span>,</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>        <span class="fl">28.8</span>, <span class="fl">121.1</span>,  <span class="fl">28.6</span>,  <span class="fl">32.4</span>, <span class="fl">112.</span> ,  <span class="fl">50.</span> ,  <span class="fl">96.9</span>,  <span class="fl">81.8</span>,  <span class="fl">70.4</span>,</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>       <span class="fl">117.5</span>,  <span class="fl">41.2</span>, <span class="fl">124.9</span>,  <span class="fl">78.2</span>,  <span class="fl">93.</span> ,  <span class="fl">53.5</span>,  <span class="fl">50.5</span>,  <span class="fl">42.6</span>,  <span class="fl">47.9</span>,</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>        <span class="fl">73.1</span>, <span class="fl">129.1</span>,  <span class="fl">56.9</span>, <span class="fl">103.3</span>,  <span class="fl">60.5</span>, <span class="fl">134.3</span>,  <span class="fl">93.1</span>,  <span class="fl">49.5</span>,  <span class="fl">48.2</span>,</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>       <span class="fl">167.9</span>,  <span class="fl">27.</span> , <span class="fl">111.1</span>,  <span class="fl">55.4</span>,  <span class="fl">36.2</span>,  <span class="fl">57.4</span>,  <span class="fl">66.8</span>,  <span class="fl">58.3</span>,  <span class="fl">60.</span> ,</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>       <span class="fl">161.6</span>, <span class="fl">112.7</span>,  <span class="fl">37.4</span>, <span class="fl">110.6</span>,  <span class="fl">56.6</span>,  <span class="fl">95.8</span>, <span class="fl">126.8</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">50</span>):</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Generate permutation samples</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>    perm_sample_1, perm_sample_2 <span class="op">=</span> permutation_sample(rain_june, rain_november)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Compute ECDFs</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    x_1, y_1 <span class="op">=</span> ecdf(perm_sample_1)</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>    x_2, y_2 <span class="op">=</span> ecdf(perm_sample_2)</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot ECDFs of permutation sample</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>    _ <span class="op">=</span> plt.plot(x_1, y_1, marker<span class="op">=</span><span class="st">'.'</span>, linestyle<span class="op">=</span><span class="st">'none'</span>,</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>                 color<span class="op">=</span><span class="st">'red'</span>, alpha<span class="op">=</span><span class="fl">0.02</span>)</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>    _ <span class="op">=</span> plt.plot(x_2, y_2, marker<span class="op">=</span><span class="st">'.'</span>, linestyle<span class="op">=</span><span class="st">'none'</span>,</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>                 color<span class="op">=</span><span class="st">'blue'</span>, alpha<span class="op">=</span><span class="fl">0.02</span>)</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Create and plot ECDFs from original data</span></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>x_1, y_1 <span class="op">=</span> ecdf(rain_june)</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>x_2, y_2 <span class="op">=</span> ecdf(rain_november)</span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.plot(x_1, y_1, marker<span class="op">=</span><span class="st">'.'</span>, linestyle<span class="op">=</span><span class="st">'none'</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.plot(x_2, y_2, marker<span class="op">=</span><span class="st">'.'</span>, linestyle<span class="op">=</span><span class="st">'none'</span>, color<span class="op">=</span><span class="st">'blue'</span>)</span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Label axes, set margin, and show plot</span></span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>plt.margins(<span class="fl">0.02</span>)</span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.xlabel(<span class="st">'monthly rainfall (mm)'</span>)</span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.ylabel(<span class="st">'ECDF'</span>)</span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2020-07-08-Statistical Thinking in Python (Part 2)_files/figure-html/cell-33-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The permutation samples ECDFs overlap and give a purple haze. None of the ECDFs from the permutation samples overlap with the observed data, suggesting that the hypothesis is not commensurate with the data. June and November rainfall are not identically distributed.</p>
</div>
</div>
</section>
</section>
<section id="test-statistics-and-p-values" class="level2">
<h2 class="anchored" data-anchor-id="test-statistics-and-p-values">Test statistics and p-values</h2>
<blockquote class="blockquote">
<h3 id="hypothesis-testing-1" class="anchored">Hypothesis testing</h3>
<ul>
<li>Assessment of how reasonable the observed data are assuming a hypothesis is true</li>
</ul>
</blockquote>
<blockquote class="blockquote">
<h3 id="test-statistic" class="anchored">Test statistic</h3>
<ul>
<li>A single number that can be computed from observed data and from data you simulate under the null hypothesis</li>
<li>It serves as a basis of comparison between the two</li>
</ul>
</blockquote>
<blockquote class="blockquote">
<h3 id="p-value" class="anchored">p-value</h3>
<ul>
<li>The probability of obtaining a value of your test statistic that is at least as extreme as what was observed, under the assumption the null hypothesis is true</li>
<li><strong>NOT</strong> the probability that the null hypothesis is true</li>
</ul>
</blockquote>
<blockquote class="blockquote">
<h3 id="statistical-signicance" class="anchored">Statistical signicance</h3>
<ul>
<li>Determined by the smallness of a p-value</li>
</ul>
</blockquote>
<blockquote class="blockquote">
<h3 id="null-hypothesis-signicance-testing-nhst" class="anchored">Null hypothesis signicance testing (NHST)</h3>
<ul>
<li>Another name for Hypothesis testing</li>
</ul>
</blockquote>
<section id="test-statistics" class="level3">
<h3 class="anchored" data-anchor-id="test-statistics">Test statistics</h3>
<p>When performing hypothesis tests, the choice of test statistic should be pertinent to the question you are seeking to answer in your hypothesis test.</p>
<div class="callout-important callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>The most important thing to consider is: What are you asking?</p>
</div>
</div>
</section>
<section id="p-value-1" class="level3">
<h3 class="anchored" data-anchor-id="p-value-1">p-value</h3>
<p>The p-value is generally a measure of the probability of observing a test statistic equally or more extreme than the one you observed, given that the null hypothesis is true.</p>
</section>
<section id="generating-permutation-replicates" class="level3">
<h3 class="anchored" data-anchor-id="generating-permutation-replicates">Generating permutation replicates</h3>
<p>a permutation replicate is a single value of a statistic computed from a permutation sample.</p>
<p>As the <code>draw_bs_reps()</code> function is useful for generating bootstrap replicates, it is useful to have a similar function, <code>draw_perm_reps()</code>, to generate permutation replicates.</p>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> draw_perm_reps(data_1, data_2, func, size<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Generate multiple permutation replicates."""</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize array of replicates: perm_replicates</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>    perm_replicates <span class="op">=</span> np.empty(size)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(size):</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Generate permutation sample</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>        perm_sample_1, perm_sample_2 <span class="op">=</span> permutation_sample(data_1, data_2)</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Compute the test statistic</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>        perm_replicates[i] <span class="op">=</span> func(perm_sample_1,perm_sample_2)</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> perm_replicates</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="look-before-you-leap-eda-before-hypothesis-testing" class="level3">
<h3 class="anchored" data-anchor-id="look-before-you-leap-eda-before-hypothesis-testing">Look before you leap: EDA before hypothesis testing</h3>
<p>Kleinteich and Gorb (<em>Sci.</em> Rep., 4, 5225, 2014) performed an interesting experiment with South American horned frogs. They held a plate connected to a force transducer, along with a bait fly, in front of them. They then measured the impact force and adhesive force of the frog’s tongue when it struck the target.</p>
<p>Frog A is an adult and Frog B is a juvenile. The researchers measured the impact force of 20 strikes for each frog. we will test the hypothesis that the two frogs have the same distribution of impact forces. it is important to do EDA first! Let’s make a bee swarm plot for the data.</p>
<p>They are stored in a Pandas data frame, <code>frogs</code>, where column <code>ID</code> is the identity of the frog and column <code>impact_force</code> is the impact force in Newtons (N).</p>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>frogs <span class="op">=</span> pd.read_csv(<span class="st">"datasets/frogs.csv"</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>frogs.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>ID</th>
      <th>impact_force</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A</td>
      <td>1.612</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A</td>
      <td>0.605</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A</td>
      <td>0.327</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A</td>
      <td>0.946</td>
    </tr>
    <tr>
      <th>4</th>
      <td>A</td>
      <td>0.541</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make bee swarm plot</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> sns.swarmplot(data<span class="op">=</span>frogs, x<span class="op">=</span><span class="st">"ID"</span>, y<span class="op">=</span><span class="st">"impact_force"</span>)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Label axes</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.xlabel(<span class="st">'frog'</span>)</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.ylabel(<span class="st">'impact force (N)'</span>)</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the plot</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2020-07-08-Statistical Thinking in Python (Part 2)_files/figure-html/cell-36-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Eyeballing it, it does not look like they come from the same distribution. Frog A, the adult, has three or four very hard strikes, and Frog B, the juvenile, has a couple weak ones. However, it is possible that with only 20 samples it might be too difficult to tell if they have difference distributions, so we should proceed with the hypothesis test.</p>
</section>
<section id="permutation-test-on-frog-data" class="level3">
<h3 class="anchored" data-anchor-id="permutation-test-on-frog-data">Permutation test on frog data</h3>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>frogs[frogs.ID<span class="op">==</span><span class="st">"A"</span>].impact_force.mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<pre><code>0.70735</code></pre>
</div>
</div>
<div class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>frogs[frogs.ID<span class="op">==</span><span class="st">"B"</span>].impact_force.mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<pre><code>0.4191000000000001</code></pre>
</div>
</div>
<div class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>frogs[frogs.ID<span class="op">==</span><span class="st">"A"</span>].impact_force.mean() <span class="op">-</span> frogs[frogs.ID<span class="op">==</span><span class="st">"B"</span>].impact_force.mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<pre><code>0.28824999999999995</code></pre>
</div>
</div>
<p>The average strike force of Frog A was 0.71 Newtons (N), and that of Frog B was 0.42 N for a difference of 0.29 N. It is possible the frogs strike with the same force and this observed difference was by chance.</p>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>force_a <span class="op">=</span> np.array([<span class="fl">1.612</span>, <span class="fl">0.605</span>, <span class="fl">0.327</span>, <span class="fl">0.946</span>, <span class="fl">0.541</span>, <span class="fl">1.539</span>, <span class="fl">0.529</span>, <span class="fl">0.628</span>, <span class="fl">1.453</span>,</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>       <span class="fl">0.297</span>, <span class="fl">0.703</span>, <span class="fl">0.269</span>, <span class="fl">0.751</span>, <span class="fl">0.245</span>, <span class="fl">1.182</span>, <span class="fl">0.515</span>, <span class="fl">0.435</span>, <span class="fl">0.383</span>,</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>       <span class="fl">0.457</span>, <span class="fl">0.73</span> ])</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>force_b <span class="op">=</span> np.array([<span class="fl">0.172</span>, <span class="fl">0.142</span>, <span class="fl">0.037</span>, <span class="fl">0.453</span>, <span class="fl">0.355</span>, <span class="fl">0.022</span>, <span class="fl">0.502</span>, <span class="fl">0.273</span>, <span class="fl">0.72</span> ,</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>       <span class="fl">0.582</span>, <span class="fl">0.198</span>, <span class="fl">0.198</span>, <span class="fl">0.597</span>, <span class="fl">0.516</span>, <span class="fl">0.815</span>, <span class="fl">0.402</span>, <span class="fl">0.605</span>, <span class="fl">0.711</span>,</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>       <span class="fl">0.614</span>, <span class="fl">0.468</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will compute the probability of getting at least a 0.29 N difference in mean strike force under the hypothesis that the distributions of strike forces for the two frogs are identical. We use a permutation test with a test statistic of the difference of means to test this hypothesis.</p>
<div class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> diff_of_means(data_1, data_2):</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Difference in means of two arrays."""</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The difference of means of data_1, data_2: diff</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>    diff <span class="op">=</span> np.mean(data_1) <span class="op">-</span> np.mean(data_2)</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> diff</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute difference of mean impact force from experiment: empirical_diff_means</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>empirical_diff_means <span class="op">=</span> diff_of_means(force_a, force_b)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>empirical_diff_means</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">
<pre><code>0.28825000000000006</code></pre>
</div>
</div>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Draw 10,000 permutation replicates: perm_replicates</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>perm_replicates <span class="op">=</span> draw_perm_reps(force_a, force_b,</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>                                 diff_of_means, size<span class="op">=</span><span class="dv">10000</span>)</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute p-value: p</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> np.<span class="bu">sum</span>(perm_replicates <span class="op">&gt;=</span> empirical_diff_means) <span class="op">/</span> <span class="bu">len</span>(perm_replicates)</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the result</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'p-value ='</span>, p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>p-value = 0.0058</code></pre>
</div>
</div>
<p>The p-value tells us that there is about a 0.6% chance that we would get the difference of means observed in the experiment if frogs were exactly the same. A p-value below 0.01 is typically said to be “statistically significant,” but:</p>
<div class="callout-warning callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Warning! warning! warning! We have computed a p-value; it is a number. I encourage you not to distill it to a yes-or-no phrase. p = 0.006 and p = 0.000000006 are both said to be “statistically significant,” but they are definitely not the same!</p>
</div>
</div>
</section>
</section>
<section id="bootstrap-hypothesis-tests" class="level2">
<h2 class="anchored" data-anchor-id="bootstrap-hypothesis-tests">Bootstrap hypothesis tests</h2>
<blockquote class="blockquote">
<p>Pipeline for hypothesis testing - Clearly state the null hypothesis - Define your test statistic - Generate many sets of simulated data assuming the null hypothesis is true - Compute the test statistic for each simulated data set - The p-value is the fraction of your simulated data sets for which the test statistic is at least as extreme as for the real data</p>
</blockquote>
<section id="a-one-sample-bootstrap-hypothesis-test" class="level3">
<h3 class="anchored" data-anchor-id="a-one-sample-bootstrap-hypothesis-test">A one-sample bootstrap hypothesis test</h3>
<p>Another juvenile frog was studied, Frog C, and we want to see if Frog B and Frog C have similar impact forces. Unfortunately, we do not have Frog C’s impact forces available, but we know they have a mean of 0.55 N. Because we don’t have the original data, we cannot do a permutation test, and we cannot assess the hypothesis that the forces from Frog B and Frog C come from the same distribution. We will therefore test another, less restrictive hypothesis: The mean strike force of Frog B is equal to that of Frog C.</p>
<p>To set up the bootstrap hypothesis test, we will take the mean as our test statistic. Our goal is to calculate the probability of getting a mean impact force less than or equal to what was observed for Frog B <em>if the hypothesis that the true mean of Frog B’s impact forces is equal to that of Frog C is true</em>. We will first translate all of the data of Frog B such that the mean is 0.55 N. This involves adding the mean force of Frog C and subtracting the mean force of Frog B from each measurement of Frog B. This leaves other properties of Frog B’s distribution, such as the variance, unchanged.</p>
<div class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make an array of translated impact forces: translated_force_b</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>translated_force_b <span class="op">=</span> force_b <span class="op">-</span> np.mean(force_b) <span class="op">+</span> <span class="fl">0.55</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Take bootstrap replicates of Frog B's translated impact forces: bs_replicates</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>bs_replicates <span class="op">=</span> draw_bs_reps(translated_force_b, np.mean, <span class="dv">10000</span>)</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute fraction of replicates that are less than the observed Frog B force: p</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> np.<span class="bu">sum</span>(bs_replicates <span class="op">&lt;=</span> np.mean(force_b)) <span class="op">/</span> <span class="dv">10000</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the p-value</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'p = '</span>, p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>p =  0.0046</code></pre>
</div>
</div>
<p>The low p-value suggests that the null hypothesis that Frog B and Frog C have the same mean impact force is false.</p>
</section>
<section id="a-two-sample-bootstrap-hypothesis-test-for-difference-of-means" class="level3">
<h3 class="anchored" data-anchor-id="a-two-sample-bootstrap-hypothesis-test-for-difference-of-means">A two-sample bootstrap hypothesis test for difference of means</h3>
<p>We now want to test the hypothesis that Frog A and Frog B have the same mean impact force, but not necessarily the same distribution, which is also impossible with a permutation test.</p>
<p>To do the two-sample bootstrap test, we shift both arrays to have the same mean, since we are simulating the hypothesis that their means are, in fact, equal. We then draw bootstrap samples out of the shifted arrays and compute the difference in means. This constitutes a bootstrap replicate, and we generate many of them. The p-value is the fraction of replicates with a difference in means greater than or equal to what was observed.</p>
<div class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>forces_concat <span class="op">=</span> np.array([<span class="fl">1.612</span>, <span class="fl">0.605</span>, <span class="fl">0.327</span>, <span class="fl">0.946</span>, <span class="fl">0.541</span>, <span class="fl">1.539</span>, <span class="fl">0.529</span>, <span class="fl">0.628</span>, <span class="fl">1.453</span>,</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>       <span class="fl">0.297</span>, <span class="fl">0.703</span>, <span class="fl">0.269</span>, <span class="fl">0.751</span>, <span class="fl">0.245</span>, <span class="fl">1.182</span>, <span class="fl">0.515</span>, <span class="fl">0.435</span>, <span class="fl">0.383</span>,</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>       <span class="fl">0.457</span>, <span class="fl">0.73</span> , <span class="fl">0.172</span>, <span class="fl">0.142</span>, <span class="fl">0.037</span>, <span class="fl">0.453</span>, <span class="fl">0.355</span>, <span class="fl">0.022</span>, <span class="fl">0.502</span>,</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>       <span class="fl">0.273</span>, <span class="fl">0.72</span> , <span class="fl">0.582</span>, <span class="fl">0.198</span>, <span class="fl">0.198</span>, <span class="fl">0.597</span>, <span class="fl">0.516</span>, <span class="fl">0.815</span>, <span class="fl">0.402</span>,</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>       <span class="fl">0.605</span>, <span class="fl">0.711</span>, <span class="fl">0.614</span>, <span class="fl">0.468</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>empirical_diff_means <span class="op">=</span> <span class="fl">0.28825000000000006</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="hypothesis-test-examples" class="level1">
<h1>Hypothesis test examples</h1>
<p>Hypothesis testing can be a bit tricky. We need to define the null hypothesis, figure out how to simulate it, and define clearly what it means to be “more extreme” in order to compute the p-value. Like any skill, practice makes perfect.</p>
<section id="ab-testing" class="level2">
<h2 class="anchored" data-anchor-id="ab-testing">A/B testing</h2>
<blockquote class="blockquote">
<h3 id="ab-test" class="anchored">A/B test</h3>
<ul>
<li>Used by organizations to see if a strategy change gives a better result</li>
</ul>
</blockquote>
<blockquote class="blockquote">
<h3 id="null-hypothesis-of-an-ab-test" class="anchored">Null hypothesis of an A/B test</h3>
<ul>
<li>The test statistic is impervious to the change</li>
</ul>
</blockquote>
<section id="the-vote-for-the-civil-rights-act-in-1964" class="level3">
<h3 class="anchored" data-anchor-id="the-vote-for-the-civil-rights-act-in-1964">The vote for the Civil Rights Act in 1964</h3>
<p>The Civil Rights Act of 1964 was one of the most important pieces of legislation ever passed in the USA. Excluding “present” and “abstain” votes, 153 House Democrats and 136 Republicans voted yea. However, 91 Democrats and 35 Republicans voted nay. Did party affiliation make a difference in the vote?</p>
<p>To answer this question, we will evaluate the hypothesis that the party of a House member has no bearing on his or her vote. We will use the fraction of Democrats voting in favor as our test statistic and evaluate the probability of observing a fraction of Democrats voting in favor at least as small as the observed fraction of 153/244. (That’s right, at least as <em>small as</em>. In 1964, it was the Democrats who were less progressive on civil rights issues.) To do this, we will permute the party labels of the House voters and then arbitrarily divide them into “Democrats” and “Republicans” and compute the fraction of Democrats voting yea.</p>
<div class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct arrays of data: dems, reps</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>dems <span class="op">=</span> np.array([<span class="va">True</span>] <span class="op">*</span> <span class="dv">153</span> <span class="op">+</span> [<span class="va">False</span>] <span class="op">*</span> <span class="dv">91</span>)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>reps <span class="op">=</span> np.array([<span class="va">True</span>]<span class="op">*</span><span class="dv">136</span> <span class="op">+</span> [<span class="va">False</span>]<span class="op">*</span><span class="dv">35</span>)</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> frac_yea_dems(dems, reps):</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Compute fraction of Democrat yea votes."""</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>    frac <span class="op">=</span> np.<span class="bu">sum</span>(dems) <span class="op">/</span> <span class="bu">len</span>(dems)</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> frac</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Acquire permutation samples: perm_replicates</span></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>perm_replicates <span class="op">=</span> draw_perm_reps(dems, reps, frac_yea_dems, size<span class="op">=</span><span class="dv">10000</span>)</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute and print p-value: p</span></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> np.<span class="bu">sum</span>(perm_replicates <span class="op">&lt;=</span> <span class="dv">153</span><span class="op">/</span><span class="dv">244</span>) <span class="op">/</span> <span class="bu">len</span>(perm_replicates)</span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'p-value ='</span>, p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>p-value = 0.0002</code></pre>
</div>
</div>
<p>This small p-value suggests that party identity had a lot to do with the voting. Importantly, the South had a higher fraction of Democrat representatives, and consequently also a more racist bias.</p>
</section>
<section id="a-time-on-website-analog" class="level3">
<h3 class="anchored" data-anchor-id="a-time-on-website-analog">A time-on-website analog</h3>
<p>It turns out that we already did a hypothesis test analogous to an A/B test where we are interested in how much time is spent on the website before and after an ad campaign. The frog tongue force (a continuous quantity like time on the website) is an analog. “Before” = Frog A and “after” = Frog B. Let’s practice this again with something that actually is a before/after scenario.</p>
<p>We return to the no-hitter data set. In 1920, Major League Baseball implemented important rule changes that ended the so-called dead ball era. Importantly, the pitcher was no longer allowed to spit on or scuff the ball, an activity that greatly favors pitchers. In this problem we will perform an A/B test to determine if these rule changes resulted in a slower rate of no-hitters (i.e., longer average time between no-hitters) using the difference in mean inter-no-hitter time as our test statistic. The inter-no-hitter times for the respective eras are stored in the arrays <code>nht_dead</code> and <code>nht_live</code>, where “nht” is meant to stand for “no-hitter time.”</p>
<div class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>nht_dead <span class="op">=</span> np.array([  <span class="op">-</span><span class="dv">1</span>,  <span class="dv">894</span>,   <span class="dv">10</span>,  <span class="dv">130</span>,    <span class="dv">1</span>,  <span class="dv">934</span>,   <span class="dv">29</span>,    <span class="dv">6</span>,  <span class="dv">485</span>,  <span class="dv">254</span>,  <span class="dv">372</span>,</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>         <span class="dv">81</span>,  <span class="dv">191</span>,  <span class="dv">355</span>,  <span class="dv">180</span>,  <span class="dv">286</span>,   <span class="dv">47</span>,  <span class="dv">269</span>,  <span class="dv">361</span>,  <span class="dv">173</span>,  <span class="dv">246</span>,  <span class="dv">492</span>,</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>        <span class="dv">462</span>, <span class="dv">1319</span>,   <span class="dv">58</span>,  <span class="dv">297</span>,   <span class="dv">31</span>, <span class="dv">2970</span>,  <span class="dv">640</span>,  <span class="dv">237</span>,  <span class="dv">434</span>,  <span class="dv">570</span>,   <span class="dv">77</span>,</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>        <span class="dv">271</span>,  <span class="dv">563</span>, <span class="dv">3365</span>,   <span class="dv">89</span>,    <span class="dv">0</span>,  <span class="dv">379</span>,  <span class="dv">221</span>,  <span class="dv">479</span>,  <span class="dv">367</span>,  <span class="dv">628</span>,  <span class="dv">843</span>,</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>       <span class="dv">1613</span>, <span class="dv">1101</span>,  <span class="dv">215</span>,  <span class="dv">684</span>,  <span class="dv">814</span>,  <span class="dv">278</span>,  <span class="dv">324</span>,  <span class="dv">161</span>,  <span class="dv">219</span>,  <span class="dv">545</span>,  <span class="dv">715</span>,</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>        <span class="dv">966</span>,  <span class="dv">624</span>,   <span class="dv">29</span>,  <span class="dv">450</span>,  <span class="dv">107</span>,   <span class="dv">20</span>,   <span class="dv">91</span>, <span class="dv">1325</span>,  <span class="dv">124</span>, <span class="dv">1468</span>,  <span class="dv">104</span>,</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>       <span class="dv">1309</span>,  <span class="dv">429</span>,   <span class="dv">62</span>, <span class="dv">1878</span>, <span class="dv">1104</span>,  <span class="dv">123</span>,  <span class="dv">251</span>,   <span class="dv">93</span>,  <span class="dv">188</span>,  <span class="dv">983</span>,  <span class="dv">166</span>,</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>         <span class="dv">96</span>,  <span class="dv">702</span>,   <span class="dv">23</span>,  <span class="dv">524</span>,   <span class="dv">26</span>,  <span class="dv">299</span>,   <span class="dv">59</span>,   <span class="dv">39</span>,   <span class="dv">12</span>,    <span class="dv">2</span>,  <span class="dv">308</span>,</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>       <span class="dv">1114</span>,  <span class="dv">813</span>,  <span class="dv">887</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>nht_live <span class="op">=</span> np.array([ <span class="dv">645</span>, <span class="dv">2088</span>,   <span class="dv">42</span>, <span class="dv">2090</span>,   <span class="dv">11</span>,  <span class="dv">886</span>, <span class="dv">1665</span>, <span class="dv">1084</span>, <span class="dv">2900</span>, <span class="dv">2432</span>,  <span class="dv">750</span>,</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>       <span class="dv">4021</span>, <span class="dv">1070</span>, <span class="dv">1765</span>, <span class="dv">1322</span>,   <span class="dv">26</span>,  <span class="dv">548</span>, <span class="dv">1525</span>,   <span class="dv">77</span>, <span class="dv">2181</span>, <span class="dv">2752</span>,  <span class="dv">127</span>,</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>       <span class="dv">2147</span>,  <span class="dv">211</span>,   <span class="dv">41</span>, <span class="dv">1575</span>,  <span class="dv">151</span>,  <span class="dv">479</span>,  <span class="dv">697</span>,  <span class="dv">557</span>, <span class="dv">2267</span>,  <span class="dv">542</span>,  <span class="dv">392</span>,</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>         <span class="dv">73</span>,  <span class="dv">603</span>,  <span class="dv">233</span>,  <span class="dv">255</span>,  <span class="dv">528</span>,  <span class="dv">397</span>, <span class="dv">1529</span>, <span class="dv">1023</span>, <span class="dv">1194</span>,  <span class="dv">462</span>,  <span class="dv">583</span>,</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>         <span class="dv">37</span>,  <span class="dv">943</span>,  <span class="dv">996</span>,  <span class="dv">480</span>, <span class="dv">1497</span>,  <span class="dv">717</span>,  <span class="dv">224</span>,  <span class="dv">219</span>, <span class="dv">1531</span>,  <span class="dv">498</span>,   <span class="dv">44</span>,</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>        <span class="dv">288</span>,  <span class="dv">267</span>,  <span class="dv">600</span>,   <span class="dv">52</span>,  <span class="dv">269</span>, <span class="dv">1086</span>,  <span class="dv">386</span>,  <span class="dv">176</span>, <span class="dv">2199</span>,  <span class="dv">216</span>,   <span class="dv">54</span>,</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>        <span class="dv">675</span>, <span class="dv">1243</span>,  <span class="dv">463</span>,  <span class="dv">650</span>,  <span class="dv">171</span>,  <span class="dv">327</span>,  <span class="dv">110</span>,  <span class="dv">774</span>,  <span class="dv">509</span>,    <span class="dv">8</span>,  <span class="dv">197</span>,</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>        <span class="dv">136</span>,   <span class="dv">12</span>, <span class="dv">1124</span>,   <span class="dv">64</span>,  <span class="dv">380</span>,  <span class="dv">811</span>,  <span class="dv">232</span>,  <span class="dv">192</span>,  <span class="dv">731</span>,  <span class="dv">715</span>,  <span class="dv">226</span>,</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>        <span class="dv">605</span>,  <span class="dv">539</span>, <span class="dv">1491</span>,  <span class="dv">323</span>,  <span class="dv">240</span>,  <span class="dv">179</span>,  <span class="dv">702</span>,  <span class="dv">156</span>,   <span class="dv">82</span>, <span class="dv">1397</span>,  <span class="dv">354</span>,</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>        <span class="dv">778</span>,  <span class="dv">603</span>, <span class="dv">1001</span>,  <span class="dv">385</span>,  <span class="dv">986</span>,  <span class="dv">203</span>,  <span class="dv">149</span>,  <span class="dv">576</span>,  <span class="dv">445</span>,  <span class="dv">180</span>, <span class="dv">1403</span>,</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>        <span class="dv">252</span>,  <span class="dv">675</span>, <span class="dv">1351</span>, <span class="dv">2983</span>, <span class="dv">1568</span>,   <span class="dv">45</span>,  <span class="dv">899</span>, <span class="dv">3260</span>, <span class="dv">1025</span>,   <span class="dv">31</span>,  <span class="dv">100</span>,</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>       <span class="dv">2055</span>, <span class="dv">4043</span>,   <span class="dv">79</span>,  <span class="dv">238</span>, <span class="dv">3931</span>, <span class="dv">2351</span>,  <span class="dv">595</span>,  <span class="dv">110</span>,  <span class="dv">215</span>,    <span class="dv">0</span>,  <span class="dv">563</span>,</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>        <span class="dv">206</span>,  <span class="dv">660</span>,  <span class="dv">242</span>,  <span class="dv">577</span>,  <span class="dv">179</span>,  <span class="dv">157</span>,  <span class="dv">192</span>,  <span class="dv">192</span>, <span class="dv">1848</span>,  <span class="dv">792</span>, <span class="dv">1693</span>,</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>         <span class="dv">55</span>,  <span class="dv">388</span>,  <span class="dv">225</span>, <span class="dv">1134</span>, <span class="dv">1172</span>, <span class="dv">1555</span>,   <span class="dv">31</span>, <span class="dv">1582</span>, <span class="dv">1044</span>,  <span class="dv">378</span>, <span class="dv">1687</span>,</span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>       <span class="dv">2915</span>,  <span class="dv">280</span>,  <span class="dv">765</span>, <span class="dv">2819</span>,  <span class="dv">511</span>, <span class="dv">1521</span>,  <span class="dv">745</span>, <span class="dv">2491</span>,  <span class="dv">580</span>, <span class="dv">2072</span>, <span class="dv">6450</span>,</span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>        <span class="dv">578</span>,  <span class="dv">745</span>, <span class="dv">1075</span>, <span class="dv">1103</span>, <span class="dv">1549</span>, <span class="dv">1520</span>,  <span class="dv">138</span>, <span class="dv">1202</span>,  <span class="dv">296</span>,  <span class="dv">277</span>,  <span class="dv">351</span>,</span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>        <span class="dv">391</span>,  <span class="dv">950</span>,  <span class="dv">459</span>,   <span class="dv">62</span>, <span class="dv">1056</span>, <span class="dv">1128</span>,  <span class="dv">139</span>,  <span class="dv">420</span>,   <span class="dv">87</span>,   <span class="dv">71</span>,  <span class="dv">814</span>,</span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>        <span class="dv">603</span>, <span class="dv">1349</span>,  <span class="dv">162</span>, <span class="dv">1027</span>,  <span class="dv">783</span>,  <span class="dv">326</span>,  <span class="dv">101</span>,  <span class="dv">876</span>,  <span class="dv">381</span>,  <span class="dv">905</span>,  <span class="dv">156</span>,</span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>        <span class="dv">419</span>,  <span class="dv">239</span>,  <span class="dv">119</span>,  <span class="dv">129</span>,  <span class="dv">467</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the observed difference in mean inter-no-hitter times: nht_diff_obs</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>nht_diff_obs <span class="op">=</span> diff_of_means(nht_dead, nht_live)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Acquire 10,000 permutation replicates of difference in mean no-hitter time: perm_replicates</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>perm_replicates <span class="op">=</span> draw_perm_reps(nht_dead, nht_live, diff_of_means, size<span class="op">=</span><span class="dv">10000</span>)</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute and print the p-value: p</span></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="bu">sum</span>(perm_replicates <span class="op">&lt;=</span> nht_diff_obs)<span class="op">/</span><span class="bu">len</span>(perm_replicates)</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'p-val ='</span>, p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>p-val = 0.0002</code></pre>
</div>
</div>
<p>our p-value is 0.0001, which means that only one out of your 10,000 replicates had a result as extreme as the actual difference between the dead ball and live ball eras. This suggests strong statistical significance.</p>
<div class="callout-warning callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Watch out, though, we could very well have gotten zero replicates that were as extreme as the observed value. This just means that the p-value is quite small, almost certainly smaller than 0.001.</p>
</div>
</div>
<div class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>x_dead, y_dead <span class="op">=</span> ecdf(nht_dead)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>x_live, y_live <span class="op">=</span> ecdf(nht_live)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.plot(x_dead, y_dead)</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.plot(x_live, y_live)</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.xlabel(<span class="st">"non hitter times"</span>)</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.legend([<span class="st">"nht dead"</span>, <span class="st">"nht live"</span>])</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.ylabel(<span class="st">"CDF"</span>)</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2020-07-08-Statistical Thinking in Python (Part 2)_files/figure-html/cell-51-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="test-of-correlation" class="level2">
<h2 class="anchored" data-anchor-id="test-of-correlation">Test of correlation</h2>
<blockquote class="blockquote">
<h3 id="hypothesis-test-of-correlation" class="anchored">Hypothesis test of correlation</h3>
<ul>
<li>Posit null hypothesis:the two variables are completely uncorrelated</li>
<li>Simulate data assuming null hypothesis is true</li>
<li>Use Pearson correlation, <span class="math inline">\(\rho\)</span>, as test statistic</li>
<li>Compute p-value as fraction of replicates that have ρ at least as large as observed.</li>
</ul>
</blockquote>
<section id="simulating-a-null-hypothesis-concerning-correlation" class="level3">
<h3 class="anchored" data-anchor-id="simulating-a-null-hypothesis-concerning-correlation">Simulating a null hypothesis concerning correlation</h3>
<p>The observed correlation between female illiteracy and fertility in the data set of 162 countries may just be by chance; the fertility of a given country may actually be totally independent of its illiteracy. We will test this null hypothesis.</p>
<p>To do the test, we need to simulate the data assuming the null hypothesis is true. The best way to it is to Do a permutation test: Permute the illiteracy values but leave the fertility values fixed to generate a new set of (illiteracy, fertility) data.</p>
</section>
<section id="hypothesis-test-on-pearson-correlation" class="level3">
<h3 class="anchored" data-anchor-id="hypothesis-test-on-pearson-correlation">Hypothesis test on Pearson correlation</h3>
<p>The observed correlation between female illiteracy and fertility may just be by chance; the fertility of a given country may actually be totally independent of its illiteracy. We will test this hypothesis. To do so, we’ll permute the illiteracy values but leave the fertility values fixed. This simulates the hypothesis that they are totally independent of each other. For each permutation, we’ll compute the Pearson correlation coefficient and assess how many of the permutation replicates have a Pearson correlation coefficient greater than the observed one.</p>
<div class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute observed correlation: r_obs</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>r_obs <span class="op">=</span> pearson_r(illiteracy, fertility)</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize permutation replicates: perm_replicates</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>perm_replicates <span class="op">=</span> np.empty(<span class="dv">10000</span>)</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Draw replicates</span></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10000</span>):</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Permute illiteracy measurments: illiteracy_permuted</span></span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>    illiteracy_permuted <span class="op">=</span> np.random.permutation(illiteracy)</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Compute Pearson correlation</span></span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>    perm_replicates[i] <span class="op">=</span> pearson_r(illiteracy_permuted, fertility)</span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute p-value: p</span></span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> np.<span class="bu">sum</span>(perm_replicates <span class="op">&gt;=</span> r_obs) <span class="op">/</span> <span class="bu">len</span>(perm_replicates)</span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'p-val ='</span>, p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>p-val = 0.0</code></pre>
</div>
</div>
<p>We got a p-value of zero. In hacker statistics, this means that the p-value is very low, since we never got a single replicate in the 10,000 we took that had a Pearson correlation greater than the observed one. we could try increasing the number of replicates you take to continue to move the upper bound on the p-value lower and lower.</p>
</section>
<section id="do-neonicotinoid-insecticides-have-unintended-consequences" class="level3">
<h3 class="anchored" data-anchor-id="do-neonicotinoid-insecticides-have-unintended-consequences">Do neonicotinoid insecticides have unintended consequences?</h3>
<p>We will investigate the effects of neonicotinoid insecticides on bee reproduction. These insecticides are very widely used in the United States to combat aphids and other pests that damage plants.</p>
<p>In a recent study, Straub, et al.&nbsp;(<a href="http://dx.doi.org/10.1098/rspb.2016.0506"><em>Proc. Roy. Soc. B, 2016</em></a>) investigated the effects of neonicotinoids on the sperm of pollinating bees. In this and the next exercise, you will study how the pesticide treatment affected the count of live sperm per half milliliter of semen.</p>
<p>First, we will do EDA, as usual. Plot ECDFs of the alive sperm count for untreated bees (stored in the Numpy array <code>control</code>) and bees treated with pesticide (stored in the Numpy array <code>treated</code>).</p>
<div class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>control <span class="op">=</span> np.array([ <span class="fl">4.159234</span>,  <span class="fl">4.408002</span>,  <span class="fl">0.172812</span>,  <span class="fl">3.498278</span>,  <span class="fl">3.104912</span>,  <span class="fl">5.164174</span>,</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>        <span class="fl">6.615262</span>,  <span class="fl">4.633066</span>,  <span class="fl">0.170408</span>,  <span class="fl">2.65</span>    ,  <span class="fl">0.0875</span>  ,  <span class="fl">1.997148</span>,</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>        <span class="fl">6.92668</span> ,  <span class="fl">4.574932</span>,  <span class="fl">3.896466</span>,  <span class="fl">5.209814</span>,  <span class="fl">3.70625</span> ,  <span class="fl">0.</span>      ,</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>        <span class="fl">4.62545</span> ,  <span class="fl">3.01444</span> ,  <span class="fl">0.732652</span>,  <span class="fl">0.4</span>     ,  <span class="fl">6.518382</span>,  <span class="fl">5.225</span>   ,</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>        <span class="fl">6.218742</span>,  <span class="fl">6.840358</span>,  <span class="fl">1.211308</span>,  <span class="fl">0.368252</span>,  <span class="fl">3.59937</span> ,  <span class="fl">4.212158</span>,</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>        <span class="fl">6.052364</span>,  <span class="fl">2.115532</span>,  <span class="fl">6.60413</span> ,  <span class="fl">5.26074</span> ,  <span class="fl">6.05695</span> ,  <span class="fl">6.481172</span>,</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>        <span class="fl">3.171522</span>,  <span class="fl">3.057228</span>,  <span class="fl">0.218808</span>,  <span class="fl">5.215112</span>,  <span class="fl">4.465168</span>,  <span class="fl">2.28909</span> ,</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>        <span class="fl">3.732572</span>,  <span class="fl">2.17087</span> ,  <span class="fl">1.834326</span>,  <span class="fl">6.074862</span>,  <span class="fl">5.841978</span>,  <span class="fl">8.524892</span>,</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>        <span class="fl">4.698492</span>,  <span class="fl">2.965624</span>,  <span class="fl">2.324206</span>,  <span class="fl">3.409412</span>,  <span class="fl">4.830726</span>,  <span class="fl">0.1</span>     ,</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>        <span class="fl">0.</span>      ,  <span class="fl">4.101432</span>,  <span class="fl">3.478162</span>,  <span class="fl">1.009688</span>,  <span class="fl">4.999296</span>,  <span class="fl">4.32196</span> ,</span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>        <span class="fl">0.299592</span>,  <span class="fl">3.606032</span>,  <span class="fl">7.54026</span> ,  <span class="fl">4.284024</span>,  <span class="fl">0.057494</span>,  <span class="fl">6.036668</span>,</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>        <span class="fl">2.924084</span>,  <span class="fl">4.150144</span>,  <span class="fl">1.256926</span>,  <span class="fl">4.666502</span>,  <span class="fl">4.806594</span>,  <span class="fl">2.52478</span> ,</span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>        <span class="fl">2.027654</span>,  <span class="fl">2.52283</span> ,  <span class="fl">4.735598</span>,  <span class="fl">2.033236</span>,  <span class="fl">0.</span>      ,  <span class="fl">6.177294</span>,</span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>        <span class="fl">2.601834</span>,  <span class="fl">3.544408</span>,  <span class="fl">3.6045</span>  ,  <span class="fl">5.520346</span>,  <span class="fl">4.80698</span> ,  <span class="fl">3.002478</span>,</span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>        <span class="fl">3.559816</span>,  <span class="fl">7.075844</span>, <span class="fl">10.</span>      ,  <span class="fl">0.139772</span>,  <span class="fl">6.17171</span> ,  <span class="fl">3.201232</span>,</span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>        <span class="fl">8.459546</span>,  <span class="fl">0.17857</span> ,  <span class="fl">7.088276</span>,  <span class="fl">5.496662</span>,  <span class="fl">5.415086</span>,  <span class="fl">1.932282</span>,</span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a>        <span class="fl">3.02838</span> ,  <span class="fl">7.47996</span> ,  <span class="fl">1.86259</span> ,  <span class="fl">7.838498</span>,  <span class="fl">2.242718</span>,  <span class="fl">3.292958</span>,</span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a>        <span class="fl">6.363644</span>,  <span class="fl">4.386898</span>,  <span class="fl">8.47533</span> ,  <span class="fl">4.156304</span>,  <span class="fl">1.463956</span>,  <span class="fl">4.533628</span>,</span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a>        <span class="fl">5.573922</span>,  <span class="fl">1.29454</span> ,  <span class="fl">7.547504</span>,  <span class="fl">3.92466</span> ,  <span class="fl">5.820258</span>,  <span class="fl">4.118522</span>,</span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a>        <span class="fl">4.125</span>   ,  <span class="fl">2.286698</span>,  <span class="fl">0.591882</span>,  <span class="fl">1.273124</span>,  <span class="fl">0.</span>      ,  <span class="fl">0.</span>      ,</span>
<span id="cb69-21"><a href="#cb69-21" aria-hidden="true" tabindex="-1"></a>        <span class="fl">0.</span>      , <span class="fl">12.22502</span> ,  <span class="fl">7.601604</span>,  <span class="fl">5.56798</span> ,  <span class="fl">1.679914</span>,  <span class="fl">8.77096</span> ,</span>
<span id="cb69-22"><a href="#cb69-22" aria-hidden="true" tabindex="-1"></a>        <span class="fl">5.823942</span>,  <span class="fl">0.258374</span>,  <span class="fl">0.</span>      ,  <span class="fl">5.899236</span>,  <span class="fl">5.486354</span>,  <span class="fl">2.053148</span>,</span>
<span id="cb69-23"><a href="#cb69-23" aria-hidden="true" tabindex="-1"></a>        <span class="fl">3.25541</span> ,  <span class="fl">2.72564</span> ,  <span class="fl">3.364066</span>,  <span class="fl">2.43427</span> ,  <span class="fl">5.282548</span>,  <span class="fl">3.963666</span>,</span>
<span id="cb69-24"><a href="#cb69-24" aria-hidden="true" tabindex="-1"></a>        <span class="fl">0.24851</span> ,  <span class="fl">0.347916</span>,  <span class="fl">4.046862</span>,  <span class="fl">5.461436</span>,  <span class="fl">4.066104</span>,  <span class="fl">0.</span>      ,</span>
<span id="cb69-25"><a href="#cb69-25" aria-hidden="true" tabindex="-1"></a>        <span class="fl">0.065</span>   ])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>treated <span class="op">=</span> np.array([<span class="fl">1.342686</span>, <span class="fl">1.058476</span>, <span class="fl">3.793784</span>, <span class="fl">0.40428</span> , <span class="fl">4.528388</span>, <span class="fl">2.142966</span>,</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>       <span class="fl">3.937742</span>, <span class="fl">0.1375</span>  , <span class="fl">6.919164</span>, <span class="fl">0.</span>      , <span class="fl">3.597812</span>, <span class="fl">5.196538</span>,</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>       <span class="fl">2.78955</span> , <span class="fl">2.3229</span>  , <span class="fl">1.090636</span>, <span class="fl">5.323916</span>, <span class="fl">1.021618</span>, <span class="fl">0.931836</span>,</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>       <span class="fl">2.78</span>    , <span class="fl">0.412202</span>, <span class="fl">1.180934</span>, <span class="fl">2.8674</span>  , <span class="fl">0.</span>      , <span class="fl">0.064354</span>,</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>       <span class="fl">3.008348</span>, <span class="fl">0.876634</span>, <span class="fl">0.</span>      , <span class="fl">4.971712</span>, <span class="fl">7.280658</span>, <span class="fl">4.79732</span> ,</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>       <span class="fl">2.084956</span>, <span class="fl">3.251514</span>, <span class="fl">1.9405</span>  , <span class="fl">1.566192</span>, <span class="fl">0.58894</span> , <span class="fl">5.219658</span>,</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>       <span class="fl">0.977976</span>, <span class="fl">3.124584</span>, <span class="fl">1.297564</span>, <span class="fl">1.433328</span>, <span class="fl">4.24337</span> , <span class="fl">0.880964</span>,</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>       <span class="fl">2.376566</span>, <span class="fl">3.763658</span>, <span class="fl">1.918426</span>, <span class="fl">3.74</span>    , <span class="fl">3.841726</span>, <span class="fl">4.69964</span> ,</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>       <span class="fl">4.386876</span>, <span class="fl">0.</span>      , <span class="fl">1.127432</span>, <span class="fl">1.845452</span>, <span class="fl">0.690314</span>, <span class="fl">4.185602</span>,</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>       <span class="fl">2.284732</span>, <span class="fl">7.237594</span>, <span class="fl">2.185148</span>, <span class="fl">2.799124</span>, <span class="fl">3.43218</span> , <span class="fl">0.63354</span> ,</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>       <span class="fl">1.142496</span>, <span class="fl">0.586</span>   , <span class="fl">2.372858</span>, <span class="fl">1.80032</span> , <span class="fl">3.329306</span>, <span class="fl">4.028804</span>,</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>       <span class="fl">3.474156</span>, <span class="fl">7.508752</span>, <span class="fl">2.032824</span>, <span class="fl">1.336556</span>, <span class="fl">1.906496</span>, <span class="fl">1.396046</span>,</span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>       <span class="fl">2.488104</span>, <span class="fl">4.759114</span>, <span class="fl">1.07853</span> , <span class="fl">3.19927</span> , <span class="fl">3.814252</span>, <span class="fl">4.275962</span>,</span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>       <span class="fl">2.817056</span>, <span class="fl">0.552198</span>, <span class="fl">3.27194</span> , <span class="fl">5.11525</span> , <span class="fl">2.064628</span>, <span class="fl">0.</span>      ,</span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>       <span class="fl">3.34101</span> , <span class="fl">6.177322</span>, <span class="fl">0.</span>      , <span class="fl">3.66415</span> , <span class="fl">2.352582</span>, <span class="fl">1.531696</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute x,y values for ECDFs</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>x_control, y_control <span class="op">=</span> ecdf(control)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>x_treated, y_treated <span class="op">=</span> ecdf(treated)</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the ECDFs</span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>plt.plot(x_control, y_control, marker<span class="op">=</span><span class="st">'.'</span>, linestyle<span class="op">=</span><span class="st">'none'</span>)</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>plt.plot(x_treated, y_treated, marker<span class="op">=</span><span class="st">'.'</span>, linestyle<span class="op">=</span><span class="st">'none'</span>)</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the margins</span></span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>plt.margins(<span class="fl">0.02</span>)</span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a legend</span></span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>plt.legend((<span class="st">'control'</span>, <span class="st">'treated'</span>), loc<span class="op">=</span><span class="st">'lower right'</span>)</span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Label axes and show plot</span></span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'millions of alive sperm per mL'</span>)</span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'ECDF'</span>)</span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2020-07-08-Statistical Thinking in Python (Part 2)_files/figure-html/cell-55-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>The ECDFs show a pretty clear difference between the treatment and control; treated bees have fewer alive sperm. Let’s now do a hypothesis test.</p>
</section>
<section id="bootstrap-hypothesis-test-on-bee-sperm-counts" class="level3">
<h3 class="anchored" data-anchor-id="bootstrap-hypothesis-test-on-bee-sperm-counts">Bootstrap hypothesis test on bee sperm counts</h3>
<p>We will test the following hypothesis: On average, male bees treated with neonicotinoid insecticide have the same number of active sperm per milliliter of semen than do untreated male bees. We will use the difference of means as the test statistic.</p>
<div class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the difference in mean sperm count: diff_means</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>diff_means <span class="op">=</span> np.mean(control) <span class="op">-</span> np.mean(treated)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute mean of pooled data: mean_count</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>mean_count <span class="op">=</span> np.mean(np.concatenate((control, treated)))</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate shifted data sets</span></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>control_shifted <span class="op">=</span> control <span class="op">-</span> np.mean(control) <span class="op">+</span> mean_count</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>treated_shifted <span class="op">=</span> treated <span class="op">-</span> np.mean(treated) <span class="op">+</span> mean_count</span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate bootstrap replicates</span></span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>bs_reps_control <span class="op">=</span> draw_bs_reps(control_shifted,</span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>                       np.mean, size<span class="op">=</span><span class="dv">10000</span>)</span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>bs_reps_treated <span class="op">=</span> draw_bs_reps(treated_shifted,</span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>                       np.mean, size<span class="op">=</span><span class="dv">10000</span>)</span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Get replicates of difference of means: bs_replicates</span></span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a>bs_replicates <span class="op">=</span> bs_reps_control <span class="op">-</span> bs_reps_treated</span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute and print p-value: p</span></span>
<span id="cb72-21"><a href="#cb72-21" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> np.<span class="bu">sum</span>(bs_replicates <span class="op">&gt;=</span> np.mean(control) <span class="op">-</span> np.mean(treated)) <span class="op">\</span></span>
<span id="cb72-22"><a href="#cb72-22" aria-hidden="true" tabindex="-1"></a>            <span class="op">/</span> <span class="bu">len</span>(bs_replicates)</span>
<span id="cb72-23"><a href="#cb72-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'p-value ='</span>, p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>p-value = 0.0</code></pre>
</div>
</div>
<p>The p-value is small, most likely less than 0.0001, since we never saw a bootstrap replicated with a difference of means at least as extreme as what was observed.</p>
</section>
</section>
</section>
<section id="a-case-study" class="level1">
<h1>a case study</h1>
<p>Every year for the past 40-plus years, Peter and Rosemary Grant have gone to the Galápagos island of Daphne Major and collected data on Darwin’s finches. Using skills in statistical inference, we will explorer the data, and witness first hand, through data, evolution in action.</p>
<section id="eda-of-beak-depths-of-darwins-finches" class="level3">
<h3 class="anchored" data-anchor-id="eda-of-beak-depths-of-darwins-finches">EDA of beak depths of Darwin’s finches</h3>
<p>For our first foray into the Darwin finch data, we will study how the beak depth (the distance, top to bottom, of a closed beak) of the finch species <em>Geospiza scandens</em> has changed over time. The Grants have noticed some changes of beak geometry depending on the types of seeds available on the island, and they also noticed that there was some interbreeding with another major species on Daphne Major, <em>Geospiza fortis</em>. These effects can lead to changes in the species over time.</p>
<p>We will look at the beak depth of <em>G. scandens</em> on Daphne Major in 1975 and in 2012. To start with, let’s plot all of the beak depth measurements in 1975 and 2012 in a bee swarm plot.</p>
<div class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>dfd <span class="op">=</span> pd.read_csv(<span class="st">"datasets/darwin_finch_data.csv"</span>)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>dfd.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="56">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>beak_depth</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>8.4</td>
      <td>1975</td>
    </tr>
    <tr>
      <th>1</th>
      <td>8.8</td>
      <td>1975</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8.4</td>
      <td>1975</td>
    </tr>
    <tr>
      <th>3</th>
      <td>8.0</td>
      <td>1975</td>
    </tr>
    <tr>
      <th>4</th>
      <td>7.9</td>
      <td>1975</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>dfd.tail()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="57">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>beak_depth</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>209</th>
      <td>9.3</td>
      <td>2012</td>
    </tr>
    <tr>
      <th>210</th>
      <td>9.8</td>
      <td>2012</td>
    </tr>
    <tr>
      <th>211</th>
      <td>8.9</td>
      <td>2012</td>
    </tr>
    <tr>
      <th>212</th>
      <td>9.8</td>
      <td>2012</td>
    </tr>
    <tr>
      <th>213</th>
      <td>9.1</td>
      <td>2012</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>dfd.dtypes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="58">
<pre><code>beak_depth    float64
year            int64
dtype: object</code></pre>
</div>
</div>
<div class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>dfd.describe().T</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="59">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>beak_depth</th>
      <td>214.0</td>
      <td>9.094252</td>
      <td>0.637941</td>
      <td>7.7</td>
      <td>8.6625</td>
      <td>9.075</td>
      <td>9.5</td>
      <td>11.0</td>
    </tr>
    <tr>
      <th>year</th>
      <td>214.0</td>
      <td>1996.957944</td>
      <td>18.216566</td>
      <td>1975.0</td>
      <td>1975.0000</td>
      <td>2012.000</td>
      <td>2012.0</td>
      <td>2012.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>dfd.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 214 entries, 0 to 213
Data columns (total 2 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   beak_depth  214 non-null    float64
 1   year        214 non-null    int64  
dtypes: float64(1), int64(1)
memory usage: 3.5 KB</code></pre>
</div>
</div>
<p>The units of beak depth are millimeters (mm).</p>
<div class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create bee swarm plot</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> sns.swarmplot(data<span class="op">=</span>dfd, x<span class="op">=</span><span class="st">"year"</span>, y<span class="op">=</span><span class="st">"beak_depth"</span>)</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Label the axes</span></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.xlabel(<span class="st">'year'</span>)</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.ylabel(<span class="st">'beak depth (mm)'</span>)</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the plot</span></span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2020-07-08-Statistical Thinking in Python (Part 2)_files/figure-html/cell-62-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>It is kind of hard to see if there is a clear difference between the 1975 and 2012 data set. Eyeballing it, it appears as though the mean of the 2012 data set might be slightly higher, and it might have a bigger variance.</p>
</section>
<section id="ecdfs-of-beak-depths" class="level3">
<h3 class="anchored" data-anchor-id="ecdfs-of-beak-depths">ECDFs of beak depths</h3>
<p>While bee swarm plots are useful, we found that ECDFs are often even better when doing EDA. Plot the ECDFs for the 1975 and 2012 beak depth measurements on the same plot.</p>
<div class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>bd_1975 <span class="op">=</span> dfd.beak_depth[dfd.year<span class="op">==</span><span class="dv">1975</span>]</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>bd_2012 <span class="op">=</span> dfd.beak_depth[dfd.year<span class="op">==</span><span class="dv">2012</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute ECDFs</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>x_1975, y_1975 <span class="op">=</span> ecdf(bd_1975)</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>x_2012, y_2012 <span class="op">=</span> ecdf(bd_2012)</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the ECDFs</span></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.plot(x_1975, y_1975, marker<span class="op">=</span><span class="st">'.'</span>, linestyle<span class="op">=</span><span class="st">'none'</span>)</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.plot(x_2012, y_2012, marker<span class="op">=</span><span class="st">'.'</span>, linestyle<span class="op">=</span><span class="st">'none'</span>)</span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Set margins</span></span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a>plt.margins(<span class="fl">.02</span>)</span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Add axis labels and legend</span></span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.xlabel(<span class="st">'beak depth (mm)'</span>)</span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.ylabel(<span class="st">'ECDF'</span>)</span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.legend((<span class="st">'1975'</span>, <span class="st">'2012'</span>), loc<span class="op">=</span><span class="st">'lower right'</span>)</span>
<span id="cb83-16"><a href="#cb83-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-17"><a href="#cb83-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the plot</span></span>
<span id="cb83-18"><a href="#cb83-18" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2020-07-08-Statistical Thinking in Python (Part 2)_files/figure-html/cell-64-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>The differences are much clearer in the ECDF. The mean is larger in the 2012 data, and the variance does appear larger as well.</p>
</section>
<section id="parameter-estimates-of-beak-depths" class="level3">
<h3 class="anchored" data-anchor-id="parameter-estimates-of-beak-depths">Parameter estimates of beak depths</h3>
<p>Let’s estimate the difference of the mean beak depth of the <em>G. scandens</em> samples from 1975 and 2012 and report a 95% confidence interval.</p>
<div class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the difference of the sample means: mean_diff</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>mean_diff <span class="op">=</span> np.mean(bd_2012) <span class="op">-</span> np.mean(bd_1975)</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Get bootstrap replicates of means</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>bs_replicates_1975 <span class="op">=</span> draw_bs_reps(bd_1975, np.mean, size<span class="op">=</span><span class="dv">10000</span>)</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>bs_replicates_2012 <span class="op">=</span> draw_bs_reps(bd_2012, np.mean, size<span class="op">=</span><span class="dv">10000</span>)</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute samples of difference of means: bs_diff_replicates</span></span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>bs_diff_replicates <span class="op">=</span> bs_replicates_2012 <span class="op">-</span> bs_replicates_1975</span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute 95% confidence interval: conf_int</span></span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a>conf_int <span class="op">=</span> np.percentile(bs_diff_replicates, [<span class="fl">2.5</span>, <span class="fl">97.5</span>])</span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the results</span></span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'difference of means ='</span>, mean_diff, <span class="st">'mm'</span>)</span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'95</span><span class="sc">% c</span><span class="st">onfidence interval ='</span>, conf_int, <span class="st">'mm'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>difference of means = 0.22622047244094645 mm
95% confidence interval = [0.05967226 0.38944932] mm</code></pre>
</div>
</div>
</section>
<section id="hypothesis-test-are-beaks-deeper-in-2012" class="level3">
<h3 class="anchored" data-anchor-id="hypothesis-test-are-beaks-deeper-in-2012">Hypothesis test: Are beaks deeper in 2012?</h3>
<p>Our plot of the ECDF and determination of the confidence interval make it pretty clear that the beaks of <em>G. scandens</em> on Daphne Major have gotten deeper. But is it possible that this effect is just due to random chance? In other words, what is the probability that we would get the observed difference in mean beak depth if the means were the same?</p>
<div class="callout-warning callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>The hypothesis we are testing is not that the beak depths come from the same distribution. For that we could use a permutation test. The hypothesis is that the means are equal. To perform this hypothesis test, we need to shift the two data sets so that they have the same mean and then use bootstrap sampling to compute the difference of means.</p>
</div>
</div>
<div class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute mean of combined data set: combined_mean</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>combined_mean <span class="op">=</span> np.mean(np.concatenate((bd_1975, bd_2012)))</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Shift the samples</span></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>bd_1975_shifted <span class="op">=</span> bd_1975 <span class="op">-</span> np.mean(bd_1975) <span class="op">+</span> combined_mean</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>bd_2012_shifted <span class="op">=</span> bd_2012 <span class="op">-</span> np.mean(bd_2012) <span class="op">+</span> combined_mean</span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Get bootstrap replicates of shifted data sets</span></span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>bs_replicates_1975 <span class="op">=</span> draw_bs_reps(bd_1975_shifted, np.mean, size<span class="op">=</span><span class="dv">10000</span>)</span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>bs_replicates_2012 <span class="op">=</span> draw_bs_reps(bd_2012_shifted, np.mean, size<span class="op">=</span><span class="dv">10000</span>)</span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute replicates of difference of means: bs_diff_replicates</span></span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a>bs_diff_replicates <span class="op">=</span> bs_replicates_2012 <span class="op">-</span> bs_replicates_1975</span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the p-value</span></span>
<span id="cb86-16"><a href="#cb86-16" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> np.<span class="bu">sum</span>(bs_diff_replicates <span class="op">&gt;=</span> mean_diff) <span class="op">/</span> <span class="bu">len</span>(bs_diff_replicates)</span>
<span id="cb86-17"><a href="#cb86-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-18"><a href="#cb86-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Print p-value</span></span>
<span id="cb86-19"><a href="#cb86-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'p ='</span>, p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>p = 0.0046</code></pre>
</div>
</div>
<p>We get a p-value of 0.0038, which suggests that there is a statistically significant difference. But remember: it is very important to know how different they are! We got a difference of 0.2 mm between the means. We should combine this with the statistical significance. Changing by 0.2 mm in 37 years is substantial by evolutionary standards. If it kept changing at that rate, the beak depth would double in only 400 years.</p>
</section>
<section id="variation-in-beak-shapes" class="level2">
<h2 class="anchored" data-anchor-id="variation-in-beak-shapes">Variation in beak shapes</h2>
<section id="eda-of-beak-length-and-depth" class="level3">
<h3 class="anchored" data-anchor-id="eda-of-beak-length-and-depth">EDA of beak length and depth</h3>
<div class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>bl_1975 <span class="op">=</span> np.array([<span class="fl">13.9</span> , <span class="fl">14.</span>  , <span class="fl">12.9</span> , <span class="fl">13.5</span> , <span class="fl">12.9</span> , <span class="fl">14.6</span> , <span class="fl">13.</span>  , <span class="fl">14.2</span> , <span class="fl">14.</span>  ,</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>       <span class="fl">14.2</span> , <span class="fl">13.1</span> , <span class="fl">15.1</span> , <span class="fl">13.5</span> , <span class="fl">14.4</span> , <span class="fl">14.9</span> , <span class="fl">12.9</span> , <span class="fl">13.</span>  , <span class="fl">14.9</span> ,</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>       <span class="fl">14.</span>  , <span class="fl">13.8</span> , <span class="fl">13.</span>  , <span class="fl">14.75</span>, <span class="fl">13.7</span> , <span class="fl">13.8</span> , <span class="fl">14.</span>  , <span class="fl">14.6</span> , <span class="fl">15.2</span> ,</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>       <span class="fl">13.5</span> , <span class="fl">15.1</span> , <span class="fl">15.</span>  , <span class="fl">12.8</span> , <span class="fl">14.9</span> , <span class="fl">15.3</span> , <span class="fl">13.4</span> , <span class="fl">14.2</span> , <span class="fl">15.1</span> ,</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>       <span class="fl">15.1</span> , <span class="fl">14.</span>  , <span class="fl">13.6</span> , <span class="fl">14.</span>  , <span class="fl">14.</span>  , <span class="fl">13.9</span> , <span class="fl">14.</span>  , <span class="fl">14.9</span> , <span class="fl">15.6</span> ,</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>       <span class="fl">13.8</span> , <span class="fl">14.4</span> , <span class="fl">12.8</span> , <span class="fl">14.2</span> , <span class="fl">13.4</span> , <span class="fl">14.</span>  , <span class="fl">14.8</span> , <span class="fl">14.2</span> , <span class="fl">13.5</span> ,</span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>       <span class="fl">13.4</span> , <span class="fl">14.6</span> , <span class="fl">13.5</span> , <span class="fl">13.7</span> , <span class="fl">13.9</span> , <span class="fl">13.1</span> , <span class="fl">13.4</span> , <span class="fl">13.8</span> , <span class="fl">13.6</span> ,</span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>       <span class="fl">14.</span>  , <span class="fl">13.5</span> , <span class="fl">12.8</span> , <span class="fl">14.</span>  , <span class="fl">13.4</span> , <span class="fl">14.9</span> , <span class="fl">15.54</span>, <span class="fl">14.63</span>, <span class="fl">14.73</span>,</span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>       <span class="fl">15.73</span>, <span class="fl">14.83</span>, <span class="fl">15.94</span>, <span class="fl">15.14</span>, <span class="fl">14.23</span>, <span class="fl">14.15</span>, <span class="fl">14.35</span>, <span class="fl">14.95</span>, <span class="fl">13.95</span>,</span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a>       <span class="fl">14.05</span>, <span class="fl">14.55</span>, <span class="fl">14.05</span>, <span class="fl">14.45</span>, <span class="fl">15.05</span>, <span class="fl">13.25</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>bl_2012 <span class="op">=</span> np.array([<span class="fl">14.3</span> , <span class="fl">12.5</span> , <span class="fl">13.7</span> , <span class="fl">13.8</span> , <span class="fl">12.</span>  , <span class="fl">13.</span>  , <span class="fl">13.</span>  , <span class="fl">13.6</span> , <span class="fl">12.8</span> ,</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>       <span class="fl">13.6</span> , <span class="fl">12.95</span>, <span class="fl">13.1</span> , <span class="fl">13.4</span> , <span class="fl">13.9</span> , <span class="fl">12.3</span> , <span class="fl">14.</span>  , <span class="fl">12.5</span> , <span class="fl">12.3</span> ,</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>       <span class="fl">13.9</span> , <span class="fl">13.1</span> , <span class="fl">12.5</span> , <span class="fl">13.9</span> , <span class="fl">13.7</span> , <span class="fl">12.</span>  , <span class="fl">14.4</span> , <span class="fl">13.5</span> , <span class="fl">13.8</span> ,</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>       <span class="fl">13.</span>  , <span class="fl">14.9</span> , <span class="fl">12.5</span> , <span class="fl">12.3</span> , <span class="fl">12.8</span> , <span class="fl">13.4</span> , <span class="fl">13.8</span> , <span class="fl">13.5</span> , <span class="fl">13.5</span> ,</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>       <span class="fl">13.4</span> , <span class="fl">12.3</span> , <span class="fl">14.35</span>, <span class="fl">13.2</span> , <span class="fl">13.8</span> , <span class="fl">14.6</span> , <span class="fl">14.3</span> , <span class="fl">13.8</span> , <span class="fl">13.6</span> ,</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>       <span class="fl">12.9</span> , <span class="fl">13.</span>  , <span class="fl">13.5</span> , <span class="fl">13.2</span> , <span class="fl">13.7</span> , <span class="fl">13.1</span> , <span class="fl">13.2</span> , <span class="fl">12.6</span> , <span class="fl">13.</span>  ,</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>       <span class="fl">13.9</span> , <span class="fl">13.2</span> , <span class="fl">15.</span>  , <span class="fl">13.37</span>, <span class="fl">11.4</span> , <span class="fl">13.8</span> , <span class="fl">13.</span>  , <span class="fl">13.</span>  , <span class="fl">13.1</span> ,</span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>       <span class="fl">12.8</span> , <span class="fl">13.3</span> , <span class="fl">13.5</span> , <span class="fl">12.4</span> , <span class="fl">13.1</span> , <span class="fl">14.</span>  , <span class="fl">13.5</span> , <span class="fl">11.8</span> , <span class="fl">13.7</span> ,</span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>       <span class="fl">13.2</span> , <span class="fl">12.2</span> , <span class="fl">13.</span>  , <span class="fl">13.1</span> , <span class="fl">14.7</span> , <span class="fl">13.7</span> , <span class="fl">13.5</span> , <span class="fl">13.3</span> , <span class="fl">14.1</span> ,</span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>       <span class="fl">12.5</span> , <span class="fl">13.7</span> , <span class="fl">14.6</span> , <span class="fl">14.1</span> , <span class="fl">12.9</span> , <span class="fl">13.9</span> , <span class="fl">13.4</span> , <span class="fl">13.</span>  , <span class="fl">12.7</span> ,</span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>       <span class="fl">12.1</span> , <span class="fl">14.</span>  , <span class="fl">14.9</span> , <span class="fl">13.9</span> , <span class="fl">12.9</span> , <span class="fl">14.6</span> , <span class="fl">14.</span>  , <span class="fl">13.</span>  , <span class="fl">12.7</span> ,</span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a>       <span class="fl">14.</span>  , <span class="fl">14.1</span> , <span class="fl">14.1</span> , <span class="fl">13.</span>  , <span class="fl">13.5</span> , <span class="fl">13.4</span> , <span class="fl">13.9</span> , <span class="fl">13.1</span> , <span class="fl">12.9</span> ,</span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a>       <span class="fl">14.</span>  , <span class="fl">14.</span>  , <span class="fl">14.1</span> , <span class="fl">14.7</span> , <span class="fl">13.4</span> , <span class="fl">13.8</span> , <span class="fl">13.4</span> , <span class="fl">13.8</span> , <span class="fl">12.4</span> ,</span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a>       <span class="fl">14.1</span> , <span class="fl">12.9</span> , <span class="fl">13.9</span> , <span class="fl">14.3</span> , <span class="fl">13.2</span> , <span class="fl">14.2</span> , <span class="fl">13.</span>  , <span class="fl">14.6</span> , <span class="fl">13.1</span> ,</span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a>       <span class="fl">15.2</span> ])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The beak length data are stored as <code>bl_1975</code> and <code>bl_2012</code>, again with units of millimeters (mm). We still have the beak depth data stored in <code>bd_1975</code> and <code>bd_2012</code>. We will make scatter plots of beak depth (y-axis) versus beak length (x-axis) for the 1975 and 2012 specimens.</p>
<div class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make scatter plot of 1975 data</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.plot(bl_1975, bd_1975, marker<span class="op">=</span><span class="st">'.'</span>,</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>             linestyle<span class="op">=</span><span class="st">'None'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>, color<span class="op">=</span><span class="st">"blue"</span>)</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Make scatter plot of 2012 data</span></span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.plot(bl_2012, bd_2012, marker<span class="op">=</span><span class="st">'.'</span>,</span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>            linestyle<span class="op">=</span><span class="st">'None'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>, color<span class="op">=</span><span class="st">"red"</span>)</span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Label axes and make legend</span></span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.xlabel(<span class="st">'beak length (mm)'</span>)</span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.ylabel(<span class="st">'beak depth (mm)'</span>)</span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.legend((<span class="st">'1975'</span>, <span class="st">'2012'</span>), loc<span class="op">=</span><span class="st">'upper left'</span>)</span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the plot</span></span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2020-07-08-Statistical Thinking in Python (Part 2)_files/figure-html/cell-69-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>In looking at the plot, we see that beaks got deeper (the red points are higher up in the y-direction), but not really longer. If anything, they got a bit shorter, since the red dots are to the left of the blue dots. So, it does not look like the beaks kept the same shape; they became shorter and deeper.</p>
</section>
<section id="linear-regressions" class="level3">
<h3 class="anchored" data-anchor-id="linear-regressions">Linear regressions</h3>
<p>We perform a linear regression for both the 1975 and 2012 data. Then, perform pairs bootstrap estimates for the regression parameters. Report 95% confidence intervals on the slope and intercept of the regression line.</p>
<div class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the linear regressions</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>slope_1975, intercept_1975 <span class="op">=</span> np.polyfit(bl_1975, bd_1975.values, deg<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>slope_2012, intercept_2012 <span class="op">=</span> np.polyfit(bl_2012, bd_2012.values, deg<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform pairs bootstrap for the linear regressions</span></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>bs_slope_reps_1975, bs_intercept_reps_1975 <span class="op">=</span> <span class="op">\</span></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>        draw_bs_pairs_linreg(bl_1975, bd_1975.values, size<span class="op">=</span><span class="dv">1000</span>)</span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>bs_slope_reps_2012, bs_intercept_reps_2012 <span class="op">=</span> <span class="op">\</span></span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>        draw_bs_pairs_linreg(bl_2012, bd_2012.values, size<span class="op">=</span><span class="dv">1000</span>)</span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute confidence intervals of slopes</span></span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a>slope_conf_int_1975 <span class="op">=</span> np.percentile(bs_slope_reps_1975, [<span class="fl">2.5</span>, <span class="fl">97.5</span>])</span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a>slope_conf_int_2012 <span class="op">=</span> np.percentile(bs_slope_reps_2012, [<span class="fl">2.5</span>, <span class="fl">97.5</span>])</span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a>intercept_conf_int_1975 <span class="op">=</span> np.percentile(bs_intercept_reps_1975, [<span class="fl">2.5</span>, <span class="fl">97.5</span>])</span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a>intercept_conf_int_2012 <span class="op">=</span> np.percentile(bs_intercept_reps_2012, [<span class="fl">2.5</span>, <span class="fl">97.5</span>])</span>
<span id="cb91-17"><a href="#cb91-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-18"><a href="#cb91-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-19"><a href="#cb91-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the results</span></span>
<span id="cb91-20"><a href="#cb91-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'1975: slope ='</span>, slope_1975,</span>
<span id="cb91-21"><a href="#cb91-21" aria-hidden="true" tabindex="-1"></a>      <span class="st">'conf int ='</span>, slope_conf_int_1975)</span>
<span id="cb91-22"><a href="#cb91-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'1975: intercept ='</span>, intercept_1975,</span>
<span id="cb91-23"><a href="#cb91-23" aria-hidden="true" tabindex="-1"></a>      <span class="st">'conf int ='</span>, intercept_conf_int_1975)</span>
<span id="cb91-24"><a href="#cb91-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'2012: slope ='</span>, slope_2012,</span>
<span id="cb91-25"><a href="#cb91-25" aria-hidden="true" tabindex="-1"></a>      <span class="st">'conf int ='</span>, slope_conf_int_2012)</span>
<span id="cb91-26"><a href="#cb91-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'2012: intercept ='</span>, intercept_2012,</span>
<span id="cb91-27"><a href="#cb91-27" aria-hidden="true" tabindex="-1"></a>      <span class="st">'conf int ='</span>, intercept_conf_int_2012)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1975: slope = 0.46520516916059357 conf int = [0.3254032  0.58811989]
1975: intercept = 2.3908752365842285 conf int = [0.67000784 4.40072329]
2012: slope = 0.4626303588353126 conf int = [0.33989291 0.60535488]
2012: intercept = 2.9772474982360184 conf int = [1.03792858 4.62029259]</code></pre>
</div>
</div>
<p>It looks like they have the same slope, but different intercepts.</p>
</section>
<section id="displaying-the-linear-regression-results" class="level3">
<h3 class="anchored" data-anchor-id="displaying-the-linear-regression-results">Displaying the linear regression results</h3>
<div class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make scatter plot of 1975 data</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.plot(bl_1975, bd_1975, marker<span class="op">=</span><span class="st">'.'</span>,</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>             linestyle<span class="op">=</span><span class="st">'none'</span>, color<span class="op">=</span><span class="st">'blue'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Make scatter plot of 2012 data</span></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.plot(bl_2012, bd_2012, marker<span class="op">=</span><span class="st">'.'</span>,</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>             linestyle<span class="op">=</span><span class="st">'none'</span>, color<span class="op">=</span><span class="st">'red'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Label axes and make legend</span></span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.xlabel(<span class="st">'beak length (mm)'</span>)</span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.ylabel(<span class="st">'beak depth (mm)'</span>)</span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.legend((<span class="st">'1975'</span>, <span class="st">'2012'</span>), loc<span class="op">=</span><span class="st">'upper left'</span>)</span>
<span id="cb93-13"><a href="#cb93-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-14"><a href="#cb93-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate x-values for bootstrap lines: x</span></span>
<span id="cb93-15"><a href="#cb93-15" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.array([<span class="dv">10</span>, <span class="dv">17</span>])</span>
<span id="cb93-16"><a href="#cb93-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-17"><a href="#cb93-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the bootstrap lines</span></span>
<span id="cb93-18"><a href="#cb93-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">100</span>):</span>
<span id="cb93-19"><a href="#cb93-19" aria-hidden="true" tabindex="-1"></a>    plt.plot(x, x<span class="op">*</span> bs_slope_reps_1975[i] <span class="op">+</span> bs_intercept_reps_1975[i],</span>
<span id="cb93-20"><a href="#cb93-20" aria-hidden="true" tabindex="-1"></a>             linewidth<span class="op">=</span><span class="fl">0.5</span>, alpha<span class="op">=</span><span class="fl">0.2</span>, color<span class="op">=</span><span class="st">"blue"</span>)</span>
<span id="cb93-21"><a href="#cb93-21" aria-hidden="true" tabindex="-1"></a>    plt.plot(x, x<span class="op">*</span>bs_slope_reps_2012[i] <span class="op">+</span> bs_intercept_reps_2012[i],</span>
<span id="cb93-22"><a href="#cb93-22" aria-hidden="true" tabindex="-1"></a>             linewidth<span class="op">=</span><span class="fl">0.5</span>, alpha<span class="op">=</span><span class="fl">0.2</span>, color<span class="op">=</span><span class="st">"red"</span>)</span>
<span id="cb93-23"><a href="#cb93-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-24"><a href="#cb93-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Draw the plot again</span></span>
<span id="cb93-25"><a href="#cb93-25" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2020-07-08-Statistical Thinking in Python (Part 2)_files/figure-html/cell-71-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="beak-length-to-depth-ratio" class="level3">
<h3 class="anchored" data-anchor-id="beak-length-to-depth-ratio">Beak length to depth ratio</h3>
<p>The linear regressions showed interesting information about the beak geometry. The slope was the same in 1975 and 2012, suggesting that for every millimeter gained in beak length, the birds gained about half a millimeter in depth in both years. However, if we are interested in the shape of the beak, we want to compare the ratio of beak length to beak depth. Let’s make that comparison.</p>
<div class="cell" data-execution_count="71">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute length-to-depth ratios</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>ratio_1975 <span class="op">=</span> bl_1975<span class="op">/</span>bd_1975</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>ratio_2012 <span class="op">=</span> bl_2012<span class="op">/</span>bd_2012</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute means</span></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>mean_ratio_1975 <span class="op">=</span> np.mean(ratio_1975)</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>mean_ratio_2012 <span class="op">=</span> np.mean(ratio_2012)</span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate bootstrap replicates of the means</span></span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a>bs_replicates_1975 <span class="op">=</span> draw_bs_reps(ratio_1975, np.mean, size<span class="op">=</span><span class="dv">10000</span>)</span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a>bs_replicates_2012 <span class="op">=</span> draw_bs_reps(ratio_2012, np.mean, size<span class="op">=</span><span class="dv">10000</span>)</span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the 99% confidence intervals</span></span>
<span id="cb94-14"><a href="#cb94-14" aria-hidden="true" tabindex="-1"></a>conf_int_1975 <span class="op">=</span> np.percentile(bs_replicates_1975, [<span class="fl">.5</span>, <span class="fl">99.5</span>])</span>
<span id="cb94-15"><a href="#cb94-15" aria-hidden="true" tabindex="-1"></a>conf_int_2012 <span class="op">=</span> np.percentile(bs_replicates_2012, [<span class="fl">.5</span>, <span class="fl">99.5</span>])</span>
<span id="cb94-16"><a href="#cb94-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-17"><a href="#cb94-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the results</span></span>
<span id="cb94-18"><a href="#cb94-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'1975: mean ratio ='</span>, mean_ratio_1975,</span>
<span id="cb94-19"><a href="#cb94-19" aria-hidden="true" tabindex="-1"></a>      <span class="st">'conf int ='</span>, conf_int_1975)</span>
<span id="cb94-20"><a href="#cb94-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'2012: mean ratio ='</span>, mean_ratio_2012,</span>
<span id="cb94-21"><a href="#cb94-21" aria-hidden="true" tabindex="-1"></a>      <span class="st">'conf int ='</span>, conf_int_2012)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1975: mean ratio = 1.5788823771858533 conf int = [1.55672661 1.60112763]
2012: mean ratio = 1.4658342276847767 conf int = [1.44471693 1.48753163]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="75">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> sns.pointplot([np.median(conf_int_1975), np.median(conf_int_2012)], [<span class="dv">1975</span>, <span class="dv">2012</span>])</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2020-07-08-Statistical Thinking in Python (Part 2)_files/figure-html/cell-73-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="calculation-of-heritability" class="level2">
<h2 class="anchored" data-anchor-id="calculation-of-heritability">Calculation of heritability</h2>
<blockquote class="blockquote">
<h3 id="heredity" class="anchored">Heredity</h3>
<ul>
<li>The tendency for parental traits to be inherited by offspring</li>
</ul>
</blockquote>
<section id="eda-of-heritability" class="level3">
<h3 class="anchored" data-anchor-id="eda-of-heritability">EDA of heritability</h3>
<p>The array <code>bd_parent_scandens</code> contains the average beak depth (in mm) of two parents of the species <em>G. scandens</em></p>
<div class="cell" data-execution_count="76">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>bd_parent_scandens <span class="op">=</span> np.array([ <span class="fl">8.3318</span>,  <span class="fl">8.4035</span>,  <span class="fl">8.5317</span>,  <span class="fl">8.7202</span>,  <span class="fl">8.7089</span>,  <span class="fl">8.7541</span>,  <span class="fl">8.773</span> ,</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>        <span class="fl">8.8107</span>,  <span class="fl">8.7919</span>,  <span class="fl">8.8069</span>,  <span class="fl">8.6523</span>,  <span class="fl">8.6146</span>,  <span class="fl">8.6938</span>,  <span class="fl">8.7127</span>,</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>        <span class="fl">8.7466</span>,  <span class="fl">8.7504</span>,  <span class="fl">8.7805</span>,  <span class="fl">8.7428</span>,  <span class="fl">8.7164</span>,  <span class="fl">8.8032</span>,  <span class="fl">8.8258</span>,</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>        <span class="fl">8.856</span> ,  <span class="fl">8.9012</span>,  <span class="fl">8.9125</span>,  <span class="fl">8.8635</span>,  <span class="fl">8.8258</span>,  <span class="fl">8.8522</span>,  <span class="fl">8.8974</span>,</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>        <span class="fl">8.9427</span>,  <span class="fl">8.9879</span>,  <span class="fl">8.9615</span>,  <span class="fl">8.9238</span>,  <span class="fl">8.9351</span>,  <span class="fl">9.0143</span>,  <span class="fl">9.0558</span>,</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.0596</span>,  <span class="fl">8.9917</span>,  <span class="fl">8.905</span> ,  <span class="fl">8.9314</span>,  <span class="fl">8.9465</span>,  <span class="fl">8.9879</span>,  <span class="fl">8.9804</span>,</span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.0219</span>,  <span class="fl">9.052</span> ,  <span class="fl">9.0407</span>,  <span class="fl">9.0407</span>,  <span class="fl">8.9955</span>,  <span class="fl">8.9992</span>,  <span class="fl">8.9992</span>,</span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.0747</span>,  <span class="fl">9.0747</span>,  <span class="fl">9.5385</span>,  <span class="fl">9.4781</span>,  <span class="fl">9.4517</span>,  <span class="fl">9.3537</span>,  <span class="fl">9.2707</span>,</span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.1199</span>,  <span class="fl">9.1689</span>,  <span class="fl">9.1425</span>,  <span class="fl">9.135</span> ,  <span class="fl">9.1011</span>,  <span class="fl">9.1727</span>,  <span class="fl">9.2217</span>,</span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.2255</span>,  <span class="fl">9.2821</span>,  <span class="fl">9.3235</span>,  <span class="fl">9.3198</span>,  <span class="fl">9.3198</span>,  <span class="fl">9.3198</span>,  <span class="fl">9.3273</span>,</span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.3725</span>,  <span class="fl">9.3989</span>,  <span class="fl">9.4253</span>,  <span class="fl">9.4593</span>,  <span class="fl">9.4442</span>,  <span class="fl">9.4291</span>,  <span class="fl">9.2632</span>,</span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.2293</span>,  <span class="fl">9.1878</span>,  <span class="fl">9.1425</span>,  <span class="fl">9.1275</span>,  <span class="fl">9.1802</span>,  <span class="fl">9.1765</span>,  <span class="fl">9.2481</span>,</span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.2481</span>,  <span class="fl">9.1991</span>,  <span class="fl">9.1689</span>,  <span class="fl">9.1765</span>,  <span class="fl">9.2406</span>,  <span class="fl">9.3198</span>,  <span class="fl">9.3235</span>,</span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.1991</span>,  <span class="fl">9.2971</span>,  <span class="fl">9.2443</span>,  <span class="fl">9.316</span> ,  <span class="fl">9.2934</span>,  <span class="fl">9.3914</span>,  <span class="fl">9.3989</span>,</span>
<span id="cb97-15"><a href="#cb97-15" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.5121</span>,  <span class="fl">9.6176</span>,  <span class="fl">9.5535</span>,  <span class="fl">9.4668</span>,  <span class="fl">9.3725</span>,  <span class="fl">9.3348</span>,  <span class="fl">9.3763</span>,</span>
<span id="cb97-16"><a href="#cb97-16" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.3839</span>,  <span class="fl">9.4216</span>,  <span class="fl">9.4065</span>,  <span class="fl">9.3348</span>,  <span class="fl">9.4442</span>,  <span class="fl">9.4367</span>,  <span class="fl">9.5083</span>,</span>
<span id="cb97-17"><a href="#cb97-17" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.448</span> ,  <span class="fl">9.4781</span>,  <span class="fl">9.595</span> ,  <span class="fl">9.6101</span>,  <span class="fl">9.5686</span>,  <span class="fl">9.6365</span>,  <span class="fl">9.7119</span>,</span>
<span id="cb97-18"><a href="#cb97-18" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.8213</span>,  <span class="fl">9.825</span> ,  <span class="fl">9.7609</span>,  <span class="fl">9.6516</span>,  <span class="fl">9.5988</span>,  <span class="fl">9.546</span> ,  <span class="fl">9.6516</span>,</span>
<span id="cb97-19"><a href="#cb97-19" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.7572</span>,  <span class="fl">9.8854</span>, <span class="fl">10.0023</span>,  <span class="fl">9.3914</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The array <code>bd_offspring_scandens</code> contains the average beak depth of the offspring of the respective parents.</p>
<div class="cell" data-execution_count="77">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>bd_offspring_scandens <span class="op">=</span> np.array([ <span class="fl">8.419</span> ,  <span class="fl">9.2468</span>,  <span class="fl">8.1532</span>,  <span class="fl">8.0089</span>,  <span class="fl">8.2215</span>,  <span class="fl">8.3734</span>,  <span class="fl">8.5025</span>,</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>        <span class="fl">8.6392</span>,  <span class="fl">8.7684</span>,  <span class="fl">8.8139</span>,  <span class="fl">8.7911</span>,  <span class="fl">8.9051</span>,  <span class="fl">8.9203</span>,  <span class="fl">8.8747</span>,</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>        <span class="fl">8.943</span> ,  <span class="fl">9.0038</span>,  <span class="fl">8.981</span> ,  <span class="fl">9.0949</span>,  <span class="fl">9.2696</span>,  <span class="fl">9.1633</span>,  <span class="fl">9.1785</span>,</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.1937</span>,  <span class="fl">9.2772</span>,  <span class="fl">9.0722</span>,  <span class="fl">8.9658</span>,  <span class="fl">8.9658</span>,  <span class="fl">8.5025</span>,  <span class="fl">8.4949</span>,</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>        <span class="fl">8.4949</span>,  <span class="fl">8.5633</span>,  <span class="fl">8.6013</span>,  <span class="fl">8.6468</span>,  <span class="fl">8.1532</span>,  <span class="fl">8.3734</span>,  <span class="fl">8.662</span> ,</span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>        <span class="fl">8.6924</span>,  <span class="fl">8.7456</span>,  <span class="fl">8.8367</span>,  <span class="fl">8.8595</span>,  <span class="fl">8.9658</span>,  <span class="fl">8.9582</span>,  <span class="fl">8.8671</span>,</span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>        <span class="fl">8.8671</span>,  <span class="fl">8.943</span> ,  <span class="fl">9.0646</span>,  <span class="fl">9.1405</span>,  <span class="fl">9.2089</span>,  <span class="fl">9.2848</span>,  <span class="fl">9.3759</span>,</span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.4899</span>,  <span class="fl">9.4519</span>,  <span class="fl">8.1228</span>,  <span class="fl">8.2595</span>,  <span class="fl">8.3127</span>,  <span class="fl">8.4949</span>,  <span class="fl">8.6013</span>,</span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a>        <span class="fl">8.4646</span>,  <span class="fl">8.5329</span>,  <span class="fl">8.7532</span>,  <span class="fl">8.8823</span>,  <span class="fl">9.0342</span>,  <span class="fl">8.6392</span>,  <span class="fl">8.6772</span>,</span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a>        <span class="fl">8.6316</span>,  <span class="fl">8.7532</span>,  <span class="fl">8.8291</span>,  <span class="fl">8.8975</span>,  <span class="fl">8.9734</span>,  <span class="fl">9.0494</span>,  <span class="fl">9.1253</span>,</span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.1253</span>,  <span class="fl">9.1253</span>,  <span class="fl">9.1785</span>,  <span class="fl">9.2848</span>,  <span class="fl">9.4595</span>,  <span class="fl">9.3608</span>,  <span class="fl">9.2089</span>,</span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.2544</span>,  <span class="fl">9.3684</span>,  <span class="fl">9.3684</span>,  <span class="fl">9.2316</span>,  <span class="fl">9.1709</span>,  <span class="fl">9.2316</span>,  <span class="fl">9.0342</span>,</span>
<span id="cb98-13"><a href="#cb98-13" aria-hidden="true" tabindex="-1"></a>        <span class="fl">8.8899</span>,  <span class="fl">8.8291</span>,  <span class="fl">8.981</span> ,  <span class="fl">8.8975</span>, <span class="fl">10.4089</span>, <span class="fl">10.1886</span>,  <span class="fl">9.7633</span>,</span>
<span id="cb98-14"><a href="#cb98-14" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.7329</span>,  <span class="fl">9.6114</span>,  <span class="fl">9.5051</span>,  <span class="fl">9.5127</span>,  <span class="fl">9.3684</span>,  <span class="fl">9.6266</span>,  <span class="fl">9.5354</span>,</span>
<span id="cb98-15"><a href="#cb98-15" aria-hidden="true" tabindex="-1"></a>       <span class="fl">10.0215</span>, <span class="fl">10.0215</span>,  <span class="fl">9.6266</span>,  <span class="fl">9.6038</span>,  <span class="fl">9.4063</span>,  <span class="fl">9.2316</span>,  <span class="fl">9.338</span> ,</span>
<span id="cb98-16"><a href="#cb98-16" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.262</span> ,  <span class="fl">9.262</span> ,  <span class="fl">9.4063</span>,  <span class="fl">9.4367</span>,  <span class="fl">9.0342</span>,  <span class="fl">8.943</span> ,  <span class="fl">8.9203</span>,</span>
<span id="cb98-17"><a href="#cb98-17" aria-hidden="true" tabindex="-1"></a>        <span class="fl">8.7835</span>,  <span class="fl">8.7835</span>,  <span class="fl">9.057</span> ,  <span class="fl">8.9354</span>,  <span class="fl">8.8975</span>,  <span class="fl">8.8139</span>,  <span class="fl">8.8671</span>,</span>
<span id="cb98-18"><a href="#cb98-18" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.0873</span>,  <span class="fl">9.2848</span>,  <span class="fl">9.2392</span>,  <span class="fl">9.2924</span>,  <span class="fl">9.4063</span>,  <span class="fl">9.3152</span>,  <span class="fl">9.4899</span>,</span>
<span id="cb98-19"><a href="#cb98-19" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.5962</span>,  <span class="fl">9.6873</span>,  <span class="fl">9.5203</span>,  <span class="fl">9.6646</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The arrays <code>bd_parent_fortis</code> and <code>bd_offspring_fortis</code> contain the same information about measurements from <em>G. fortis</em> birds.</p>
<div class="cell" data-execution_count="78">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>bd_parent_fortis <span class="op">=</span> np.array([<span class="fl">10.1</span>  ,  <span class="fl">9.55</span> ,  <span class="fl">9.4</span>  , <span class="fl">10.25</span> , <span class="fl">10.125</span>,  <span class="fl">9.7</span>  ,  <span class="fl">9.05</span> ,  <span class="fl">7.4</span>  ,</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.</span>   ,  <span class="fl">8.65</span> ,  <span class="fl">9.625</span>,  <span class="fl">9.9</span>  ,  <span class="fl">9.55</span> ,  <span class="fl">9.05</span> ,  <span class="fl">8.35</span> , <span class="fl">10.1</span>  ,</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>       <span class="fl">10.1</span>  ,  <span class="fl">9.9</span>  , <span class="fl">10.225</span>, <span class="fl">10.</span>   , <span class="fl">10.55</span> , <span class="fl">10.45</span> ,  <span class="fl">9.2</span>  , <span class="fl">10.2</span>  ,</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>        <span class="fl">8.95</span> , <span class="fl">10.05</span> , <span class="fl">10.2</span>  ,  <span class="fl">9.5</span>  ,  <span class="fl">9.925</span>,  <span class="fl">9.95</span> , <span class="fl">10.05</span> ,  <span class="fl">8.75</span> ,</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.2</span>  , <span class="fl">10.15</span> ,  <span class="fl">9.8</span>  , <span class="fl">10.7</span>  , <span class="fl">10.5</span>  ,  <span class="fl">9.55</span> , <span class="fl">10.55</span> , <span class="fl">10.475</span>,</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>        <span class="fl">8.65</span> , <span class="fl">10.7</span>  ,  <span class="fl">9.1</span>  ,  <span class="fl">9.4</span>  , <span class="fl">10.3</span>  ,  <span class="fl">9.65</span> ,  <span class="fl">9.5</span>  ,  <span class="fl">9.7</span>  ,</span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>       <span class="fl">10.525</span>,  <span class="fl">9.95</span> , <span class="fl">10.1</span>  ,  <span class="fl">9.75</span> , <span class="fl">10.05</span> ,  <span class="fl">9.9</span>  , <span class="fl">10.</span>   ,  <span class="fl">9.1</span>  ,</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.45</span> ,  <span class="fl">9.25</span> ,  <span class="fl">9.5</span>  , <span class="fl">10.</span>   , <span class="fl">10.525</span>,  <span class="fl">9.9</span>  , <span class="fl">10.4</span>  ,  <span class="fl">8.95</span> ,</span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.4</span>  , <span class="fl">10.95</span> , <span class="fl">10.75</span> , <span class="fl">10.1</span>  ,  <span class="fl">8.05</span> ,  <span class="fl">9.1</span>  ,  <span class="fl">9.55</span> ,  <span class="fl">9.05</span> ,</span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a>       <span class="fl">10.2</span>  , <span class="fl">10.</span>   , <span class="fl">10.55</span> , <span class="fl">10.75</span> ,  <span class="fl">8.175</span>,  <span class="fl">9.7</span>  ,  <span class="fl">8.8</span>  , <span class="fl">10.75</span> ,</span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.3</span>  ,  <span class="fl">9.7</span>  ,  <span class="fl">9.6</span>  ,  <span class="fl">9.75</span> ,  <span class="fl">9.6</span>  , <span class="fl">10.45</span> , <span class="fl">11.</span>   , <span class="fl">10.85</span> ,</span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a>       <span class="fl">10.15</span> , <span class="fl">10.35</span> , <span class="fl">10.4</span>  ,  <span class="fl">9.95</span> ,  <span class="fl">9.1</span>  , <span class="fl">10.1</span>  ,  <span class="fl">9.85</span> ,  <span class="fl">9.625</span>,</span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.475</span>,  <span class="fl">9.</span>   ,  <span class="fl">9.25</span> ,  <span class="fl">9.1</span>  ,  <span class="fl">9.25</span> ,  <span class="fl">9.2</span>  ,  <span class="fl">9.95</span> ,  <span class="fl">8.65</span> ,</span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.8</span>  ,  <span class="fl">9.4</span>  ,  <span class="fl">9.</span>   ,  <span class="fl">8.55</span> ,  <span class="fl">8.75</span> ,  <span class="fl">9.65</span> ,  <span class="fl">8.95</span> ,  <span class="fl">9.15</span> ,</span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.85</span> , <span class="fl">10.225</span>,  <span class="fl">9.825</span>, <span class="fl">10.</span>   ,  <span class="fl">9.425</span>, <span class="fl">10.4</span>  ,  <span class="fl">9.875</span>,  <span class="fl">8.95</span> ,</span>
<span id="cb99-16"><a href="#cb99-16" aria-hidden="true" tabindex="-1"></a>        <span class="fl">8.9</span>  ,  <span class="fl">9.35</span> , <span class="fl">10.425</span>, <span class="fl">10.</span>   , <span class="fl">10.175</span>,  <span class="fl">9.875</span>,  <span class="fl">9.875</span>,  <span class="fl">9.15</span> ,</span>
<span id="cb99-17"><a href="#cb99-17" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.45</span> ,  <span class="fl">9.025</span>,  <span class="fl">9.7</span>  ,  <span class="fl">9.7</span>  , <span class="fl">10.05</span> , <span class="fl">10.3</span>  ,  <span class="fl">9.6</span>  , <span class="fl">10.</span>   ,</span>
<span id="cb99-18"><a href="#cb99-18" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.8</span>  , <span class="fl">10.05</span> ,  <span class="fl">8.75</span> , <span class="fl">10.55</span> ,  <span class="fl">9.7</span>  , <span class="fl">10.</span>   ,  <span class="fl">9.85</span> ,  <span class="fl">9.8</span>  ,</span>
<span id="cb99-19"><a href="#cb99-19" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.175</span>,  <span class="fl">9.65</span> ,  <span class="fl">9.55</span> ,  <span class="fl">9.9</span>  , <span class="fl">11.55</span> , <span class="fl">11.3</span>  , <span class="fl">10.4</span>  , <span class="fl">10.8</span>  ,</span>
<span id="cb99-20"><a href="#cb99-20" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.8</span>  , <span class="fl">10.45</span> , <span class="fl">10.</span>   , <span class="fl">10.75</span> ,  <span class="fl">9.35</span> , <span class="fl">10.75</span> ,  <span class="fl">9.175</span>,  <span class="fl">9.65</span> ,</span>
<span id="cb99-21"><a href="#cb99-21" aria-hidden="true" tabindex="-1"></a>        <span class="fl">8.8</span>  , <span class="fl">10.55</span> , <span class="fl">10.675</span>,  <span class="fl">9.95</span> ,  <span class="fl">9.55</span> ,  <span class="fl">8.825</span>,  <span class="fl">9.7</span>  ,  <span class="fl">9.85</span> ,</span>
<span id="cb99-22"><a href="#cb99-22" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.8</span>  ,  <span class="fl">9.55</span> ,  <span class="fl">9.275</span>, <span class="fl">10.325</span>,  <span class="fl">9.15</span> ,  <span class="fl">9.35</span> ,  <span class="fl">9.15</span> ,  <span class="fl">9.65</span> ,</span>
<span id="cb99-23"><a href="#cb99-23" aria-hidden="true" tabindex="-1"></a>       <span class="fl">10.575</span>,  <span class="fl">9.975</span>,  <span class="fl">9.55</span> ,  <span class="fl">9.2</span>  ,  <span class="fl">9.925</span>,  <span class="fl">9.2</span>  ,  <span class="fl">9.3</span>  ,  <span class="fl">8.775</span>,</span>
<span id="cb99-24"><a href="#cb99-24" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.325</span>,  <span class="fl">9.175</span>,  <span class="fl">9.325</span>,  <span class="fl">8.975</span>,  <span class="fl">9.7</span>  ,  <span class="fl">9.5</span>  , <span class="fl">10.225</span>, <span class="fl">10.025</span>,</span>
<span id="cb99-25"><a href="#cb99-25" aria-hidden="true" tabindex="-1"></a>        <span class="fl">8.2</span>  ,  <span class="fl">8.2</span>  ,  <span class="fl">9.55</span> ,  <span class="fl">9.05</span> ,  <span class="fl">9.6</span>  ,  <span class="fl">9.6</span>  , <span class="fl">10.15</span> ,  <span class="fl">9.875</span>,</span>
<span id="cb99-26"><a href="#cb99-26" aria-hidden="true" tabindex="-1"></a>       <span class="fl">10.485</span>, <span class="fl">11.485</span>, <span class="fl">10.985</span>,  <span class="fl">9.7</span>  ,  <span class="fl">9.65</span> ,  <span class="fl">9.35</span> , <span class="fl">10.05</span> , <span class="fl">10.1</span>  ,</span>
<span id="cb99-27"><a href="#cb99-27" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.9</span>  ,  <span class="fl">8.95</span> ,  <span class="fl">9.3</span>  ,  <span class="fl">9.95</span> ,  <span class="fl">9.45</span> ,  <span class="fl">9.5</span>  ,  <span class="fl">8.45</span> ,  <span class="fl">8.8</span>  ,</span>
<span id="cb99-28"><a href="#cb99-28" aria-hidden="true" tabindex="-1"></a>        <span class="fl">8.525</span>,  <span class="fl">9.375</span>, <span class="fl">10.2</span>  ,  <span class="fl">7.625</span>,  <span class="fl">8.375</span>,  <span class="fl">9.25</span> ,  <span class="fl">9.4</span>  , <span class="fl">10.55</span> ,</span>
<span id="cb99-29"><a href="#cb99-29" aria-hidden="true" tabindex="-1"></a>        <span class="fl">8.9</span>  ,  <span class="fl">8.8</span>  ,  <span class="fl">9.</span>   ,  <span class="fl">8.575</span>,  <span class="fl">8.575</span>,  <span class="fl">9.6</span>  ,  <span class="fl">9.375</span>,  <span class="fl">9.6</span>  ,</span>
<span id="cb99-30"><a href="#cb99-30" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.95</span> ,  <span class="fl">9.6</span>  , <span class="fl">10.2</span>  ,  <span class="fl">9.85</span> ,  <span class="fl">9.625</span>,  <span class="fl">9.025</span>, <span class="fl">10.375</span>, <span class="fl">10.25</span> ,</span>
<span id="cb99-31"><a href="#cb99-31" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.3</span>  ,  <span class="fl">9.5</span>  ,  <span class="fl">9.55</span> ,  <span class="fl">8.55</span> ,  <span class="fl">9.05</span> ,  <span class="fl">9.9</span>  ,  <span class="fl">9.8</span>  ,  <span class="fl">9.75</span> ,</span>
<span id="cb99-32"><a href="#cb99-32" aria-hidden="true" tabindex="-1"></a>       <span class="fl">10.25</span> ,  <span class="fl">9.1</span>  ,  <span class="fl">9.65</span> , <span class="fl">10.3</span>  ,  <span class="fl">8.9</span>  ,  <span class="fl">9.95</span> ,  <span class="fl">9.5</span>  ,  <span class="fl">9.775</span>,</span>
<span id="cb99-33"><a href="#cb99-33" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.425</span>,  <span class="fl">7.75</span> ,  <span class="fl">7.55</span> ,  <span class="fl">9.1</span>  ,  <span class="fl">9.6</span>  ,  <span class="fl">9.575</span>,  <span class="fl">8.95</span> ,  <span class="fl">9.65</span> ,</span>
<span id="cb99-34"><a href="#cb99-34" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.65</span> ,  <span class="fl">9.65</span> ,  <span class="fl">9.525</span>,  <span class="fl">9.85</span> ,  <span class="fl">9.05</span> ,  <span class="fl">9.3</span>  ,  <span class="fl">8.9</span>  ,  <span class="fl">9.45</span> ,</span>
<span id="cb99-35"><a href="#cb99-35" aria-hidden="true" tabindex="-1"></a>       <span class="fl">10.</span>   ,  <span class="fl">9.85</span> ,  <span class="fl">9.25</span> , <span class="fl">10.1</span>  ,  <span class="fl">9.125</span>,  <span class="fl">9.65</span> ,  <span class="fl">9.1</span>  ,  <span class="fl">8.05</span> ,</span>
<span id="cb99-36"><a href="#cb99-36" aria-hidden="true" tabindex="-1"></a>        <span class="fl">7.4</span>  ,  <span class="fl">8.85</span> ,  <span class="fl">9.075</span>,  <span class="fl">9.</span>   ,  <span class="fl">9.7</span>  ,  <span class="fl">8.7</span>  ,  <span class="fl">9.45</span> ,  <span class="fl">9.7</span>  ,</span>
<span id="cb99-37"><a href="#cb99-37" aria-hidden="true" tabindex="-1"></a>        <span class="fl">8.35</span> ,  <span class="fl">8.85</span> ,  <span class="fl">9.7</span>  ,  <span class="fl">9.45</span> , <span class="fl">10.3</span>  , <span class="fl">10.</span>   , <span class="fl">10.45</span> ,  <span class="fl">9.45</span> ,</span>
<span id="cb99-38"><a href="#cb99-38" aria-hidden="true" tabindex="-1"></a>        <span class="fl">8.5</span>  ,  <span class="fl">8.3</span>  , <span class="fl">10.</span>   ,  <span class="fl">9.225</span>,  <span class="fl">9.75</span> ,  <span class="fl">9.15</span> ,  <span class="fl">9.55</span> ,  <span class="fl">9.</span>   ,</span>
<span id="cb99-39"><a href="#cb99-39" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.275</span>,  <span class="fl">9.35</span> ,  <span class="fl">8.95</span> ,  <span class="fl">9.875</span>,  <span class="fl">8.45</span> ,  <span class="fl">8.6</span>  ,  <span class="fl">9.7</span>  ,  <span class="fl">8.55</span> ,</span>
<span id="cb99-40"><a href="#cb99-40" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.05</span> ,  <span class="fl">9.6</span>  ,  <span class="fl">8.65</span> ,  <span class="fl">9.2</span>  ,  <span class="fl">8.95</span> ,  <span class="fl">9.6</span>  ,  <span class="fl">9.15</span> ,  <span class="fl">9.4</span>  ,</span>
<span id="cb99-41"><a href="#cb99-41" aria-hidden="true" tabindex="-1"></a>        <span class="fl">8.95</span> ,  <span class="fl">9.95</span> , <span class="fl">10.55</span> ,  <span class="fl">9.7</span>  ,  <span class="fl">8.85</span> ,  <span class="fl">8.8</span>  , <span class="fl">10.</span>   ,  <span class="fl">9.05</span> ,</span>
<span id="cb99-42"><a href="#cb99-42" aria-hidden="true" tabindex="-1"></a>        <span class="fl">8.2</span>  ,  <span class="fl">8.1</span>  ,  <span class="fl">7.25</span> ,  <span class="fl">8.3</span>  ,  <span class="fl">9.15</span> ,  <span class="fl">8.6</span>  ,  <span class="fl">9.5</span>  ,  <span class="fl">8.05</span> ,</span>
<span id="cb99-43"><a href="#cb99-43" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.425</span>,  <span class="fl">9.3</span>  ,  <span class="fl">9.8</span>  ,  <span class="fl">9.3</span>  ,  <span class="fl">9.85</span> ,  <span class="fl">9.5</span>  ,  <span class="fl">8.65</span> ,  <span class="fl">9.825</span>,</span>
<span id="cb99-44"><a href="#cb99-44" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.</span>   , <span class="fl">10.45</span> ,  <span class="fl">9.1</span>  ,  <span class="fl">9.55</span> ,  <span class="fl">9.05</span> , <span class="fl">10.</span>   ,  <span class="fl">9.35</span> ,  <span class="fl">8.375</span>,</span>
<span id="cb99-45"><a href="#cb99-45" aria-hidden="true" tabindex="-1"></a>        <span class="fl">8.3</span>  ,  <span class="fl">8.8</span>  , <span class="fl">10.1</span>  ,  <span class="fl">9.5</span>  ,  <span class="fl">9.75</span> , <span class="fl">10.1</span>  ,  <span class="fl">9.575</span>,  <span class="fl">9.425</span>,</span>
<span id="cb99-46"><a href="#cb99-46" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.65</span> ,  <span class="fl">8.725</span>,  <span class="fl">9.025</span>,  <span class="fl">8.5</span>  ,  <span class="fl">8.95</span> ,  <span class="fl">9.3</span>  ,  <span class="fl">8.85</span> ,  <span class="fl">8.95</span> ,</span>
<span id="cb99-47"><a href="#cb99-47" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.8</span>  ,  <span class="fl">9.5</span>  ,  <span class="fl">8.65</span> ,  <span class="fl">9.1</span>  ,  <span class="fl">9.4</span>  ,  <span class="fl">8.475</span>,  <span class="fl">9.35</span> ,  <span class="fl">7.95</span> ,</span>
<span id="cb99-48"><a href="#cb99-48" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.35</span> ,  <span class="fl">8.575</span>,  <span class="fl">9.05</span> ,  <span class="fl">8.175</span>,  <span class="fl">9.85</span> ,  <span class="fl">7.85</span> ,  <span class="fl">9.85</span> , <span class="fl">10.1</span>  ,</span>
<span id="cb99-49"><a href="#cb99-49" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.35</span> ,  <span class="fl">8.85</span> ,  <span class="fl">8.75</span> ,  <span class="fl">9.625</span>,  <span class="fl">9.25</span> ,  <span class="fl">9.55</span> , <span class="fl">10.325</span>,  <span class="fl">8.55</span> ,</span>
<span id="cb99-50"><a href="#cb99-50" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.675</span>,  <span class="fl">9.15</span> ,  <span class="fl">9.</span>   ,  <span class="fl">9.65</span> ,  <span class="fl">8.6</span>  ,  <span class="fl">8.8</span>  ,  <span class="fl">9.</span>   ,  <span class="fl">9.95</span> ,</span>
<span id="cb99-51"><a href="#cb99-51" aria-hidden="true" tabindex="-1"></a>        <span class="fl">8.4</span>  ,  <span class="fl">9.35</span> , <span class="fl">10.3</span>  ,  <span class="fl">9.05</span> ,  <span class="fl">9.975</span>,  <span class="fl">9.975</span>,  <span class="fl">8.65</span> ,  <span class="fl">8.725</span>,</span>
<span id="cb99-52"><a href="#cb99-52" aria-hidden="true" tabindex="-1"></a>        <span class="fl">8.2</span>  ,  <span class="fl">7.85</span> ,  <span class="fl">8.775</span>,  <span class="fl">8.5</span>  ,  <span class="fl">9.4</span>  ])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="79">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>bd_offspring_fortis <span class="op">=</span> np.array([<span class="fl">10.7</span> ,  <span class="fl">9.78</span>,  <span class="fl">9.48</span>,  <span class="fl">9.6</span> , <span class="fl">10.27</span>,  <span class="fl">9.5</span> ,  <span class="fl">9.</span>  ,  <span class="fl">7.46</span>,  <span class="fl">7.65</span>,</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>        <span class="fl">8.63</span>,  <span class="fl">9.81</span>,  <span class="fl">9.4</span> ,  <span class="fl">9.48</span>,  <span class="fl">8.75</span>,  <span class="fl">7.6</span> , <span class="fl">10.</span>  , <span class="fl">10.09</span>,  <span class="fl">9.74</span>,</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.64</span>,  <span class="fl">8.49</span>, <span class="fl">10.15</span>, <span class="fl">10.28</span>,  <span class="fl">9.2</span> , <span class="fl">10.01</span>,  <span class="fl">9.03</span>,  <span class="fl">9.94</span>, <span class="fl">10.5</span> ,</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.7</span> , <span class="fl">10.02</span>, <span class="fl">10.04</span>,  <span class="fl">9.43</span>,  <span class="fl">8.1</span> ,  <span class="fl">9.5</span> ,  <span class="fl">9.9</span> ,  <span class="fl">9.48</span>, <span class="fl">10.18</span>,</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>       <span class="fl">10.16</span>,  <span class="fl">9.08</span>, <span class="fl">10.39</span>,  <span class="fl">9.9</span> ,  <span class="fl">8.4</span> , <span class="fl">10.6</span> ,  <span class="fl">8.75</span>,  <span class="fl">9.46</span>,  <span class="fl">9.6</span> ,</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.6</span> ,  <span class="fl">9.95</span>, <span class="fl">10.05</span>, <span class="fl">10.16</span>, <span class="fl">10.1</span> ,  <span class="fl">9.83</span>,  <span class="fl">9.46</span>,  <span class="fl">9.7</span> ,  <span class="fl">9.82</span>,</span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>       <span class="fl">10.34</span>,  <span class="fl">8.02</span>,  <span class="fl">9.65</span>,  <span class="fl">9.87</span>,  <span class="fl">9.</span>  , <span class="fl">11.14</span>,  <span class="fl">9.25</span>,  <span class="fl">8.14</span>, <span class="fl">10.23</span>,</span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a>        <span class="fl">8.7</span> ,  <span class="fl">9.8</span> , <span class="fl">10.54</span>, <span class="fl">11.19</span>,  <span class="fl">9.85</span>,  <span class="fl">8.1</span> ,  <span class="fl">9.3</span> ,  <span class="fl">9.34</span>,  <span class="fl">9.19</span>,</span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.52</span>,  <span class="fl">9.36</span>,  <span class="fl">8.8</span> ,  <span class="fl">8.6</span> ,  <span class="fl">8.</span>  ,  <span class="fl">8.5</span> ,  <span class="fl">8.3</span> , <span class="fl">10.38</span>,  <span class="fl">8.54</span>,</span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a>        <span class="fl">8.94</span>, <span class="fl">10.</span>  ,  <span class="fl">9.76</span>,  <span class="fl">9.45</span>,  <span class="fl">9.89</span>, <span class="fl">10.9</span> ,  <span class="fl">9.91</span>,  <span class="fl">9.39</span>,  <span class="fl">9.86</span>,</span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.74</span>,  <span class="fl">9.9</span> ,  <span class="fl">9.09</span>,  <span class="fl">9.69</span>, <span class="fl">10.24</span>,  <span class="fl">8.9</span> ,  <span class="fl">9.67</span>,  <span class="fl">8.93</span>,  <span class="fl">9.3</span> ,</span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a>        <span class="fl">8.67</span>,  <span class="fl">9.15</span>,  <span class="fl">9.23</span>,  <span class="fl">9.59</span>,  <span class="fl">9.03</span>,  <span class="fl">9.58</span>,  <span class="fl">8.97</span>,  <span class="fl">8.57</span>,  <span class="fl">8.47</span>,</span>
<span id="cb100-13"><a href="#cb100-13" aria-hidden="true" tabindex="-1"></a>        <span class="fl">8.71</span>,  <span class="fl">9.21</span>,  <span class="fl">9.13</span>,  <span class="fl">8.5</span> ,  <span class="fl">9.58</span>,  <span class="fl">9.21</span>,  <span class="fl">9.6</span> ,  <span class="fl">9.32</span>,  <span class="fl">8.7</span> ,</span>
<span id="cb100-14"><a href="#cb100-14" aria-hidden="true" tabindex="-1"></a>       <span class="fl">10.46</span>,  <span class="fl">9.29</span>,  <span class="fl">9.24</span>,  <span class="fl">9.45</span>,  <span class="fl">9.35</span>, <span class="fl">10.19</span>,  <span class="fl">9.91</span>,  <span class="fl">9.18</span>,  <span class="fl">9.89</span>,</span>
<span id="cb100-15"><a href="#cb100-15" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.6</span> , <span class="fl">10.3</span> ,  <span class="fl">9.45</span>,  <span class="fl">8.79</span>,  <span class="fl">9.2</span> ,  <span class="fl">8.8</span> ,  <span class="fl">9.69</span>, <span class="fl">10.61</span>,  <span class="fl">9.6</span> ,</span>
<span id="cb100-16"><a href="#cb100-16" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.9</span> ,  <span class="fl">9.26</span>, <span class="fl">10.2</span> ,  <span class="fl">8.79</span>,  <span class="fl">9.28</span>,  <span class="fl">8.83</span>,  <span class="fl">9.76</span>, <span class="fl">10.2</span> ,  <span class="fl">9.43</span>,</span>
<span id="cb100-17"><a href="#cb100-17" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.4</span> ,  <span class="fl">9.9</span> ,  <span class="fl">9.5</span> ,  <span class="fl">8.95</span>,  <span class="fl">9.98</span>,  <span class="fl">9.72</span>,  <span class="fl">9.86</span>, <span class="fl">11.1</span> ,  <span class="fl">9.14</span>,</span>
<span id="cb100-18"><a href="#cb100-18" aria-hidden="true" tabindex="-1"></a>       <span class="fl">10.49</span>,  <span class="fl">9.75</span>, <span class="fl">10.35</span>,  <span class="fl">9.73</span>,  <span class="fl">9.83</span>,  <span class="fl">8.69</span>,  <span class="fl">9.58</span>,  <span class="fl">8.42</span>,  <span class="fl">9.25</span>,</span>
<span id="cb100-19"><a href="#cb100-19" aria-hidden="true" tabindex="-1"></a>       <span class="fl">10.12</span>,  <span class="fl">9.31</span>,  <span class="fl">9.99</span>,  <span class="fl">8.59</span>,  <span class="fl">8.74</span>,  <span class="fl">8.79</span>,  <span class="fl">9.6</span> ,  <span class="fl">9.52</span>,  <span class="fl">8.93</span>,</span>
<span id="cb100-20"><a href="#cb100-20" aria-hidden="true" tabindex="-1"></a>       <span class="fl">10.23</span>,  <span class="fl">9.35</span>,  <span class="fl">9.35</span>,  <span class="fl">9.09</span>,  <span class="fl">9.04</span>,  <span class="fl">9.75</span>, <span class="fl">10.5</span> ,  <span class="fl">9.09</span>,  <span class="fl">9.05</span>,</span>
<span id="cb100-21"><a href="#cb100-21" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.54</span>,  <span class="fl">9.3</span> ,  <span class="fl">9.06</span>,  <span class="fl">8.7</span> ,  <span class="fl">9.32</span>,  <span class="fl">8.4</span> ,  <span class="fl">8.67</span>,  <span class="fl">8.6</span> ,  <span class="fl">9.53</span>,</span>
<span id="cb100-22"><a href="#cb100-22" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.77</span>,  <span class="fl">9.65</span>,  <span class="fl">9.43</span>,  <span class="fl">8.35</span>,  <span class="fl">8.26</span>,  <span class="fl">9.5</span> ,  <span class="fl">8.6</span> ,  <span class="fl">9.57</span>,  <span class="fl">9.14</span>,</span>
<span id="cb100-23"><a href="#cb100-23" aria-hidden="true" tabindex="-1"></a>       <span class="fl">10.79</span>,  <span class="fl">8.91</span>,  <span class="fl">9.93</span>, <span class="fl">10.7</span> ,  <span class="fl">9.3</span> ,  <span class="fl">9.93</span>,  <span class="fl">9.51</span>,  <span class="fl">9.44</span>, <span class="fl">10.05</span>,</span>
<span id="cb100-24"><a href="#cb100-24" aria-hidden="true" tabindex="-1"></a>       <span class="fl">10.13</span>,  <span class="fl">9.24</span>,  <span class="fl">8.21</span>,  <span class="fl">8.9</span> ,  <span class="fl">9.34</span>,  <span class="fl">8.77</span>,  <span class="fl">9.4</span> ,  <span class="fl">8.82</span>,  <span class="fl">8.83</span>,</span>
<span id="cb100-25"><a href="#cb100-25" aria-hidden="true" tabindex="-1"></a>        <span class="fl">8.6</span> ,  <span class="fl">9.5</span> , <span class="fl">10.2</span> ,  <span class="fl">8.09</span>,  <span class="fl">9.07</span>,  <span class="fl">9.29</span>,  <span class="fl">9.1</span> , <span class="fl">10.19</span>,  <span class="fl">9.25</span>,</span>
<span id="cb100-26"><a href="#cb100-26" aria-hidden="true" tabindex="-1"></a>        <span class="fl">8.98</span>,  <span class="fl">9.02</span>,  <span class="fl">8.6</span> ,  <span class="fl">8.25</span>,  <span class="fl">8.7</span> ,  <span class="fl">9.9</span> ,  <span class="fl">9.65</span>,  <span class="fl">9.45</span>,  <span class="fl">9.38</span>,</span>
<span id="cb100-27"><a href="#cb100-27" aria-hidden="true" tabindex="-1"></a>       <span class="fl">10.4</span> ,  <span class="fl">9.96</span>,  <span class="fl">9.46</span>,  <span class="fl">8.26</span>, <span class="fl">10.05</span>,  <span class="fl">8.92</span>,  <span class="fl">9.5</span> ,  <span class="fl">9.43</span>,  <span class="fl">8.97</span>,</span>
<span id="cb100-28"><a href="#cb100-28" aria-hidden="true" tabindex="-1"></a>        <span class="fl">8.44</span>,  <span class="fl">8.92</span>, <span class="fl">10.3</span> ,  <span class="fl">8.4</span> ,  <span class="fl">9.37</span>,  <span class="fl">9.91</span>, <span class="fl">10.</span>  ,  <span class="fl">9.21</span>,  <span class="fl">9.95</span>,</span>
<span id="cb100-29"><a href="#cb100-29" aria-hidden="true" tabindex="-1"></a>        <span class="fl">8.84</span>,  <span class="fl">9.82</span>,  <span class="fl">9.5</span> , <span class="fl">10.29</span>,  <span class="fl">8.4</span> ,  <span class="fl">8.31</span>,  <span class="fl">9.29</span>,  <span class="fl">8.86</span>,  <span class="fl">9.4</span> ,</span>
<span id="cb100-30"><a href="#cb100-30" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.62</span>,  <span class="fl">8.62</span>,  <span class="fl">8.3</span> ,  <span class="fl">9.8</span> ,  <span class="fl">8.48</span>,  <span class="fl">9.61</span>,  <span class="fl">9.5</span> ,  <span class="fl">9.37</span>,  <span class="fl">8.74</span>,</span>
<span id="cb100-31"><a href="#cb100-31" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.31</span>,  <span class="fl">9.5</span> ,  <span class="fl">9.49</span>,  <span class="fl">9.74</span>,  <span class="fl">9.2</span> ,  <span class="fl">9.24</span>,  <span class="fl">9.7</span> ,  <span class="fl">9.64</span>,  <span class="fl">9.2</span> ,</span>
<span id="cb100-32"><a href="#cb100-32" aria-hidden="true" tabindex="-1"></a>        <span class="fl">7.5</span> ,  <span class="fl">7.5</span> ,  <span class="fl">8.7</span> ,  <span class="fl">8.31</span>,  <span class="fl">9.</span>  ,  <span class="fl">9.74</span>,  <span class="fl">9.31</span>, <span class="fl">10.5</span> ,  <span class="fl">9.3</span> ,</span>
<span id="cb100-33"><a href="#cb100-33" aria-hidden="true" tabindex="-1"></a>        <span class="fl">8.12</span>,  <span class="fl">9.34</span>,  <span class="fl">9.72</span>,  <span class="fl">9.</span>  ,  <span class="fl">9.65</span>,  <span class="fl">9.9</span> , <span class="fl">10.</span>  , <span class="fl">10.1</span> ,  <span class="fl">8.</span>  ,</span>
<span id="cb100-34"><a href="#cb100-34" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.07</span>,  <span class="fl">9.75</span>,  <span class="fl">9.33</span>,  <span class="fl">8.11</span>,  <span class="fl">9.36</span>,  <span class="fl">9.74</span>,  <span class="fl">9.9</span> ,  <span class="fl">9.23</span>,  <span class="fl">9.7</span> ,</span>
<span id="cb100-35"><a href="#cb100-35" aria-hidden="true" tabindex="-1"></a>        <span class="fl">8.2</span> ,  <span class="fl">9.35</span>,  <span class="fl">9.49</span>,  <span class="fl">9.34</span>,  <span class="fl">8.87</span>,  <span class="fl">9.03</span>,  <span class="fl">9.07</span>,  <span class="fl">9.43</span>,  <span class="fl">8.2</span> ,</span>
<span id="cb100-36"><a href="#cb100-36" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.19</span>,  <span class="fl">9.</span>  ,  <span class="fl">9.2</span> ,  <span class="fl">9.06</span>,  <span class="fl">9.81</span>,  <span class="fl">8.89</span>,  <span class="fl">9.4</span> , <span class="fl">10.45</span>,  <span class="fl">9.64</span>,</span>
<span id="cb100-37"><a href="#cb100-37" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.03</span>,  <span class="fl">8.71</span>,  <span class="fl">9.91</span>,  <span class="fl">8.33</span>,  <span class="fl">8.2</span> ,  <span class="fl">7.83</span>,  <span class="fl">7.14</span>,  <span class="fl">8.91</span>,  <span class="fl">9.18</span>,</span>
<span id="cb100-38"><a href="#cb100-38" aria-hidden="true" tabindex="-1"></a>        <span class="fl">8.8</span> ,  <span class="fl">9.9</span> ,  <span class="fl">7.73</span>,  <span class="fl">9.25</span>,  <span class="fl">8.7</span> ,  <span class="fl">9.5</span> ,  <span class="fl">9.3</span> ,  <span class="fl">9.05</span>, <span class="fl">10.18</span>,</span>
<span id="cb100-39"><a href="#cb100-39" aria-hidden="true" tabindex="-1"></a>        <span class="fl">8.85</span>,  <span class="fl">9.24</span>,  <span class="fl">9.15</span>,  <span class="fl">9.98</span>,  <span class="fl">8.77</span>,  <span class="fl">9.8</span> ,  <span class="fl">8.65</span>, <span class="fl">10.</span>  ,  <span class="fl">8.81</span>,</span>
<span id="cb100-40"><a href="#cb100-40" aria-hidden="true" tabindex="-1"></a>        <span class="fl">8.01</span>,  <span class="fl">7.9</span> ,  <span class="fl">9.41</span>, <span class="fl">10.18</span>,  <span class="fl">9.55</span>,  <span class="fl">9.08</span>,  <span class="fl">8.4</span> ,  <span class="fl">9.75</span>,  <span class="fl">8.9</span> ,</span>
<span id="cb100-41"><a href="#cb100-41" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.07</span>,  <span class="fl">9.35</span>,  <span class="fl">8.9</span> ,  <span class="fl">8.19</span>,  <span class="fl">8.65</span>,  <span class="fl">9.19</span>,  <span class="fl">8.9</span> ,  <span class="fl">9.28</span>, <span class="fl">10.58</span>,</span>
<span id="cb100-42"><a href="#cb100-42" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.</span>  ,  <span class="fl">9.4</span> ,  <span class="fl">8.91</span>,  <span class="fl">9.93</span>, <span class="fl">10.</span>  ,  <span class="fl">9.37</span>,  <span class="fl">7.4</span> ,  <span class="fl">9.</span>  ,  <span class="fl">8.8</span> ,</span>
<span id="cb100-43"><a href="#cb100-43" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.18</span>,  <span class="fl">8.3</span> , <span class="fl">10.08</span>,  <span class="fl">7.9</span> ,  <span class="fl">9.96</span>, <span class="fl">10.4</span> ,  <span class="fl">9.65</span>,  <span class="fl">8.8</span> ,  <span class="fl">8.65</span>,</span>
<span id="cb100-44"><a href="#cb100-44" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.7</span> ,  <span class="fl">9.23</span>,  <span class="fl">9.43</span>,  <span class="fl">9.93</span>,  <span class="fl">8.47</span>,  <span class="fl">9.55</span>,  <span class="fl">9.28</span>,  <span class="fl">8.85</span>,  <span class="fl">8.9</span> ,</span>
<span id="cb100-45"><a href="#cb100-45" aria-hidden="true" tabindex="-1"></a>        <span class="fl">8.75</span>,  <span class="fl">8.63</span>,  <span class="fl">9.</span>  ,  <span class="fl">9.43</span>,  <span class="fl">8.28</span>,  <span class="fl">9.23</span>, <span class="fl">10.4</span> ,  <span class="fl">9.</span>  ,  <span class="fl">9.8</span> ,</span>
<span id="cb100-46"><a href="#cb100-46" aria-hidden="true" tabindex="-1"></a>        <span class="fl">9.77</span>,  <span class="fl">8.97</span>,  <span class="fl">8.37</span>,  <span class="fl">7.7</span> ,  <span class="fl">7.9</span> ,  <span class="fl">9.5</span> ,  <span class="fl">8.2</span> ,  <span class="fl">8.8</span> ])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We’ll make a scatter plot of the average offspring beak depth (y-axis) versus average parental beak depth (x-axis) for both species.</p>
<div class="cell" data-execution_count="80">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make scatter plots</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.plot(bd_parent_fortis, bd_offspring_fortis,</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>             marker<span class="op">=</span><span class="st">"."</span>, linestyle<span class="op">=</span><span class="st">"none"</span>, color<span class="op">=</span><span class="st">"blue"</span>, alpha<span class="op">=</span><span class="fl">.5</span>)</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.plot(bd_parent_scandens, bd_offspring_scandens,</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>             marker<span class="op">=</span><span class="st">"."</span>, linestyle<span class="op">=</span><span class="st">"none"</span>, color<span class="op">=</span><span class="st">"red"</span>, alpha<span class="op">=</span><span class="fl">.5</span>)</span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Label axes</span></span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.xlabel(<span class="st">'parental beak depth (mm)'</span>)</span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.ylabel(<span class="st">'offspring beak depth (mm)'</span>)</span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Add legend</span></span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.legend((<span class="st">'G. fortis'</span>, <span class="st">'G. scandens'</span>), loc<span class="op">=</span><span class="st">'lower right'</span>)</span>
<span id="cb101-13"><a href="#cb101-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-14"><a href="#cb101-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Show plot</span></span>
<span id="cb101-15"><a href="#cb101-15" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2020-07-08-Statistical Thinking in Python (Part 2)_files/figure-html/cell-78-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>It appears as though there is a stronger correlation in <em>G. fortis</em> than in <em>G. scandens</em>. This suggests that beak depth is more strongly inherited in G. fortis. We’ll quantify this correlation</p>
</section>
<section id="correlation-of-offspring-and-parental-data" class="level3">
<h3 class="anchored" data-anchor-id="correlation-of-offspring-and-parental-data">Correlation of offspring and parental data</h3>
<p>In an effort to quantify the correlation between offspring and parent beak depths, we would like to compute statistics, such as the Pearson correlation coefficient, between parents and offspring. To get confidence intervals on this, we need to do a pairs bootstrap.</p>
<div class="cell" data-execution_count="81">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> draw_bs_pairs(x, y, func, size<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Perform pairs bootstrap for a single statistic."""</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set up array of indices to sample from: inds</span></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>    inds <span class="op">=</span> np.arange(<span class="bu">len</span>(x))</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize replicates: bs_replicates</span></span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>    bs_replicates <span class="op">=</span> np.empty(size)</span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Generate replicates</span></span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(size):</span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a>        bs_inds <span class="op">=</span> np.random.choice(inds, <span class="bu">len</span>(inds))</span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a>        bs_x, bs_y <span class="op">=</span> x[bs_inds], y[bs_inds]</span>
<span id="cb102-14"><a href="#cb102-14" aria-hidden="true" tabindex="-1"></a>        bs_replicates[i] <span class="op">=</span> func(bs_x, bs_y)</span>
<span id="cb102-15"><a href="#cb102-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-16"><a href="#cb102-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> bs_replicates</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="pearson-correlation-of-offspring-and-parental-data" class="level3">
<h3 class="anchored" data-anchor-id="pearson-correlation-of-offspring-and-parental-data">Pearson correlation of offspring and parental data</h3>
<p>The Pearson correlation coefficient seems like a useful measure of how strongly the beak depth of parents are inherited by their offspring. We’ll compute the Pearson correlation coefficient between parental and offspring beak depths for <em>G. scandens</em>. And Do the same for <em>G. fortis</em>. Then, use the function <code>draw_bs_pairs</code> to compute a 95% confidence interval using pairs bootstrap.</p>
<div class="cell" data-execution_count="82">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the Pearson correlation coefficients</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>r_scandens <span class="op">=</span> pearson_r(bd_parent_scandens, bd_offspring_scandens)</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>r_fortis <span class="op">=</span> pearson_r(bd_parent_fortis, bd_offspring_fortis)</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Acquire 1000 bootstrap replicates of Pearson r</span></span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>bs_replicates_scandens <span class="op">=</span> draw_bs_pairs(bd_parent_scandens, bd_offspring_scandens, pearson_r, size<span class="op">=</span><span class="dv">1000</span>)</span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a>bs_replicates_fortis <span class="op">=</span> draw_bs_pairs(bd_parent_fortis, bd_offspring_fortis, pearson_r, size<span class="op">=</span><span class="dv">1000</span>)</span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute 95% confidence intervals</span></span>
<span id="cb103-12"><a href="#cb103-12" aria-hidden="true" tabindex="-1"></a>conf_int_scandens <span class="op">=</span> np.percentile(bs_replicates_scandens, [<span class="fl">2.5</span>, <span class="fl">97.5</span>])</span>
<span id="cb103-13"><a href="#cb103-13" aria-hidden="true" tabindex="-1"></a>conf_int_fortis <span class="op">=</span> np.percentile(bs_replicates_fortis, [<span class="fl">2.5</span>, <span class="fl">97.5</span>])</span>
<span id="cb103-14"><a href="#cb103-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-15"><a href="#cb103-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results</span></span>
<span id="cb103-16"><a href="#cb103-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'G. scandens:'</span>, r_scandens, conf_int_scandens)</span>
<span id="cb103-17"><a href="#cb103-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'G. fortis:'</span>, r_fortis, conf_int_fortis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>G. scandens: 0.41170636294012586 [0.28114522 0.55186026]
G. fortis: 0.7283412395518486 [0.66716345 0.7791389 ]</code></pre>
</div>
</div>
<p>It is clear from the confidence intervals that beak depth of the offspring of <em>G. fortis</em> parents is more strongly correlated with their offspring than their <em>G. scandens</em> counterparts.</p>
</section>
<section id="measuring-heritability" class="level3">
<h3 class="anchored" data-anchor-id="measuring-heritability">Measuring heritability</h3>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Pearson correlation coefficient is the ratio of the covariance to the geometric mean of the variances of the two data sets.</p>
</div>
</div>
<p>This is a measure of the correlation between parents and offspring, but might not be the best estimate of heritability. If we stop and think, it makes more sense to define heritability as the ratio of the covariance between parent and offspring to the variance of the parents alone. We will estimate the heritability and perform a pairs bootstrap calculation to get the 95% confidence interval.</p>
<div class="callout-warning callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Statistical inference (and data analysis in general) is not a plug-n-chug enterprise. You need to think carefully about the questions you are seeking to answer with your data and analyze them appropriately. If you are interested in how heritable traits are, the quantity we defined as the heritability is more apt than the off-the-shelf statistic, the Pearson correlation coefficient.</p>
</div>
</div>
<div class="cell" data-execution_count="83">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> heritability(parents, offspring):</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Compute the heritability from parent and offspring samples."""</span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>    covariance_matrix <span class="op">=</span> np.cov(parents, offspring)</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> covariance_matrix[<span class="dv">0</span>,<span class="dv">1</span>] <span class="op">/</span> covariance_matrix[<span class="dv">0</span>,<span class="dv">0</span>]</span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the heritability</span></span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>heritability_scandens <span class="op">=</span> heritability(bd_parent_scandens, bd_offspring_scandens)</span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a>heritability_fortis <span class="op">=</span> heritability(bd_parent_fortis, bd_offspring_fortis)</span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Acquire 1000 bootstrap replicates of heritability</span></span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a>replicates_scandens <span class="op">=</span> draw_bs_pairs(</span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a>        bd_parent_scandens, bd_offspring_scandens, heritability, size<span class="op">=</span><span class="dv">1000</span>)</span>
<span id="cb105-13"><a href="#cb105-13" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb105-14"><a href="#cb105-14" aria-hidden="true" tabindex="-1"></a>replicates_fortis <span class="op">=</span> draw_bs_pairs(</span>
<span id="cb105-15"><a href="#cb105-15" aria-hidden="true" tabindex="-1"></a>        bd_parent_fortis, bd_offspring_fortis, heritability, size<span class="op">=</span><span class="dv">1000</span>)</span>
<span id="cb105-16"><a href="#cb105-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-17"><a href="#cb105-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-18"><a href="#cb105-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute 95% confidence intervals</span></span>
<span id="cb105-19"><a href="#cb105-19" aria-hidden="true" tabindex="-1"></a>conf_int_scandens <span class="op">=</span> np.percentile(replicates_scandens, [<span class="fl">2.5</span>, <span class="fl">97.5</span>])</span>
<span id="cb105-20"><a href="#cb105-20" aria-hidden="true" tabindex="-1"></a>conf_int_fortis <span class="op">=</span> np.percentile(replicates_fortis, [<span class="fl">2.5</span>, <span class="fl">97.5</span>])</span>
<span id="cb105-21"><a href="#cb105-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-22"><a href="#cb105-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results</span></span>
<span id="cb105-23"><a href="#cb105-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'G. scandens:'</span>, heritability_scandens, conf_int_scandens)</span>
<span id="cb105-24"><a href="#cb105-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'G. fortis:'</span>, heritability_fortis, conf_int_fortis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>G. scandens: 0.5485340868685983 [0.35159687 0.74984943]
G. fortis: 0.7229051911438156 [0.64286124 0.78727894]</code></pre>
</div>
</div>
<p>Here again, we see that <em>G. fortis</em> has stronger heritability than <em>G. scandens</em>. This suggests that the traits of <em>G. fortis</em> may be strongly incorporated into <em>G. scandens</em> by introgressive hybridization.</p>
</section>
<section id="is-beak-depth-heritable-at-all-in-g.-scandens" class="level3">
<h3 class="anchored" data-anchor-id="is-beak-depth-heritable-at-all-in-g.-scandens">Is beak depth heritable at all in G. scandens?</h3>
<p>The heritability of beak depth in G. scandens seems low. It could be that this observed heritability was just achieved by chance and beak depth is actually not really heritable in the species. We will test that hypothesis here. To do this, We will do a pairs permutation test.</p>
<div class="cell" data-execution_count="84">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize array of replicates: perm_replicates</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>perm_replicates <span class="op">=</span> np.empty(<span class="dv">10000</span>)</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Draw replicates</span></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10000</span>):</span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Permute parent beak depths</span></span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>    bd_parent_permuted <span class="op">=</span> np.random.permutation(bd_parent_scandens)</span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>    perm_replicates[i] <span class="op">=</span> heritability(bd_parent_permuted, bd_offspring_scandens)</span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute p-value: p</span></span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> np.<span class="bu">sum</span>(perm_replicates <span class="op">&gt;=</span> heritability_scandens) <span class="op">/</span> <span class="bu">len</span>(perm_replicates)</span>
<span id="cb107-13"><a href="#cb107-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-14"><a href="#cb107-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the p-value</span></span>
<span id="cb107-15"><a href="#cb107-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'p-val ='</span>, p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>p-val = 0.0</code></pre>
</div>
</div>
<p>We get a p-value of zero, which means that none of the 10,000 permutation pairs replicates we drew had a heritability high enough to match that which was observed. This strongly suggests that beak depth is heritable in <em>G. scandens</em>, just not as much as in <em>G. fortis</em>. If you like, you can plot a histogram of the heritability replicates to get a feel for how extreme of a value of heritability you might expect by chance.</p>
<div class="cell" data-execution_count="87">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.hist(perm_replicates, bins <span class="op">=</span> <span class="bu">int</span>(np.sqrt(<span class="bu">len</span>(perm_replicates))))</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.ylabel(<span class="st">"counts"</span>)</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.xlabel(<span class="st">"Heritability replicates"</span>)</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2020-07-08-Statistical Thinking in Python (Part 2)_files/figure-html/cell-83-output-1.png" class="img-fluid"></p>
</div>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>