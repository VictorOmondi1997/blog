<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Victor Omondi">
<meta name="dcterms.date" content="2020-10-19">
<meta name="description" content="- author: Victor Omondi">

<title>blog - Appliances Energy Prediction data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">blog</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../about.html">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/VictorOmondi1997"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/VictorOmondi197"><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Appliances Energy Prediction data</h1>
                  <div>
        <div class="description">
          - author: Victor Omondi
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">energy</div>
                <div class="quarto-category">machine-learning</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Victor Omondi </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">October 19, 2020</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#libraries" id="toc-libraries" class="nav-link active" data-scroll-target="#libraries">Libraries</a></li>
  <li><a href="#the-dataset" id="toc-the-dataset" class="nav-link" data-scroll-target="#the-dataset">The Dataset</a>
  <ul class="collapse">
  <li><a href="#dataset-description" id="toc-dataset-description" class="nav-link" data-scroll-target="#dataset-description">Dataset Description</a>
  <ul class="collapse">
  <li><a href="#attribute-information" id="toc-attribute-information" class="nav-link" data-scroll-target="#attribute-information">Attribute Information:</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="libraries" class="level1">
<h1>Libraries</h1>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">"ignore"</span>, message<span class="op">=</span><span class="st">"numpy.ufunc size changed"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">"display.max.columns"</span>, <span class="va">None</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">"display.max_colwidth"</span>, <span class="va">None</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>plt.style.use(<span class="st">"ggplot"</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> MinMaxScaler</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> (LinearRegression, </span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>                                  Ridge, </span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>                                  Lasso)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> (r2_score, </span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>                             mean_absolute_error, </span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>                             mean_squared_error)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="the-dataset" class="level1">
<h1>The Dataset</h1>
<p>The dataset is the <a href="https://archive.ics.uci.edu/ml/machine-learning-databases/00374/">Appliances Energy Prediction data</a>. The data set is at 10 min for about 4.5 months. The house temperature and humidity conditions were monitored with a ZigBee wireless sensor network. Each wireless node transmitted the temperature and humidity conditions around 3.3 min. Then, the wireless data was averaged for 10 minutes periods. The energy data was logged every 10 minutes with m-bus energy meters. Weather from the nearest airport weather station (Chievres Airport, Belgium) was downloaded from a public data set from Reliable Prognosis (rp5.ru), and merged together with the experimental data sets using the date and time column. Two random variables have been included in the data set for testing the regression models and to filter out non predictive attributes (parameters).</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>energy <span class="op">=</span> pd.read_csv(<span class="st">"datasets/energydata_complete.csv"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>energy.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>date</th>
      <th>Appliances</th>
      <th>lights</th>
      <th>T1</th>
      <th>RH_1</th>
      <th>T2</th>
      <th>RH_2</th>
      <th>T3</th>
      <th>RH_3</th>
      <th>T4</th>
      <th>RH_4</th>
      <th>T5</th>
      <th>RH_5</th>
      <th>T6</th>
      <th>RH_6</th>
      <th>T7</th>
      <th>RH_7</th>
      <th>T8</th>
      <th>RH_8</th>
      <th>T9</th>
      <th>RH_9</th>
      <th>T_out</th>
      <th>Press_mm_hg</th>
      <th>RH_out</th>
      <th>Windspeed</th>
      <th>Visibility</th>
      <th>Tdewpoint</th>
      <th>rv1</th>
      <th>rv2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2016-01-11 17:00:00</td>
      <td>60</td>
      <td>30</td>
      <td>19.89</td>
      <td>47.596667</td>
      <td>19.2</td>
      <td>44.790000</td>
      <td>19.79</td>
      <td>44.730000</td>
      <td>19.000000</td>
      <td>45.566667</td>
      <td>17.166667</td>
      <td>55.20</td>
      <td>7.026667</td>
      <td>84.256667</td>
      <td>17.200000</td>
      <td>41.626667</td>
      <td>18.2</td>
      <td>48.900000</td>
      <td>17.033333</td>
      <td>45.53</td>
      <td>6.600000</td>
      <td>733.5</td>
      <td>92.0</td>
      <td>7.000000</td>
      <td>63.000000</td>
      <td>5.3</td>
      <td>13.275433</td>
      <td>13.275433</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2016-01-11 17:10:00</td>
      <td>60</td>
      <td>30</td>
      <td>19.89</td>
      <td>46.693333</td>
      <td>19.2</td>
      <td>44.722500</td>
      <td>19.79</td>
      <td>44.790000</td>
      <td>19.000000</td>
      <td>45.992500</td>
      <td>17.166667</td>
      <td>55.20</td>
      <td>6.833333</td>
      <td>84.063333</td>
      <td>17.200000</td>
      <td>41.560000</td>
      <td>18.2</td>
      <td>48.863333</td>
      <td>17.066667</td>
      <td>45.56</td>
      <td>6.483333</td>
      <td>733.6</td>
      <td>92.0</td>
      <td>6.666667</td>
      <td>59.166667</td>
      <td>5.2</td>
      <td>18.606195</td>
      <td>18.606195</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2016-01-11 17:20:00</td>
      <td>50</td>
      <td>30</td>
      <td>19.89</td>
      <td>46.300000</td>
      <td>19.2</td>
      <td>44.626667</td>
      <td>19.79</td>
      <td>44.933333</td>
      <td>18.926667</td>
      <td>45.890000</td>
      <td>17.166667</td>
      <td>55.09</td>
      <td>6.560000</td>
      <td>83.156667</td>
      <td>17.200000</td>
      <td>41.433333</td>
      <td>18.2</td>
      <td>48.730000</td>
      <td>17.000000</td>
      <td>45.50</td>
      <td>6.366667</td>
      <td>733.7</td>
      <td>92.0</td>
      <td>6.333333</td>
      <td>55.333333</td>
      <td>5.1</td>
      <td>28.642668</td>
      <td>28.642668</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2016-01-11 17:30:00</td>
      <td>50</td>
      <td>40</td>
      <td>19.89</td>
      <td>46.066667</td>
      <td>19.2</td>
      <td>44.590000</td>
      <td>19.79</td>
      <td>45.000000</td>
      <td>18.890000</td>
      <td>45.723333</td>
      <td>17.166667</td>
      <td>55.09</td>
      <td>6.433333</td>
      <td>83.423333</td>
      <td>17.133333</td>
      <td>41.290000</td>
      <td>18.1</td>
      <td>48.590000</td>
      <td>17.000000</td>
      <td>45.40</td>
      <td>6.250000</td>
      <td>733.8</td>
      <td>92.0</td>
      <td>6.000000</td>
      <td>51.500000</td>
      <td>5.0</td>
      <td>45.410389</td>
      <td>45.410389</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2016-01-11 17:40:00</td>
      <td>60</td>
      <td>40</td>
      <td>19.89</td>
      <td>46.333333</td>
      <td>19.2</td>
      <td>44.530000</td>
      <td>19.79</td>
      <td>45.000000</td>
      <td>18.890000</td>
      <td>45.530000</td>
      <td>17.200000</td>
      <td>55.09</td>
      <td>6.366667</td>
      <td>84.893333</td>
      <td>17.200000</td>
      <td>41.230000</td>
      <td>18.1</td>
      <td>48.590000</td>
      <td>17.000000</td>
      <td>45.40</td>
      <td>6.133333</td>
      <td>733.9</td>
      <td>92.0</td>
      <td>5.666667</td>
      <td>47.666667</td>
      <td>4.9</td>
      <td>10.084097</td>
      <td>10.084097</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<section id="dataset-description" class="level2">
<h2 class="anchored" data-anchor-id="dataset-description">Dataset Description</h2>
<p>The attribute information can be seen below.</p>
<section id="attribute-information" class="level3">
<h3 class="anchored" data-anchor-id="attribute-information">Attribute Information:</h3>
<table class="table">
<thead>
<tr class="header">
<th>Attribute</th>
<th>Description</th>
<th>Units</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Date</td>
<td>time</td>
<td>year-month-day hour:minute:second</td>
</tr>
<tr class="even">
<td>Appliances</td>
<td>energy use</td>
<td>in Wh</td>
</tr>
<tr class="odd">
<td>lights</td>
<td>energy use of light fixtures in the house</td>
<td>in Wh</td>
</tr>
<tr class="even">
<td>T1</td>
<td>Temperature in kitchen area</td>
<td>in Celsius</td>
</tr>
<tr class="odd">
<td>RH_1</td>
<td>Humidity in kitchen area</td>
<td>in %</td>
</tr>
<tr class="even">
<td>T2</td>
<td>Temperature in living room area</td>
<td>in Celsius</td>
</tr>
<tr class="odd">
<td>RH_2</td>
<td>Humidity in living room area</td>
<td>in %</td>
</tr>
<tr class="even">
<td>T3</td>
<td>Temperature in laundry room area</td>
<td></td>
</tr>
<tr class="odd">
<td>RH_3</td>
<td>Humidity in laundry room area</td>
<td>in %</td>
</tr>
<tr class="even">
<td>T4</td>
<td>Temperature in office room</td>
<td>in Celsius</td>
</tr>
<tr class="odd">
<td>RH_4</td>
<td>Humidity in office room</td>
<td>in %</td>
</tr>
<tr class="even">
<td>T5</td>
<td>Temperature in bathroom</td>
<td>in Celsius</td>
</tr>
<tr class="odd">
<td>RH_5</td>
<td>Humidity in bathroom</td>
<td>in %</td>
</tr>
<tr class="even">
<td>T6</td>
<td>Temperature outside the building (north side)</td>
<td>in Celsius</td>
</tr>
<tr class="odd">
<td>RH_6</td>
<td>Humidity outside the building (north side)</td>
<td>in %</td>
</tr>
<tr class="even">
<td>T7</td>
<td>Temperature in ironing room</td>
<td>in Celsius</td>
</tr>
<tr class="odd">
<td>RH_7</td>
<td>Humidity in ironing room</td>
<td>in %</td>
</tr>
<tr class="even">
<td>T8</td>
<td>Temperature in teenager room 2</td>
<td>in Celsius</td>
</tr>
<tr class="odd">
<td>RH_8</td>
<td>Humidity in teenager room 2</td>
<td>in %</td>
</tr>
<tr class="even">
<td>T9</td>
<td>Temperature in parents room</td>
<td>in Celsius</td>
</tr>
<tr class="odd">
<td>RH_9</td>
<td>Humidity in parents room</td>
<td>in %</td>
</tr>
<tr class="even">
<td>To</td>
<td>Temperature outside (from Chievres weather station)</td>
<td>in Celsius</td>
</tr>
<tr class="odd">
<td>Pressure</td>
<td>(from Chievres weather station)</td>
<td>in mm Hg</td>
</tr>
<tr class="even">
<td>RH_out</td>
<td>Humidity outside (from Chievres weather station)</td>
<td>in %</td>
</tr>
<tr class="odd">
<td>Wind speed</td>
<td>(from Chievres weather station)</td>
<td>in m/s</td>
</tr>
<tr class="even">
<td>Visibility</td>
<td>(from Chievres weather station)</td>
<td>in km</td>
</tr>
<tr class="odd">
<td>Tdewpoint</td>
<td>(from Chievres weather station)</td>
<td>Â °C</td>
</tr>
<tr class="even">
<td>rv1</td>
<td>Random variable 1</td>
<td>nondimensional</td>
</tr>
<tr class="odd">
<td>rv2</td>
<td>Random variable 2</td>
<td>nondimensional</td>
</tr>
</tbody>
</table>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>energy.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Appliances</th>
      <th>lights</th>
      <th>T1</th>
      <th>RH_1</th>
      <th>T2</th>
      <th>RH_2</th>
      <th>T3</th>
      <th>RH_3</th>
      <th>T4</th>
      <th>RH_4</th>
      <th>T5</th>
      <th>RH_5</th>
      <th>T6</th>
      <th>RH_6</th>
      <th>T7</th>
      <th>RH_7</th>
      <th>T8</th>
      <th>RH_8</th>
      <th>T9</th>
      <th>RH_9</th>
      <th>T_out</th>
      <th>Press_mm_hg</th>
      <th>RH_out</th>
      <th>Windspeed</th>
      <th>Visibility</th>
      <th>Tdewpoint</th>
      <th>rv1</th>
      <th>rv2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>19735.000000</td>
      <td>19735.000000</td>
      <td>19735.000000</td>
      <td>19735.000000</td>
      <td>19735.000000</td>
      <td>19735.000000</td>
      <td>19735.000000</td>
      <td>19735.000000</td>
      <td>19735.000000</td>
      <td>19735.000000</td>
      <td>19735.000000</td>
      <td>19735.000000</td>
      <td>19735.000000</td>
      <td>19735.000000</td>
      <td>19735.000000</td>
      <td>19735.000000</td>
      <td>19735.000000</td>
      <td>19735.000000</td>
      <td>19735.000000</td>
      <td>19735.000000</td>
      <td>19735.000000</td>
      <td>19735.000000</td>
      <td>19735.000000</td>
      <td>19735.000000</td>
      <td>19735.000000</td>
      <td>19735.000000</td>
      <td>19735.000000</td>
      <td>19735.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>97.694958</td>
      <td>3.801875</td>
      <td>21.686571</td>
      <td>40.259739</td>
      <td>20.341219</td>
      <td>40.420420</td>
      <td>22.267611</td>
      <td>39.242500</td>
      <td>20.855335</td>
      <td>39.026904</td>
      <td>19.592106</td>
      <td>50.949283</td>
      <td>7.910939</td>
      <td>54.609083</td>
      <td>20.267106</td>
      <td>35.388200</td>
      <td>22.029107</td>
      <td>42.936165</td>
      <td>19.485828</td>
      <td>41.552401</td>
      <td>7.411665</td>
      <td>755.522602</td>
      <td>79.750418</td>
      <td>4.039752</td>
      <td>38.330834</td>
      <td>3.760707</td>
      <td>24.988033</td>
      <td>24.988033</td>
    </tr>
    <tr>
      <th>std</th>
      <td>102.524891</td>
      <td>7.935988</td>
      <td>1.606066</td>
      <td>3.979299</td>
      <td>2.192974</td>
      <td>4.069813</td>
      <td>2.006111</td>
      <td>3.254576</td>
      <td>2.042884</td>
      <td>4.341321</td>
      <td>1.844623</td>
      <td>9.022034</td>
      <td>6.090347</td>
      <td>31.149806</td>
      <td>2.109993</td>
      <td>5.114208</td>
      <td>1.956162</td>
      <td>5.224361</td>
      <td>2.014712</td>
      <td>4.151497</td>
      <td>5.317409</td>
      <td>7.399441</td>
      <td>14.901088</td>
      <td>2.451221</td>
      <td>11.794719</td>
      <td>4.194648</td>
      <td>14.496634</td>
      <td>14.496634</td>
    </tr>
    <tr>
      <th>min</th>
      <td>10.000000</td>
      <td>0.000000</td>
      <td>16.790000</td>
      <td>27.023333</td>
      <td>16.100000</td>
      <td>20.463333</td>
      <td>17.200000</td>
      <td>28.766667</td>
      <td>15.100000</td>
      <td>27.660000</td>
      <td>15.330000</td>
      <td>29.815000</td>
      <td>-6.065000</td>
      <td>1.000000</td>
      <td>15.390000</td>
      <td>23.200000</td>
      <td>16.306667</td>
      <td>29.600000</td>
      <td>14.890000</td>
      <td>29.166667</td>
      <td>-5.000000</td>
      <td>729.300000</td>
      <td>24.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>-6.600000</td>
      <td>0.005322</td>
      <td>0.005322</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>50.000000</td>
      <td>0.000000</td>
      <td>20.760000</td>
      <td>37.333333</td>
      <td>18.790000</td>
      <td>37.900000</td>
      <td>20.790000</td>
      <td>36.900000</td>
      <td>19.530000</td>
      <td>35.530000</td>
      <td>18.277500</td>
      <td>45.400000</td>
      <td>3.626667</td>
      <td>30.025000</td>
      <td>18.700000</td>
      <td>31.500000</td>
      <td>20.790000</td>
      <td>39.066667</td>
      <td>18.000000</td>
      <td>38.500000</td>
      <td>3.666667</td>
      <td>750.933333</td>
      <td>70.333333</td>
      <td>2.000000</td>
      <td>29.000000</td>
      <td>0.900000</td>
      <td>12.497889</td>
      <td>12.497889</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>60.000000</td>
      <td>0.000000</td>
      <td>21.600000</td>
      <td>39.656667</td>
      <td>20.000000</td>
      <td>40.500000</td>
      <td>22.100000</td>
      <td>38.530000</td>
      <td>20.666667</td>
      <td>38.400000</td>
      <td>19.390000</td>
      <td>49.090000</td>
      <td>7.300000</td>
      <td>55.290000</td>
      <td>20.033333</td>
      <td>34.863333</td>
      <td>22.100000</td>
      <td>42.375000</td>
      <td>19.390000</td>
      <td>40.900000</td>
      <td>6.916667</td>
      <td>756.100000</td>
      <td>83.666667</td>
      <td>3.666667</td>
      <td>40.000000</td>
      <td>3.433333</td>
      <td>24.897653</td>
      <td>24.897653</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>100.000000</td>
      <td>0.000000</td>
      <td>22.600000</td>
      <td>43.066667</td>
      <td>21.500000</td>
      <td>43.260000</td>
      <td>23.290000</td>
      <td>41.760000</td>
      <td>22.100000</td>
      <td>42.156667</td>
      <td>20.619643</td>
      <td>53.663333</td>
      <td>11.256000</td>
      <td>83.226667</td>
      <td>21.600000</td>
      <td>39.000000</td>
      <td>23.390000</td>
      <td>46.536000</td>
      <td>20.600000</td>
      <td>44.338095</td>
      <td>10.408333</td>
      <td>760.933333</td>
      <td>91.666667</td>
      <td>5.500000</td>
      <td>40.000000</td>
      <td>6.566667</td>
      <td>37.583769</td>
      <td>37.583769</td>
    </tr>
    <tr>
      <th>max</th>
      <td>1080.000000</td>
      <td>70.000000</td>
      <td>26.260000</td>
      <td>63.360000</td>
      <td>29.856667</td>
      <td>56.026667</td>
      <td>29.236000</td>
      <td>50.163333</td>
      <td>26.200000</td>
      <td>51.090000</td>
      <td>25.795000</td>
      <td>96.321667</td>
      <td>28.290000</td>
      <td>99.900000</td>
      <td>26.000000</td>
      <td>51.400000</td>
      <td>27.230000</td>
      <td>58.780000</td>
      <td>24.500000</td>
      <td>53.326667</td>
      <td>26.100000</td>
      <td>772.300000</td>
      <td>100.000000</td>
      <td>14.000000</td>
      <td>66.000000</td>
      <td>15.500000</td>
      <td>49.996530</td>
      <td>49.996530</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>energy.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 19735 entries, 0 to 19734
Data columns (total 29 columns):
 #   Column       Non-Null Count  Dtype  
---  ------       --------------  -----  
 0   date         19735 non-null  object 
 1   Appliances   19735 non-null  int64  
 2   lights       19735 non-null  int64  
 3   T1           19735 non-null  float64
 4   RH_1         19735 non-null  float64
 5   T2           19735 non-null  float64
 6   RH_2         19735 non-null  float64
 7   T3           19735 non-null  float64
 8   RH_3         19735 non-null  float64
 9   T4           19735 non-null  float64
 10  RH_4         19735 non-null  float64
 11  T5           19735 non-null  float64
 12  RH_5         19735 non-null  float64
 13  T6           19735 non-null  float64
 14  RH_6         19735 non-null  float64
 15  T7           19735 non-null  float64
 16  RH_7         19735 non-null  float64
 17  T8           19735 non-null  float64
 18  RH_8         19735 non-null  float64
 19  T9           19735 non-null  float64
 20  RH_9         19735 non-null  float64
 21  T_out        19735 non-null  float64
 22  Press_mm_hg  19735 non-null  float64
 23  RH_out       19735 non-null  float64
 24  Windspeed    19735 non-null  float64
 25  Visibility   19735 non-null  float64
 26  Tdewpoint    19735 non-null  float64
 27  rv1          19735 non-null  float64
 28  rv2          19735 non-null  float64
dtypes: float64(26), int64(2), object(1)
memory usage: 4.4+ MB</code></pre>
</div>
</div>
<p>There are no missing values in the dataset.</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> MinMaxScaler()</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>normalised_df <span class="op">=</span> pd.DataFrame(scaler.fit_transform(energy.drop(columns<span class="op">=</span>[<span class="st">'date'</span>, <span class="st">'lights'</span>])), </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>                             columns<span class="op">=</span>energy.drop(columns<span class="op">=</span>[<span class="st">'date'</span>, <span class="st">'lights'</span>]).columns)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>features_df <span class="op">=</span> normalised_df.drop(columns<span class="op">=</span>[<span class="st">'Appliances'</span>])</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>energy_target <span class="op">=</span> normalised_df.Appliances</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(features_df, energy_target, test_size<span class="op">=</span><span class="fl">.3</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>From the dataset, fit a linear model on the relationship between the temperature in the living room in Celsius (x = T2) and the temperature outside the building (y = T6).</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>lin_reg <span class="op">=</span> LinearRegression()</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>lin_reg.fit(X_train[[<span class="st">'T2'</span>]], X_train.T6)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>T6_pred <span class="op">=</span> lin_reg.predict(X_test[[<span class="st">'T2'</span>]])</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'r^2 score: </span><span class="sc">{</span><span class="bu">round</span>(r2_score(X_test.T6, T6_pred), <span class="dv">2</span>)<span class="sc">}</span><span class="ss">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>r^2 score: 0.64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'MAE: </span><span class="sc">{</span><span class="bu">round</span>(mean_absolute_error(X_test.T6, T6_pred), <span class="dv">2</span>)<span class="sc">}</span><span class="ss">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>MAE: 0.08</code></pre>
</div>
</div>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Residual Sum of Squares: </span><span class="sc">{</span><span class="bu">round</span>(np.<span class="bu">sum</span>(np.square(X_test.T6 <span class="op">-</span> T6_pred)), <span class="dv">2</span>)<span class="sc">}</span><span class="ss">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Residual Sum of Squares: 274.9</code></pre>
</div>
</div>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Root Mean Squared Error: </span><span class="sc">{</span><span class="bu">round</span>(np.sqrt(mean_squared_error(X_test.T6, T6_pred)), <span class="dv">3</span>)<span class="sc">}</span><span class="ss">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Root Mean Squared Error: 0.215</code></pre>
</div>
</div>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>T7             1.0
T1             1.0
T2             1.0
T9             1.0
RH_8           1.0
RH_out         1.0
Tdewpoint      1.0
Visibility     1.0
Windspeed      1.0
Press_mm_hg    1.0
T_out          1.0
RH_9           1.0
T8             1.0
RH_7           1.0
Appliances     1.0
RH_6           1.0
T6             1.0
RH_5           1.0
RH_4           1.0
RH_3           1.0
T3             1.0
RH_2           1.0
RH_1           1.0
rv1            1.0
rv2            1.0
T5             1.0
T4             1.0
dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>energy.drop(columns<span class="op">=</span>[<span class="st">'date'</span>, <span class="st">'lights'</span>]).<span class="bu">max</span>().sort_values()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>Windspeed        14.000000
Tdewpoint        15.500000
T9               24.500000
T5               25.795000
T7               26.000000
T_out            26.100000
T4               26.200000
T1               26.260000
T8               27.230000
T6               28.290000
T3               29.236000
T2               29.856667
rv1              49.996530
rv2              49.996530
RH_3             50.163333
RH_4             51.090000
RH_7             51.400000
RH_9             53.326667
RH_2             56.026667
RH_8             58.780000
RH_1             63.360000
Visibility       66.000000
RH_5             96.321667
RH_6             99.900000
RH_out          100.000000
Press_mm_hg     772.300000
Appliances     1080.000000
dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>energy.drop(columns<span class="op">=</span>[<span class="st">'date'</span>, <span class="st">'lights'</span>]).<span class="bu">min</span>().sort_values()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code>Tdewpoint       -6.600000
T6              -6.065000
T_out           -5.000000
Windspeed        0.000000
rv2              0.005322
rv1              0.005322
Visibility       1.000000
RH_6             1.000000
Appliances      10.000000
T9              14.890000
T4              15.100000
T5              15.330000
T7              15.390000
T2              16.100000
T8              16.306667
T1              16.790000
T3              17.200000
RH_2            20.463333
RH_7            23.200000
RH_out          24.000000
RH_1            27.023333
RH_4            27.660000
RH_3            28.766667
RH_9            29.166667
RH_8            29.600000
RH_5            29.815000
Press_mm_hg    729.300000
dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_weights_df(model, feat, col_name):</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">#this function returns the weight of every feature</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    weights <span class="op">=</span> pd.Series(model.coef_, feat.columns).sort_values()</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    weights_df <span class="op">=</span> pd.DataFrame(weights).reset_index()</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    weights_df.columns <span class="op">=</span> [<span class="st">'Features'</span>, col_name]</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    weights_df[col_name].<span class="bu">round</span>(<span class="dv">3</span>)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> weights_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>ridge_reg <span class="op">=</span> Ridge(alpha<span class="op">=</span><span class="fl">0.4</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>ridge_reg.fit(X_train, y_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">
<pre><code>Ridge(alpha=0.4)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>lasso_reg <span class="op">=</span> Lasso(alpha<span class="op">=</span><span class="fl">0.001</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>lasso_reg.fit(X_train, y_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<pre><code>Lasso(alpha=0.001)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> LinearRegression()</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>model.fit(X_train, y_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">
<pre><code>LinearRegression()</code></pre>
</div>
</div>
<div class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>linear_model_weights <span class="op">=</span> get_weights_df(model, X_train, <span class="st">'Linear_Model_Weight'</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>ridge_weights_df <span class="op">=</span> get_weights_df(ridge_reg, X_train, <span class="st">'Ridge_Weight'</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>lasso_weights_df <span class="op">=</span> get_weights_df(lasso_reg, X_train, <span class="st">'Lasso_weight'</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>final_weights <span class="op">=</span> pd.merge(linear_model_weights, ridge_weights_df, on<span class="op">=</span><span class="st">'Features'</span>)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>final_weights <span class="op">=</span> pd.merge(final_weights, lasso_weights_df, on<span class="op">=</span><span class="st">'Features'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>final_weights.sort_values(<span class="st">"Linear_Model_Weight"</span>, ascending<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="45">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Features</th>
      <th>Linear_Model_Weight</th>
      <th>Ridge_Weight</th>
      <th>Lasso_weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>25</th>
      <td>RH_1</td>
      <td>0.553547</td>
      <td>0.519525</td>
      <td>0.017880</td>
    </tr>
    <tr>
      <th>24</th>
      <td>T3</td>
      <td>0.290627</td>
      <td>0.288087</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>23</th>
      <td>T6</td>
      <td>0.236425</td>
      <td>0.217292</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Tdewpoint</td>
      <td>0.117758</td>
      <td>0.083128</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>21</th>
      <td>T8</td>
      <td>0.101995</td>
      <td>0.101028</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>20</th>
      <td>RH_3</td>
      <td>0.096048</td>
      <td>0.095135</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>19</th>
      <td>RH_6</td>
      <td>0.038049</td>
      <td>0.035519</td>
      <td>-0.000000</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Windspeed</td>
      <td>0.029183</td>
      <td>0.030268</td>
      <td>0.002912</td>
    </tr>
    <tr>
      <th>17</th>
      <td>T4</td>
      <td>0.028981</td>
      <td>0.027384</td>
      <td>-0.000000</td>
    </tr>
    <tr>
      <th>16</th>
      <td>RH_4</td>
      <td>0.026386</td>
      <td>0.024579</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>15</th>
      <td>RH_5</td>
      <td>0.016006</td>
      <td>0.016152</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Visibility</td>
      <td>0.012307</td>
      <td>0.012076</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>13</th>
      <td>T7</td>
      <td>0.010319</td>
      <td>0.010098</td>
      <td>-0.000000</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Press_mm_hg</td>
      <td>0.006839</td>
      <td>0.006584</td>
      <td>-0.000000</td>
    </tr>
    <tr>
      <th>11</th>
      <td>rv2</td>
      <td>0.000770</td>
      <td>0.000748</td>
      <td>-0.000000</td>
    </tr>
    <tr>
      <th>10</th>
      <td>rv1</td>
      <td>0.000770</td>
      <td>0.000748</td>
      <td>-0.000000</td>
    </tr>
    <tr>
      <th>9</th>
      <td>T1</td>
      <td>-0.003281</td>
      <td>-0.018406</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>8</th>
      <td>T5</td>
      <td>-0.015657</td>
      <td>-0.019853</td>
      <td>-0.000000</td>
    </tr>
    <tr>
      <th>7</th>
      <td>RH_9</td>
      <td>-0.039800</td>
      <td>-0.041367</td>
      <td>-0.000000</td>
    </tr>
    <tr>
      <th>6</th>
      <td>RH_7</td>
      <td>-0.044614</td>
      <td>-0.045977</td>
      <td>-0.000000</td>
    </tr>
    <tr>
      <th>5</th>
      <td>RH_out</td>
      <td>-0.077671</td>
      <td>-0.054724</td>
      <td>-0.049557</td>
    </tr>
    <tr>
      <th>4</th>
      <td>RH_8</td>
      <td>-0.157595</td>
      <td>-0.156830</td>
      <td>-0.000110</td>
    </tr>
    <tr>
      <th>3</th>
      <td>T9</td>
      <td>-0.189941</td>
      <td>-0.188916</td>
      <td>-0.000000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>T2</td>
      <td>-0.236178</td>
      <td>-0.201397</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>T_out</td>
      <td>-0.321860</td>
      <td>-0.262172</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>0</th>
      <td>RH_2</td>
      <td>-0.456698</td>
      <td>-0.411071</td>
      <td>-0.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>y_pred_lg <span class="op">=</span> model.predict(X_test)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>y_pred_r <span class="op">=</span> ridge_reg.predict(X_test)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>y_pred_l <span class="op">=</span> lasso_reg.predict(X_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Root Mean Squared Error: </span><span class="sc">{</span><span class="bu">round</span>(np.sqrt(mean_squared_error(y_test, y_pred_r)), <span class="dv">3</span>)<span class="sc">}</span><span class="ss">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Root Mean Squared Error: 0.088</code></pre>
</div>
</div>
<div class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Root Mean Squared Error: </span><span class="sc">{</span><span class="bu">round</span>(np.sqrt(mean_squared_error(y_test, y_pred_l)), <span class="dv">3</span>)<span class="sc">}</span><span class="ss">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Root Mean Squared Error: 0.094</code></pre>
</div>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>